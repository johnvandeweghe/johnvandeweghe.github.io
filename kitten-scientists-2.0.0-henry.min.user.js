// ==UserScript==
// @name        Kitten Scientists
// @description Add-on for the wonderful incremental browser game: https://kittensgame.com/web/
// @namespace   https://kitten-science.com/
// @icon        https://kitten-science.com/assets/images/organization-logo64.png
// @author      Oliver Salzburg <oliver.salzburg@gmail.com>
// @match       https://kittensgame.com/web/
// @match       https://kittensgame.com/beta/
// @match       https://kittensgame.com/alpha/
// @version     2.0.0-henry
// @homepage    https://github.com/kitten-science/kitten-scientists
// @supportURL  https://github.com/kitten-science/kitten-scientists/issues
// @updateURL   https://kitten-science.com/"fixed".js
// @grant       none
// ==/UserScript==
(function(m){typeof define=="function"&&define.amd?define(m):m()})(function(){"use strict";var Fl=Object.defineProperty;var hn=m=>{throw TypeError(m)};var Gl=(m,I,j)=>I in m?Fl(m,I,{enumerable:!0,configurable:!0,writable:!0,value:j}):m[I]=j;var g=(m,I,j)=>Gl(m,typeof I!="symbol"?I+"":I,j),mn=(m,I,j)=>I.has(m)||hn("Cannot "+j);var A=(m,I,j)=>(mn(m,I,"read from private field"),j?j.call(m):I.get(m)),B=(m,I,j)=>I.has(m)?hn("Cannot add the same private member more than once"):I instanceof WeakSet?I.add(m):I.set(m,j),P=(m,I,j,v)=>(mn(m,I,"write to private field"),v?v.call(m,j):I.set(m,j),j);var fn=(m,I,j,v)=>({set _(xe){P(m,I,xe,j)},get _(){return A(m,I,v)}});var Le,$e,Oe,De,Ne,qe,ze,We,He,Fe,Ge,Ze,Ke,Ve,je,Xe,Je,Ye,Qe,et,tt,it,nt,st,at,rt,lt,ot,ct,ut,Pt;function m(o){return o==null}function I(o,i){return!m(o)&&o instanceof i}class j extends Error{constructor(i="unexpected nil value"){super(i)}}function v(o,i){if(m(o))throw new j(i);return o}function xe(o,i){const e=new Array;for(const t of o)m(t)?m(i)||e.push(i):e.push(t);return e}const x=o=>e=>{o.error(e)};var Lt,ai;function ri(){return ai||(ai=1,Lt=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...i)=>console.error("SEMVER",...i):()=>{}),Lt}var $t,li;function oi(){if(li)return $t;li=1;const o="2.0.0",i=256,e=Number.MAX_SAFE_INTEGER||9007199254740991,t=16,n=i-6;return $t={MAX_LENGTH:i,MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:o,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},$t}var dt={exports:{}},ci;function pn(){return ci||(ci=1,function(o,i){const{MAX_SAFE_COMPONENT_LENGTH:e,MAX_SAFE_BUILD_LENGTH:t,MAX_LENGTH:n}=oi(),s=ri();i=o.exports={};const a=i.re=[],r=i.safeRe=[],l=i.src=[],u=i.safeSrc=[],c=i.t={};let h=0;const d="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",n],[d,t]],b=y=>{for(const[w,G]of f)y=y.split(`${w}*`).join(`${w}{0,${G}}`).split(`${w}+`).join(`${w}{1,${G}}`);return y},p=(y,w,G)=>{const W=b(w),ee=h++;s(y,ee,w),c[y]=ee,l[ee]=w,u[ee]=W,a[ee]=new RegExp(w,G?"g":void 0),r[ee]=new RegExp(W,G?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),p("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${l[c.NUMERICIDENTIFIER]}|${l[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NUMERICIDENTIFIERLOOSE]}|${l[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${d}+`),p("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),p("FULL",`^${l[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),p("LOOSE",`^${l[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${l[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${l[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),p("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?`),p("COERCE",`${l[c.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",l[c.COERCEPLAIN]+`(?:${l[c.PRERELEASE]})?(?:${l[c.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",l[c.COERCE],!0),p("COERCERTLFULL",l[c.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),i.tildeTrimReplace="$1~",p("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),i.caretTrimReplace="$1^",p("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),i.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(dt,dt.exports)),dt.exports}var Ot,ui;function bn(){if(ui)return Ot;ui=1;const o=Object.freeze({loose:!0}),i=Object.freeze({});return Ot=t=>t?typeof t!="object"?o:t:i,Ot}var Dt,gi;function vn(){if(gi)return Dt;gi=1;const o=/^[0-9]+$/,i=(t,n)=>{const s=o.test(t),a=o.test(n);return s&&a&&(t=+t,n=+n),t===n?0:s&&!a?-1:a&&!s?1:t<n?-1:1};return Dt={compareIdentifiers:i,rcompareIdentifiers:(t,n)=>i(n,t)},Dt}var Nt,di;function yn(){if(di)return Nt;di=1;const o=ri(),{MAX_LENGTH:i,MAX_SAFE_INTEGER:e}=oi(),{safeRe:t,safeSrc:n,t:s}=pn(),a=bn(),{compareIdentifiers:r}=vn();class l{constructor(c,h){if(h=a(h),c instanceof l){if(c.loose===!!h.loose&&c.includePrerelease===!!h.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>i)throw new TypeError(`version is longer than ${i} characters`);o("SemVer",c,h),this.options=h,this.loose=!!h.loose,this.includePrerelease=!!h.includePrerelease;const d=c.trim().match(h.loose?t[s.LOOSE]:t[s.FULL]);if(!d)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+d[1],this.minor=+d[2],this.patch=+d[3],this.major>e||this.major<0)throw new TypeError("Invalid major version");if(this.minor>e||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>e||this.patch<0)throw new TypeError("Invalid patch version");d[4]?this.prerelease=d[4].split(".").map(f=>{if(/^[0-9]+$/.test(f)){const b=+f;if(b>=0&&b<e)return b}return f}):this.prerelease=[],this.build=d[5]?d[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(o("SemVer.compare",this.version,this.options,c),!(c instanceof l)){if(typeof c=="string"&&c===this.version)return 0;c=new l(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof l||(c=new l(c,this.options)),r(this.major,c.major)||r(this.minor,c.minor)||r(this.patch,c.patch)}comparePre(c){if(c instanceof l||(c=new l(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let h=0;do{const d=this.prerelease[h],f=c.prerelease[h];if(o("prerelease compare",h,d,f),d===void 0&&f===void 0)return 0;if(f===void 0)return 1;if(d===void 0)return-1;if(d===f)continue;return r(d,f)}while(++h)}compareBuild(c){c instanceof l||(c=new l(c,this.options));let h=0;do{const d=this.build[h],f=c.build[h];if(o("build compare",h,d,f),d===void 0&&f===void 0)return 0;if(f===void 0)return 1;if(d===void 0)return-1;if(d===f)continue;return r(d,f)}while(++h)}inc(c,h,d){if(c.startsWith("pre")){if(!h&&d===!1)throw new Error("invalid increment argument: identifier is empty");if(h){const f=new RegExp(`^${this.options.loose?n[s.PRERELEASELOOSE]:n[s.PRERELEASE]}$`),b=`-${h}`.match(f);if(!b||b[1]!==h)throw new Error(`invalid identifier: ${h}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",h,d);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",h,d);break;case"prepatch":this.prerelease.length=0,this.inc("patch",h,d),this.inc("pre",h,d);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",h,d),this.inc("pre",h,d);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const f=Number(d)?1:0;if(this.prerelease.length===0)this.prerelease=[f];else{let b=this.prerelease.length;for(;--b>=0;)typeof this.prerelease[b]=="number"&&(this.prerelease[b]++,b=-2);if(b===-1){if(h===this.prerelease.join(".")&&d===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(f)}}if(h){let b=[h,f];d===!1&&(b=[h]),r(this.prerelease[0],h)===0?isNaN(this.prerelease[1])&&(this.prerelease=b):this.prerelease=b}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Nt=l,Nt}var qt,hi;function kn(){if(hi)return qt;hi=1;const o=yn();return qt=(e,t,n)=>new o(e,n).compare(new o(t,n)),qt}var zt,mi;function wn(){if(mi)return zt;mi=1;const o=kn();return zt=(e,t,n)=>o(e,t,n)>0,zt}wn();class ke extends Error{constructor(e,t,n){super(t);g(this,"status");g(this,"code");this.code=e,this.name="AbstractError",this.status=n,typeof Error.captureStackTrace<"u"&&Error.captureStackTrace(this,ke)}static isAbstractError(e,t=!0){if(e instanceof ke)return!0;if(t){const n=e;if(Object(e)===e&&"code"in n&&typeof n.code=="string"&&e.code.match(/^ERR_OS_/))return!0}return!1}}class Be extends ke{constructor(i,e=500){super("ERR_OS_INTERNAL",i,e),this.name="InternalError",typeof Error.captureStackTrace<"u"&&Error.captureStackTrace(this,Be)}static fromError(i){const e=new Be(i.message);return Object.assign(e,i,new Be(i.message)),e.stack=i.stack,e}}class Wt extends ke{constructor(i,e=500){super("ERR_OS_UNKNOWN",i,e),this.name="UnknownError",typeof Error.captureStackTrace<"u"&&Error.captureStackTrace(this,Wt)}}const _n=o=>o instanceof Error||Object.prototype.toString.call(o)==="[object Error]",Sn=o=>ke.isAbstractError(o)?o:_n(o)?Be.fromError(o):new Wt(String(o)),Ce=o=>{const i=performance.now();return[o(),performance.now()-i]},ht=async o=>{const i=performance.now();return[await o(),performance.now()-i]};class ue{constructor(i,e){g(this,"_host");g(this,"tab");this._host=i;const t=this._host.game.tabs.find(n=>n.tabId===e);if(m(t))throw new Error(`Unable to find tab ${e}`);this.tab=t,this.render()}render(){return this._host.game.ui.activeTabId!==this.tab.tabId&&this.tab.render(),this}}const se=(o,i)=>o.filter(e=>!i.includes(e));function be(...o){console.debug("👩‍🔬",...o)}function H(...o){console.info("👩‍🔬",...o)}function U(...o){console.warn("👩‍🔬",...o)}function ge(...o){console.error("👩‍🔬",...o)}function D(o){return Object.entries(o)}function N(o,i,e){if(m(i))return U("No source data was provided."),o;for(const[t,n]of D(o))t in i||H(`Entry '${t}' is missing in source. Using default value.`),e(n,i[t]);for(const[t]of D(i))t in o||U(`Entry '${t}' was found in source, but it is not expected by the subject schema. This entry will be ignored.`);return o}class mt{constructor(i){g(this,"_elem");this._elem=structuredClone(i)}unwrap(){return structuredClone(this._elem)}replace(i){this._elem=structuredClone(i)}toJSON(){return this.unwrap()}}function Y(o){return o.charAt(0).toUpperCase()+o.slice(1)}function xn(o){return Math.round(o*100)/100}function Te(o){return o===-1?Number.POSITIVE_INFINITY:o}class ft{constructor(i,e){g(this,"_host");g(this,"_workshopManager");this._host=i,this._workshopManager=e}bulk(i,e,t,n){const s=[],a=[];let r=0;for(const[h,d]of D(i)){const f=re.evaluateSubSectionTrigger(t,d.trigger),b=v(e[h]);if(!d.enabled||f<0||"tHidden"in b&&b.tHidden===!0||"rHidden"in b&&b.rHidden===!0||b.unlocked===!1||!m(d.max)&&-1<d.max&&d.max<=b.val||h==="cryochambers"&&(v(this._host.game.time.getVSU("usedCryochambers")).val>0||this._host.game.bld.getBuildingExt("chronosphere").meta.val<=b.val)||h==="ressourceRetrieval"&&b.val>=100)continue;const p=v(this._isStagedBuild(b)?b.stages[b.stage].prices:b.prices),y=this.getPriceRatio(b,n);if(!this.singleBuildPossible(b,p,y,n))continue;if(p.map(W=>this._workshopManager.getResource(W.name)).filter(W=>0<W.maxValue).filter(W=>W.value/W.maxValue<f).length===0){if(this._isStagedBuild(b)&&typeof d.stage<"u"&&d.stage!==b.stage)continue;const W=[],fe=1-this._host.game.getLimitedDR(this._host.game.getEffect(`${h}CostReduction`),1);for(const ce of p){const te=1-this._host.game.getLimitedDR(this._host.game.getEffect(`${ce.name}CostReduction`),1);W.push({val:ce.val*fe*te,name:ce.name})}s.push({count:0,id:h,label:d.label,name:d.baseBuilding??d.building,stage:d.stage,variant:d.variant}),a.push({id:h,name:d.baseBuilding??d.building,count:0,spot:r,prices:W,priceRatio:y,source:n,limit:d.max||0,val:b.val}),r++}}if(a.length===0)return[];const l={};for(const h of this._host.game.resPool.resources)l[h.name]=this._workshopManager.getValueAvailable(h.name);let u=0;const c=new Array;for(;u<1e5;){const h=se(a,c);let d=0;const f=[];let b={...l};for(const p of c)b=this._precalculateBuilds({...p,limit:p.val+p.count},e,b).remainingResources;for(const p of h){const y=p.count+1,w=this._precalculateBuilds({...p,limit:Math.min(Te(p.limit),p.val+y)},e,b);if(w.count<y){f.push(p);continue}p.count=y,b=w.remainingResources,d++}if(c.push(...f),u++,d===0)break}be(`Took '${u}' iterations to evaluate bulk build request.`);for(const h of a){const d=v(s.find(f=>f.id===h.id));d.count=h.count}return s}_precalculateBuilds(i,e,t={}){let n=0;const s=Object.assign({},t),a=v(e[i.id]),r=i.prices,l=i.priceRatio,u=i.source;let c=!1;if(r.length===0)return{count:0,remainingResources:s};for(;!c;){for(let h=0;h<r.length;h++){let d=!1,f=!1,b=Number.POSITIVE_INFINITY,p=Number.POSITIVE_INFINITY;if(u==="Space"&&r[h].name==="oil"){d=!0;const y=this._host.game.getEffect("oilReductionRatio");b=r[h].val*(1-this._host.game.getLimitedDR(y,.75))}else if(i.id==="cryochambers"&&r[h].name==="karma"){f=!0;const y=this._host.game.prestige.getBurnedParagonRatio();p=r[h].val*(1-this._host.game.getLimitedDR(.01*y,1))}if(d?c=s.oil<b*1.05**(n+a.val):f?c=s.karma<p*l**(n+a.val):c=s[r[h].name]<r[h].val*l**(n+a.val),c||"noStackable"in a&&a.noStackable&&n+a.val>=1||i.id==="ressourceRetrieval"&&n+a.val>=100||i.id==="cryochambers"&&this._host.game.bld.getBuildingExt("chronosphere").meta.val<=n+a.val){for(let y=0;y<h;y++)if(u==="Space"&&r[y].name==="oil"){const w=this._host.game.getEffect("oilReductionRatio"),G=r[y].val*(1-this._host.game.getLimitedDR(w,.75));s.oil+=G*1.05**(n+a.val)}else if(i.id==="cryochambers"&&r[y].name==="karma"){const w=this._host.game.prestige.getBurnedParagonRatio(),G=r[y].val*(1-this._host.game.getLimitedDR(.01*w,1));s.karma+=G*l**(n+a.val)}else{const w=r[y].val*l**(n+a.val);s[r[y].name]+=r[y].name==="void"?Math.ceil(w):w}return i.limit&&i.limit!==-1&&(n=Math.max(0,Math.min(n,i.limit-i.val))),{count:n,remainingResources:s}}if(d)s.oil-=b*1.05**(n+a.val);else if(f)s.karma-=p*l**(n+a.val);else{const y=r[h].val*l**(n+a.val);s[r[h].name]-=r[h].name==="void"?Math.ceil(y):y}}++n}return{count:n,remainingResources:s}}construct(i,e,t){const n=i.metadata;let s=0,a=t;const r=n;if(!m(r.limitBuild)&&r.limitBuild-r.val<a&&(a=r.limitBuild-r.val),i.enabled&&e.controller.hasResources(i)||this._host.game.devMode){for(;e.controller.hasResources(i)&&a>0;)i.prices=e.controller.getPrices(i),e.controller.payPrice(i),e.controller.incrementValue(i),s++,a--;r.breakIronWill&&(this._host.game.ironWill=!1),n.unlocks&&this._host.game.unlock(n.unlocks),n.upgrades&&this._host.game.upgrade(n.upgrades)}return s}_isStagedBuild(i){return"stage"in i&&"stages"in i&&!m(i.stage)&&!m(i.stages)}getPriceRatio(i,e){const t=this._isStagedBuild(i)?i.priceRatio||i.stages[i.stage].priceRatio:i.priceRatio??0;let n=0;return e&&e==="Bonfire"&&(n=this._host.game.getEffect(`${i.name}PriceRatio`)+this._host.game.getEffect("priceRatio")+this._host.game.getEffect("mapPriceReduction"),n=this._host.game.getLimitedDR(n,t-1)),t+n}singleBuildPossible(i,e,t,n){const a=1-this._host.game.getLimitedDR(this._host.game.getEffect(`${i.name}CostReduction`),1);for(const r of e){const u=1-this._host.game.getLimitedDR(this._host.game.getEffect(`${r.name}CostReduction`),1),c=r.val*a*u;if(n&&n==="Space"&&r.name==="oil"){const h=this._host.game.getLimitedDR(this._host.game.getEffect("oilReductionRatio"),.75),d=c*(1-h);if(this._workshopManager.getValueAvailable("oil")<d*1.05**i.val)return!1}else if(i.name==="cryochambers"&&r.name==="karma"){const h=this._host.game.getLimitedDR(.01*this._host.game.prestige.getBurnedParagonRatio(),1),d=c*(1-h);if(this._workshopManager.getValueAvailable("karma")<d*t**i.val)return!1}else if(this._workshopManager.getValueAvailable(r.name)<c*t**i.val)return!1}return!0}}const fi=["academy","accelerator","aiCore","amphitheatre","aqueduct","barn","biolab","brewery","calciner","chapel","chronosphere","factory","field","harbor","hut","library","logHouse","lumberMill","magneto","mansion","mine","mint","observatory","oilWell","pasture","quarry","reactor","smelter","steamworks","temple","tradepost","unicornPasture","warehouse","workshop","zebraForge","zebraOutpost","zebraWorkshop","ziggurat"],Ht=["broadcasttower","dataCenter","hydroplant","solarfarm","spaceport"];var Z=(o=>(o.Cryptotheology="c",o.OrderOfTheSun="s",o.Ziggurat="z",o.UnicornPasture="zp",o))(Z||{});const pi=["apocripha","basilica","goldenSpire","scholasticism","solarRevolution","solarchant","stainedGlass","sunAltar","templars","transcendence"],bi=["blackCore","blackLibrary","blackNexus","blackObelisk","blackRadiance","blazar","darkNova","holyGenocide","mausoleum","singularity"],vi=["blackPyramid","ivoryCitadel","ivoryTower","marker","skyPalace","sunspire","unicornGraveyard","unicornNecropolis","unicornTomb","unicornUtopia"],Cn=["authocracy","bigStickPolicy","carnivale","cityOnAHill","clearCutting","communism","conservation","cryochamberExtraction","culturalExchange","diplomacy","dragonRelationsAstrologers","dragonRelationsDynamicists","dragonRelationsPhysicists","environmentalism","epicurianism","expansionism","extravagance","fascism","frugality","fullIndustrialization","griffinRelationsMachinists","griffinRelationsMetallurgists","griffinRelationsScouts","isolationism","knowledgeSharing","liberalism","liberty","lizardRelationsDiplomats","lizardRelationsEcologists","lizardRelationsPriests","militarizeSpace","monarchy","mysticism","nagaRelationsArchitects","nagaRelationsCultists","nagaRelationsMasons","necrocracy","openWoodlands","outerSpaceTreaty","radicalXenophobia","rationality","rationing","republic","scientificCommunism","sharkRelationsBotanists","sharkRelationsMerchants","sharkRelationsScribes","siphoning","socialism","spiderRelationsChemists","spiderRelationsGeologists","spiderRelationsPaleontologists","stoicism","stripMining","sustainability","technocracy","terraformingInsight","theocracy","tradition","transkittenism","zebraRelationsAppeasement","zebraRelationsBellicosity"],yi=["brewery"],Tn=["acoustics","advExogeology","agriculture","ai","animal","antimatter","archeology","archery","architecture","artificialGravity","astronomy","biochemistry","biology","blackchain","calendar","chemistry","chronophysics","civil","combustion","construction","cryptotheology","currency","dimensionalPhysics","drama","ecology","electricity","electronics","engineering","exogeology","exogeophysics","genetics","hydroponics","industrialization","machinery","math","mechanization","metal","metalurgy","metaphysics","mining","nanotechnology","navigation","nuclearFission","oilProcessing","orbitalEngineering","paradoxalKnowledge","particlePhysics","philosophy","physics","quantumCryptography","robotics","rocketry","sattelites","steel","superconductors","tachyonTheory","terraformation","theology","thorium","voidSpace","writing"],En=["centaurusSystemMission","charonMission","duneMission","furthestRingMission","heliosMission","kairoMission","moonMission","orbitalLaunch","piscineMission","rorschachMission","terminusMission","umbraMission","yarnMission"],ki=["containmentChamber","cryostation","entangler","heatsink","hrHarvester","hydrofracturer","hydroponics","moltenCore","moonBase","moonOutpost","orbitalArray","planetCracker","researchVessel","sattelite","spaceBeacon","spaceElevator","spaceStation","spiceRefinery","sunforge","sunlifter","tectonic","terraformingStation"];var de=(o=>(o.Chronoforge="chrono",o.VoidSpace="void",o))(de||{});const wi=["blastFurnace","ressourceRetrieval","temporalAccelerator","temporalBattery","temporalImpedance","temporalPress","timeBoiler"],_i=["cryochambers","usedCryochambers","voidHoover","voidRift","chronocontrol","voidResonator"],Si=["dragons","griffins","nagas","leviathans","lizards","sharks","spiders","zebras"],xi=["advancedAutomation","advancedRefinement","aiBases","aiEngineers","alloyArmor","alloyAxe","alloyBarns","alloySaw","alloyWarehouses","amBases","amDrive","amFission","amReactors","amReactorsMK2","assistance","astrolabe","astrophysicists","augumentation","automatedPlants","barges","biofuel","bolas","cadSystems","caravanserai","carbonSequestration","cargoShips","celestialMechanics","chronoEngineers","chronoforge","coalFurnace","coldFusion","combustionEngine","compositeBow","concreteBarns","concreteHuts","concreteWarehouses","crossbow","cryocomputing","darkEnergy","deepMining","distorsion","electrolyticSmelting","eludiumCracker","eludiumHuts","eludiumReflectors","energyRifts","enrichedThorium","enrichedUranium","factoryAutomation","factoryLogistics","factoryOptimization","factoryProcessing","factoryRobotics","fluidizedReactors","fluxCondensator","fuelInjectors","geodesy","gmo","goldOre","hubbleTelescope","huntingArmor","hydroPlantTurbines","internet","invisibleBlackHand","ironAxes","ironHoes","ironwood","lhc","logistics","longRangeSpaceships","machineLearning","mineralAxes","mineralHoes","miningDrill","mWReactor","nanosuits","neuralNetworks","nuclearPlants","nuclearSmelters","offsetPress","oilDistillation","oilRefinery","orbitalGeodesy","oxidation","photolithography","photovoltaic","pneumaticPress","printingPress","pumpjack","pyrolysis","qdot","railgun","reactorVessel","refrigeration","register","reinforcedBarns","reinforcedSaw","reinforcedWarehouses","relicStation","rotaryKiln","satelliteRadio","satnav","seti","silos","solarSatellites","spaceEngineers","spaceManufacturing","spiceNavigation","starlink","stasisChambers","steelArmor","steelAxe","steelPlants","steelSaw","stoneBarns","storageBunkers","strenghtenBuild","tachyonAccelerators","thinFilm","thoriumEngine","thoriumReactors","titaniumAxe","titaniumBarns","titaniumMirrors","titaniumSaw","titaniumWarehouses","turnSmoothly","unicornSelection","unobtainiumAxe","unobtainiumDrill","unobtainiumHuts","unobtainiumReflectors","unobtainiumSaw","uplink","voidAspiration","voidEnergy","voidReactors"],Mn=["autumn","spring","summer","winter"],we=["charon","umbra","yarn","helios","cath","redmoon","dune","piscine","terminus","kairo"],Ci=["alloy","beam","bloodstone","blueprint","compedium","concrate","eludium","gear","kerosene","manuscript","megalith","parchment","plate","scaffold","ship","slab","steel","tanker","tMythril","thorium","wood"],Ti=[...Ci,"alicorn","antimatter","blackcoin","burnedParagon","catnip","coal","culture","elderBox","faith","furs","gflops","gold","hashrates","iron","ivory","karma","kittens","manpower","minerals","necrocorn","oil","paragon","relic","science","sorrow","spice","starchart","tears","temporalFlux","timeCrystal","titanium","unicorns","unobtainium","uranium","void","wrappingPaper","zebras"],Ei=["any","engineer","farmer","geologist","hunter","miner","priest","scholar","woodcutter"],Rn=["chemist","engineer","manager","metallurgist","merchant","none","scientist","wise"];class k{constructor(i=!1){g(this,"enabled");this.enabled=i}load(i){m(i)||(this.enabled=i.enabled??this.enabled)}serialize(){return this}}class Mi extends k{constructor(e=!1,t=!1){super(e);g(this,"limited");this.limited=t}load(e){m(e)||(super.load(e),this.limited=e.limited??this.limited)}}class X extends k{constructor(e=!1,t=-1){super(e);g(this,"trigger");this.trigger=t}load(e){m(e)||(super.load(e),this.trigger=e.trigger??this.trigger)}}class ae extends k{constructor(e=!1,t=1){super(e);g(this,"trigger");this.trigger=t}load(e){m(e)||(super.load(e),this.trigger=e.trigger??this.trigger)}}class Ri extends k{constructor(e=!1,t=0){super(e);g(this,"max");this.max=t}load(e){m(e)||(super.load(e),this.max=e.max??this.max)}}class An extends Mi{constructor(e=!1,t=!1,n=0){super(e,t);g(this,"max");this.max=n}load(e){m(e)||(super.load(e),this.max=e.max??this.max)}}class Bn extends An{constructor(e=!1,t=!1,n=0,s=-1){super(e,t,n);g(this,"trigger");this.trigger=s}load(e){m(e)||(super.load(e),this.trigger=e.trigger??this.trigger)}}class Pn extends Mi{constructor(e=!1,t=!1,n=-1){super(e,t);g(this,"trigger");this.trigger=n}load(e){m(e)||(super.load(e),this.trigger=e.trigger??this.trigger)}}class pt extends X{constructor(e=!1,t=1,n=0){super(e,t);g(this,"max");this.max=n}load(e){m(e)||(super.load(e),this.max=e.max??this.max)}}class Un extends ae{constructor(e=!1,t=1,n=0){super(e,t);g(this,"max");this.max=n}load(e){m(e)||(super.load(e),this.max=e.max??this.max)}}class Ft{constructor(i,e=new Array){B(this,Le);g(this,"selected");if(m(e.find(t=>t.value===i)))throw new Error("Provided selected value is not in provided options.");this.selected=i,P(this,Le,e)}get options(){return A(this,Le)}load(i){m(i)||(this.selected=i.selected??this.selected)}}Le=new WeakMap;class In extends ae{constructor(e=!1,t=950,n=1e3,s=1){super(e,s);g(this,"buy");g(this,"sell");this.buy=t,this.sell=n}load(e){m(e)||(super.load(e),this.buy=e.buy??this.buy,this.sell=e.sell??this.sell)}}class Ln extends k{constructor(e,t=!1){super(t);B(this,$e);P(this,$e,e)}get upgrade(){return A(this,$e)}}$e=new WeakMap;class $n extends k{constructor(e=!1){super(e);g(this,"buildings");this.buildings=this.initBuildings()}initBuildings(){const e={};for(const t of Ht)e[t]=new Ln(t);return e}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}))}}class Gt extends pt{constructor(e,t=!1,n=-1,s=0,a){super(t,n,s);B(this,Oe);B(this,De);B(this,Ne,0);P(this,De,e),a&&(P(this,Ne,1),P(this,Oe,a))}get baseBuilding(){return A(this,Oe)}get building(){return A(this,De)}get stage(){return A(this,Ne)}}Oe=new WeakMap,De=new WeakMap,Ne=new WeakMap;class Zt extends X{constructor(e=!1,t=-1,n=new k,s=new k,a=new k,r=new k,l=new $n){super(e,t);g(this,"buildings");g(this,"gatherCatnip");g(this,"turnOnMagnetos");g(this,"turnOnSteamworks");g(this,"turnOnReactors");g(this,"upgradeBuildings");this.buildings=this.initBuildings(),this.gatherCatnip=n,this.turnOnSteamworks=s,this.turnOnMagnetos=a,this.turnOnReactors=r,this.upgradeBuildings=l}initBuildings(){const e={broadcasttower:"amphitheatre",dataCenter:"library",hydroplant:"aqueduct",solarfarm:"pasture",spaceport:"warehouse"},t={};for(const n of fi)n!=="unicornPasture"&&(t[n]=new Gt(n));for(const n of Ht)t[n]=new Gt(n,!1,-1,0,e[n]);return t}load(e){var t,n,s,a;m(e)||(super.load(e),N(this.buildings,e.buildings,(r,l)=>{r.enabled=(l==null?void 0:l.enabled)??r.enabled,r.max=(l==null?void 0:l.max)??r.max,r.trigger=(l==null?void 0:l.trigger)??r.trigger}),this.gatherCatnip.enabled=((t=e.gatherCatnip)==null?void 0:t.enabled)??this.gatherCatnip.enabled,this.turnOnSteamworks.enabled=((n=e.turnOnSteamworks)==null?void 0:n.enabled)??this.turnOnSteamworks.enabled,this.turnOnMagnetos.enabled=((s=e.turnOnMagnetos)==null?void 0:s.enabled)??this.turnOnMagnetos.enabled,this.turnOnReactors.enabled=((a=e.turnOnReactors)==null?void 0:a.enabled)??this.turnOnReactors.enabled,this.upgradeBuildings.load(e.upgradeBuildings))}}class On{constructor(i,e,t=new Zt){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_bulkManager");g(this,"_workshopManager");this._host=i,this.settings=t,this.manager=new ue(this._host,"Bonfire"),this._workshopManager=e,this._bulkManager=new ft(this._host,this._workshopManager)}tick(i){this.settings.enabled&&(this.manager.render(),this.autoBuild(i),this.autoMisc(i))}autoBuild(i,e=this.settings.buildings){const t=this._bulkManager,n={};for(const r of Object.values(e))n[r.building]=this.getBuild(r.baseBuilding??r.building).meta;const s=this.settings.trigger,a=t.bulk(e,n,s,"Bonfire");for(const r of a.filter(l=>0<l.count))this.build(r.name||r.id,r.stage,r.count),i.requestGameUiRefresh=!0}autoUpgrade(i){var u,c;const e=this._host.game.bld.getBuildingExt("pasture").meta.stage===0?this._host.game.bld.getBuildingExt("pasture").meta.val:0,t=this._host.game.bld.getBuildingExt("aqueduct").meta.stage===0?this._host.game.bld.getBuildingExt("aqueduct").meta.val:0,n=this._host.game.bld.getBuildingExt("pasture").meta;if(this.settings.upgradeBuildings.buildings.solarfarm.enabled&&n.unlocked&&n.stage===0&&v(n.stages)[1].stageUnlocked&&this._workshopManager.getPotentialCatnip(!0,0,t)>0){const h=v(n.stages)[1].prices;if(this._bulkManager.singleBuildPossible(n,h,1)){const d=this.getBuildButton("pasture",0);m(d==null?void 0:d.model)||(d.controller.sellInternal(d.model,0),n.on=0,n.val=0,n.stage=1,this._host.engine.iactivity("upgrade.building.pasture",[],"ks-upgrade"),this._host.game.ui.render(),this.build("pasture",1,1),i.requestGameUiRefresh=!0)}}const s=this._host.game.bld.getBuildingExt("aqueduct").meta;if(this.settings.upgradeBuildings.buildings.hydroplant.enabled&&s.unlocked&&s.stage===0&&v(s.stages)[1].stageUnlocked&&this._workshopManager.getPotentialCatnip(!0,e,0)>0){const h=v(s.stages)[1].prices;if(this._bulkManager.singleBuildPossible(s,h,1)){const d=this.getBuildButton("aqueduct",0);m(d==null?void 0:d.model)||(d.controller.sellInternal(d.model,0),s.on=0,s.val=0,s.stage=1,(u=s.calculateEffects)==null||u.call(s,s,this._host.game),this._host.engine.iactivity("upgrade.building.aqueduct",[],"ks-upgrade"),this._host.game.ui.render(),this.build("aqueduct",1,1),i.requestGameUiRefresh=!0)}}const a=this._host.game.bld.getBuildingExt("library").meta;if(this.settings.upgradeBuildings.buildings.dataCenter.enabled&&a.unlocked&&a.stage===0&&v(a.stages)[1].stageUnlocked){let h=this._host.game.workshop.get("cryocomputing").researched?1:2;this._host.game.challenges.currentChallenge==="energy"&&(h*=2);let d=3;if(this._host.game.workshop.get("uplink").researched&&(d*=1+this._host.game.bld.getBuildingExt("biolab").meta.val*this._host.game.getEffect("uplinkDCRatio")),this._host.game.workshop.get("machineLearning").researched&&(d*=1+this._host.game.bld.getBuildingExt("aiCore").meta.on*this._host.game.getEffect("dataCenterAIRatio")),this._host.game.resPool.energyProd>=this._host.game.resPool.energyCons+h*a.val/d){const f=v(a.stages)[1].prices;if(this._bulkManager.singleBuildPossible(a,f,1)){const b=v(this.getBuildButton("library",0));if(m(b.model))return;b.controller.sellInternal(b.model,0),a.on=0,a.val=0,a.stage=1,(c=a.calculateEffects)==null||c.call(a,a,this._host.game),this._host.engine.iactivity("upgrade.building.library",[],"ks-upgrade"),this._host.game.ui.render(),this.build("library",1,1),i.requestGameUiRefresh=!0;return}}}const r=this._host.game.bld.getBuildingExt("warehouse").meta;if(this.settings.upgradeBuildings.buildings.spaceport.enabled&&r.unlocked&&r.stage===0&&v(r.stages)[1].stageUnlocked){const h=v(r.stages)[1].prices;if(this._bulkManager.singleBuildPossible(r,h,1)){const d=this.getBuildButton("warehouse",0);if(!m(d==null?void 0:d.model)){d.controller.sellInternal(d.model,0),r.on=0,r.val=0,r.stage=1,this._host.engine.iactivity("upgrade.building.warehouse",[],"ks-upgrade"),this._host.game.ui.render(),this.build("warehouse",1,1),i.requestGameUiRefresh=!0;return}}}const l=this._host.game.bld.getBuildingExt("amphitheatre").meta;if(this.settings.upgradeBuildings.buildings.broadcasttower.enabled&&l.unlocked&&l.stage===0&&v(l.stages)[1].stageUnlocked){const h=v(l.stages)[1].prices;if(this._bulkManager.singleBuildPossible(l,h,1)){const d=this.getBuildButton("amphitheatre",0);m(d==null?void 0:d.model)||(d.controller.sellInternal(d.model,0),l.on=0,l.val=0,l.stage=1,this._host.engine.iactivity("upgrade.building.amphitheatre",[],"ks-upgrade"),this._host.game.ui.render(),this.build("amphitheatre",1,1),i.requestGameUiRefresh=!0)}}}autoMisc(i){if(this.settings.turnOnSteamworks.enabled){const e=this._host.game.bld.getBuildingExt("steamworks");if(e.meta.val&&e.meta.on===0){const t=v(this.getBuildButton("steamworks"));if(m(t.model))return;t.controller.onAll(t.model)}}if(this.settings.turnOnMagnetos.enabled){const e=this._host.game.bld.getBuildingExt("magneto");if(e.meta.val&&e.meta.on<e.meta.val){const t=v(this.getBuildButton("magneto"));if(m(t.model))return;t.controller.onAll(t.model)}}if(this.settings.turnOnReactors.enabled){const e=this._host.game.bld.getBuildingExt("reactor");if(e.meta.val&&e.meta.on<e.meta.val){const t=v(this.getBuildButton("reactor"));if(m(t.model))return;t.controller.onAll(t.model)}}this.settings.upgradeBuildings.enabled&&this.autoUpgrade(i),this.settings.gatherCatnip.enabled&&this.autoGather()}autoGather(){const i=new classes.game.ui.GatherCatnipButtonController(this._host.game);for(let e=0;e<Math.floor(this._host.engine.settings.interval/20);++e)i.buyItem(null,null,()=>{})}build(i,e,t){let n=t;const s=this.getBuild(i),a=this.getBuildButton(i,e);if(!(a!=null&&a.model)||!a.model.enabled)return;const r=n,l=this._getBuildLabel(s.meta,e);n=this._bulkManager.construct(a.model,a,n),n!==r&&U(`${l} Amount ordered: ${r} Amount Constructed: ${n}`),this._host.engine.storeForSummary(l,n,"build"),n===1?this._host.engine.iactivity("act.build",[l],"ks-build"):this._host.engine.iactivity("act.builds",[l,this._host.renderAbsolute(n)],"ks-build")}_getBuildLabel(i,e){return i.stages&&!m(e)?i.stages[e].label:v(i.label)}getBuild(i){return this._host.game.bld.getBuildingExt(i)}getBuildButton(i,e){const t=this.manager.tab.children,n=this.getBuild(i),s=this._getBuildLabel(n.meta,e);return t.find(a=>{var r;return((r=a.model)==null?void 0:r.options.name).startsWith(s)})??null}}const bt=["ivoryCitadel","ivoryTower","skyPalace","sunspire","unicornPasture","unicornTomb","unicornUtopia"],Dn=["sacrificeUnicorns","sacrificeAlicorns","refineTears","refineTimeCrystals","transcend","adore","autoPraise"];class vt extends pt{constructor(e,t,n=!1){super(n);B(this,qe);B(this,ze);P(this,qe,e),P(this,ze,t)}get building(){return A(this,qe)}get variant(){return A(this,ze)}}qe=new WeakMap,ze=new WeakMap;class Kt extends X{constructor(e=!1,t=-1,n=new k,s=new ae(!1,-1),a=new ae(!1,-1),r=new ae(!1,-1),l=new ae(!1,-1),u=new X(!1,1),c=new X(!1,1),h=new k){super(e,t);g(this,"buildings");g(this,"bestUnicornBuilding");g(this,"bestUnicornBuildingCurrent");g(this,"sacrificeAlicorns");g(this,"sacrificeUnicorns");g(this,"refineTears");g(this,"refineTimeCrystals");g(this,"autoPraise");g(this,"adore");g(this,"transcend");this.buildings=this.initBuildings(),this.bestUnicornBuilding=n,this.sacrificeAlicorns=s,this.sacrificeUnicorns=a,this.refineTears=r,this.refineTimeCrystals=l,this.autoPraise=u,this.adore=c,this.transcend=h,this.bestUnicornBuildingCurrent=null}initBuildings(){const e={};for(const t of pi)e[t]=new vt(t,Z.OrderOfTheSun);for(const t of bi)e[t]=new vt(t,Z.Cryptotheology);for(const t of vi)e[t]=new vt(t,Z.Ziggurat);return e.unicornPasture=new vt("unicornPasture",Z.UnicornPasture),e}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.max=(n==null?void 0:n.max)??t.max,t.trigger=(n==null?void 0:n.trigger)??t.trigger}),this.bestUnicornBuilding.load(e.bestUnicornBuilding),this.sacrificeAlicorns.load(e.sacrificeAlicorns),this.sacrificeUnicorns.load(e.sacrificeUnicorns),this.refineTears.load(e.refineTears),this.refineTimeCrystals.load(e.refineTimeCrystals),this.autoPraise.load(e.autoPraise),this.adore.load(e.adore),this.transcend.load(e.transcend),this.bestUnicornBuildingCurrent=e.bestUnicornBuildingCurrent??this.bestUnicornBuildingCurrent)}}class Nn{constructor(i,e,t,n=new Kt){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_bulkManager");g(this,"_bonfireManager");g(this,"_workshopManager");this._host=i,this.settings=n,this.manager=new ue(this._host,"Religion"),this._workshopManager=t,this._bulkManager=new ft(this._host,this._workshopManager),this._bonfireManager=e}async tick(i){this.settings.enabled&&(this.manager.render(),this._autoBuild(i),this.settings.sacrificeUnicorns.enabled&&await this._autoSacrificeUnicorns(),this.settings.sacrificeAlicorns.enabled&&await this._autoSacrificeAlicorns(i),this.settings.refineTears.enabled&&await this._autoTears(i),this.settings.refineTimeCrystals.enabled&&await this._autoTCs(i),this._autoTAP())}_autoBuild(i){if(this.settings.bestUnicornBuilding.enabled)this._buildBestUnicornBuilding(),this._buildNonUnicornBuildings(i);else{const e=Object.fromEntries(Object.entries(this.settings.buildings).filter(([,s])=>s.variant!==Z.UnicornPasture)),t=Te(this.settings.buildings.unicornPasture.max),n=this._host.game.bld.getBuildingExt("unicornPasture").meta;this.settings.buildings.unicornPasture.enabled&&n.val<t&&this._bonfireManager.autoBuild(i,{unicornPasture:new Gt("unicornPasture",this.settings.buildings.unicornPasture.enabled,this.settings.buildings.unicornPasture.max)}),this._buildReligionBuildings(i,e)}}_buildBestUnicornBuilding(){const i=this.getBestUnicornBuilding();if(this.settings.bestUnicornBuildingCurrent!==i&&(this.settings.bestUnicornBuildingCurrent=i,this._host.refreshUi()),this.settings.bestUnicornBuildingCurrent===null)return;const e=this.settings.trigger;if(this.settings.bestUnicornBuildingCurrent==="unicornPasture")this._bonfireManager.build(this.settings.bestUnicornBuildingCurrent,0,1);else{const t=this._getBuildButton(this.settings.bestUnicornBuildingCurrent,Z.Ziggurat);if(m(t==null?void 0:t.model))return;let n=0;const s=v(t.model.prices).find(u=>u.name==="tears");m(s)||(n=s.val);const a=this._workshopManager.getValue("tears")-this._workshopManager.getStock("tears");if(!m(this._host.game.religionTab.sacrificeBtn)&&a<n){const u=Math.floor((this._workshopManager.getValue("unicorns")-this._workshopManager.getStock("unicorns"))/2500),c=Math.ceil((n-a)/this._host.game.bld.getBuildingExt("ziggurat").meta.on);if(c<u&&!m(this._host.game.religionTab.sacrificeBtn.model))this._host.game.religionTab.sacrificeBtn.controller._transform(this._host.game.religionTab.sacrificeBtn.model,c);else return}const r={[this.settings.bestUnicornBuildingCurrent]:this.settings.buildings[this.settings.bestUnicornBuildingCurrent]},l=this._bulkManager.bulk(r,this.getBuildMetaData(r),e,"Religion");0<l.length&&0<l[0].count&&this.build(this.settings.bestUnicornBuildingCurrent,Z.Ziggurat,1)}}_buildNonUnicornBuildings(i){const e=[...bt],t=Object.fromEntries(Object.entries(this.settings.buildings).filter(([,n])=>!e.includes(n.building)));this._buildReligionBuildings(i,t)}_buildReligionBuildings(i,e){this.manager.render();const t=this.getBuildMetaData(e),n=this.settings.trigger,s=this._bulkManager.bulk(e,t,n,"Religion");for(const a of s)0<a.count&&(this.build(a.id,v(a.variant),a.count),i.requestGameUiRefresh=!0)}getBestUnicornBuilding(){var fe,ce,pe;const i=this._bonfireManager.getBuildButton("unicornPasture");if(i===null)return null;const e=[...bt].filter(te=>te!=="unicornPasture"),t=this._host.game.getEffect("unicornsPerTickBase")*this._host.game.getTicksPerSecondUI(),n=this._host.game.getEffect("unicornsGlobalRatio")+1,s=this._host.game.getEffect("unicornsRatioReligion")+1,a=this._host.game.prestige.getParagonProductionRatio()+1,r=this._host.game.religion.getSolarRevolutionRatio()+1,l=this._host.game.calendar.cycle,u=this._host.game.calendar.cycles[l];let c=1;u.festivalEffects.unicorns!==void 0&&this._host.game.prestige.getPerk("numeromancy").researched&&this._host.game.calendar.festivalDays&&(c=u.festivalEffects.unicorns);const h=t*n*s*a*r*c,d=Math.max(this._host.game.bld.getBuildingExt("ziggurat").meta.on,1),f=500*(1+this._host.game.getEffect("unicornsRatioReligion")*.1);let b=1;this._host.game.prestige.getPerk("unicornmancy").researched&&(b*=1.1);const p=this._host.game.getEffect("riftChance")*b/(1e4*2)*f;let y=Number.POSITIVE_INFINITY,w=null;const W=v((fe=this._host.game.bld.getBuildingExt("unicornPasture").meta.effects)==null?void 0:fe.unicornsPerTickBase)*this._host.game.getTicksPerSecondUI()*n*s*a*r*c,ee=v((ce=i.model)==null?void 0:ce.prices)[0].val/W;ee<y&&(y=ee,w="unicornPasture");for(const te of this.manager.tab.zgUpgradeButtons)if(e.includes(te.id)&&((pe=te.model)!=null&&pe.visible)){let Ae=0;for(const Se of v(te.model.prices))Se.name==="unicorns"&&(Ae+=Se.val),Se.name==="tears"&&(Ae+=Se.val*2500/d);const gt=v(this._host.game.religion.getZU(te.id));let It=s,gn=this._host.game.getEffect("riftChance");for(const Se in gt.effects)Se==="unicornsRatioReligion"&&(It+=v(gt.effects.unicornsRatioReligion)),Se==="riftChance"&&(gn+=v(gt.effects.riftChance));const Hl=500*((It-1)*.1+1);let ni=gn*b/(1e4*2)*Hl;ni-=p;let si=t*n*It*a*r*c;si-=h,si+=ni;const dn=Ae/si;dn<y&&(0<ni||s<It&&0<Ae)&&(y=dn,w=te.id)}return w}build(i,e,t){let n=t;const s=this.getBuild(i,e);if(s===null)throw new Error(`Unable to build '${i}'. Build information not available.`);const a=this._getBuildButton(i,e);if(!(a!=null&&a.model)||!a.model.enabled)return;const r=n,l=s.label;n=this._bulkManager.construct(a.model,a,n),n!==r&&U(`${l} Amount ordered: ${r} Amount Constructed: ${n}`),e===Z.OrderOfTheSun?(this._host.engine.storeForSummary(l,n,"faith"),n===1?this._host.engine.iactivity("act.sun.discover",[l],"ks-faith"):this._host.engine.iactivity("act.sun.discovers",[l,this._host.renderAbsolute(n)],"ks-faith")):(this._host.engine.storeForSummary(l,n,"build"),n===1?this._host.engine.iactivity("act.build",[l],"ks-build"):this._host.engine.iactivity("act.builds",[l,this._host.renderAbsolute(n)],"ks-build"))}getBuildMetaData(i){const e={};for(const t of Object.values(i)){const n=this.getBuild(t.building,t.variant);if(n===null)continue;e[t.building]=n;const s=v(e[t.building]);if(!this._getBuildButton(t.building,t.variant))s.rHidden=!0;else{const a=v(this._getBuildButton(t.building,t.variant)).model,r=t.variant===Z.Cryptotheology?this._host.game.science.get("cryptotheology").researched:!0;s.rHidden=!(a!=null&&a.visible&&a.enabled&&r)}}return e}getBuild(i,e){switch(e){case Z.Ziggurat:return this._host.game.religion.getZU(i)??null;case Z.OrderOfTheSun:return this._host.game.religion.getRU(i)??null;case Z.Cryptotheology:return this._host.game.religion.getTU(i)??null}return null}_getBuildButton(i,e){let t;switch(e){case Z.Ziggurat:t=this.manager.tab.zgUpgradeButtons;break;case Z.OrderOfTheSun:t=this.manager.tab.rUpgradeButtons;break;case Z.Cryptotheology:t=this.manager.tab.children[0].children[0].children;break;default:throw new Error(`Invalid variant '${e}'`)}return t.length===0?null:t.find(n=>n.id===i)??null}_transformBtnSacrificeHelper(i,e,t,n){const a=1/(i/e),l=new classes.ui.religion.TransformBtnController(game,t.controllerOpts)._newLink(n,a);return new Promise(u=>{l.handler(new Event("decoy"),u)})}async _autoSacrificeUnicorns(){const i=this._workshopManager.getResource("unicorns"),e=this._workshopManager.getValueAvailable("unicorns");if(!m(this._host.game.religionTab.sacrificeBtn)&&this.settings.sacrificeUnicorns.trigger<=e&&this.settings.sacrificeUnicorns.trigger<=i.value){const t=this._host.game.religionTab.sacrificeBtn.controller,n=this._host.game.religionTab.sacrificeBtn.model;if(m(n))return;await this._transformBtnSacrificeHelper(e,i.value,t,n);const s=this._workshopManager.getValueAvailable("unicorns"),a=e-s;this._host.engine.iactivity("act.sacrificeUnicorns",[this._host.game.getDisplayValueExt(a)],"ks-faith"),this._host.engine.storeForSummary(this._host.engine.i18n("$resources.unicorns.title"),a,"refine")}}async _autoSacrificeAlicorns(i){const e=this._workshopManager.getResource("alicorn"),t=this._workshopManager.getValueAvailable("alicorn");if(!m(this._host.game.religionTab.sacrificeAlicornsBtn)&&this.settings.sacrificeAlicorns.trigger<=t&&this.settings.sacrificeAlicorns.trigger<=e.value){this._host.game.religionTab.sacrificeAlicornsBtn.render();const n=this._host.game.religionTab.sacrificeAlicornsBtn.controller,s=this._host.game.religionTab.sacrificeAlicornsBtn.model;if(m(s)){i.requestGameUiRefresh=!0;return}await this._transformBtnSacrificeHelper(t,e.value,n,s);const a=this._workshopManager.getValueAvailable("alicorn"),r=t-a;this._host.engine.iactivity("act.sacrificeAlicorns",[this._host.game.getDisplayValueExt(r)],"ks-faith"),this._host.engine.storeForSummary(this._host.engine.i18n("$resources.alicorn.title"),r,"refine")}}async _autoTears(i){const e=this._workshopManager.getResource("tears"),t=this._workshopManager.getValueAvailable("tears"),n=this._workshopManager.getResource("sorrow");if(!m(this._host.game.religionTab.refineBtn)&&this.settings.refineTears.trigger<=t&&this.settings.refineTears.trigger<=e.value&&n.value<n.maxValue){const s=t-this.settings.refineTears.trigger;if(s<1e4)return;const a=this._host.game.religionTab.refineBtn.controller,r=this._host.game.religionTab.refineBtn.model;if(m(r)){i.requestGameUiRefresh=!0;return}await new Promise(c=>{a.buyItem(r,new Event("decoy"),c,s)});const l=this._workshopManager.getValueAvailable("tears"),u=t-l;this._host.engine.iactivity("act.refineTears",[this._host.game.getDisplayValueExt(u)],"ks-faith"),this._host.engine.storeForSummary(this._host.engine.i18n("$resources.tears.title"),u,"refine")}}async _autoTCs(i){const e=this._workshopManager.getResource("timeCrystal"),t=this._workshopManager.getValueAvailable("timeCrystal");if(!m(this._host.game.religionTab.refineTCBtn)&&this.settings.refineTimeCrystals.trigger<=t&&this.settings.refineTimeCrystals.trigger<=e.value){const n=this._host.game.religionTab.refineTCBtn.controller,s=this._host.game.religionTab.refineTCBtn.model;if(m(s)){i.requestGameUiRefresh=!0;return}await this._transformBtnSacrificeHelper(t,e.value,n,s);const a=this._workshopManager.getValueAvailable("timeCrystal"),r=t-a;this._host.engine.iactivity("act.refineTCs",[this._host.game.getDisplayValueExt(r)],"ks-faith"),this._host.engine.storeForSummary(this._host.engine.i18n("$resources.timeCrystal.title"),r,"refine")}}_autoTAP(){const i=this._workshopManager.getResource("faith"),e=i.value/i.maxValue;this.settings.transcend.enabled&&this.settings.autoPraise.trigger-.02<=e&&this._autoTranscend(),this.settings.autoPraise.trigger<=e&&(this.settings.adore.enabled&&v(this._host.game.religion.getRU("apocripha")).on&&this._autoAdore(this.settings.adore.trigger),this.settings.autoPraise.enabled&&this._autoPraise())}_autoAdore(i){const e=this._workshopManager.getResource("faith"),t=this._host.game.religion.faith,n=this._host.game.religion.faithRatio,a=v(this._host.game.religion.getRU("transcendence")).on?this._host.game.religion.transcendenceTier:0,r=10+this._host.game.getEffect("solarRevolutionLimit"),l=r*i,u=t/1e6*a*a*1.01,c=n+u,h=.01+e.value*(1+this._host.game.getUnlimitedDR(c,.1)*.1),d=this._host.game.getLimitedDR(this._host.game.getUnlimitedDR(h,1e3)/100,r);l<=d&&(this._host.game.religion._resetFaithInternal(1.01),this._host.engine.iactivity("act.adore",[this._host.game.getDisplayValueExt(t),this._host.game.getDisplayValueExt(u)],"ks-adore"),this._host.engine.storeForSummary("adore",u))}_autoTranscend(){let i=this._host.game.religion.faithRatio;const e=v(this._host.game.religion.getRU("transcendence")).on;let t=e?this._host.game.religion.transcendenceTier:0;if(e){const n=((t+2)/(t+1))**2,s=this._host.game.religion._getTranscendTotalPrice(t+1)-this._host.game.religion._getTranscendTotalPrice(t),a=s,r=n;if((1-r+Math.sqrt(80*(r*r-1)*a+(r-1)*(r-1)))*r/(40*(r+1)*(r+1)*(r-1))+a+a/(r*r-1)<=i){this._host.game.religion.faithRatio-=s,this._host.game.religion.tcratio+=s,this._host.game.religion.transcendenceTier+=1;const u=v(this._host.game.challenges.getChallenge("atheism"));u.calculateEffects(u,this._host.game);const c=v(this._host.game.religion.getTU("blackObelisk"));c.calculateEffects(c,this._host.game),this._host.game.msg(this._host.engine.i18n("$religion.transcend.msg.success",[this._host.game.religion.transcendenceTier])),i=this._host.game.religion.faithRatio,t=this._host.game.religion.transcendenceTier,this._host.engine.iactivity("act.transcend",[this._host.game.getDisplayValueExt(s),t],"ks-transcend"),this._host.engine.storeForSummary("transcend",1)}}}_autoPraise(){const i=this._workshopManager.getResource("faith"),e=this._host.game.religion.getApocryphaBonus(),t=i.value*(1+e);this._host.engine.storeForSummary("praise",t),this._host.engine.iactivity("act.praise",[this._host.game.getDisplayValueExt(i.value),this._host.game.getDisplayValueExt(t)],"ks-praise"),this._host.game.religion.praise()}}class yt{constructor(i){g(this,"_host");this._host=i}async upgrade(i,e){const t=this._getUpgradeButton(i,e);if(!t||!t.model)return!1;if(!t.model.enabled)return U(`${t.model.name} Upgrade request on disabled button!`),t.render(),!1;const n=e==="policy"?new classes.ui.PolicyBtnController(this._host.game):new com.nuclearunicorn.game.ui.TechButtonController(this._host.game);if(this._host.game.opts.noConfirm=!0,!await yt.skipConfirm(()=>new Promise(r=>{n.buyItem(t.model,new MouseEvent("click"),r)})))return!1;const a=i.label;return e==="workshop"?(this._host.engine.storeForSummary(a,1,"upgrade"),this._host.engine.iactivity("upgrade.upgrade",[a],"ks-upgrade")):e==="policy"?this._host.engine.iactivity("upgrade.policy",[a]):e==="science"&&(this._host.engine.storeForSummary(a,1,"research"),this._host.engine.iactivity("upgrade.tech",[a],"ks-research")),!0}static async skipConfirm(i){const e=game.ui.confirm;try{return game.ui.confirm=()=>!0,await i()}finally{game.ui.confirm=e}}_getUpgradeButton(i,e){let t;return e==="workshop"?t=this.manager.tab.buttons:e==="policy"?t=this.manager.tab.policyPanel.children:e==="science"&&(t=this.manager.tab.buttons),(t==null?void 0:t.find(n=>{var s;return((s=n.model)==null?void 0:s.name)===i.label}))??null}}const qn=o=>new Promise(i=>setTimeout(i,o)),Ee="en-US",zn=2*60*1e3,Wn="localStorage"in globalThis&&!m(localStorage["ks.timeout"])?Number(localStorage["ks.timeout"]):void 0;class O{constructor(){g(this,"_gameStartSignal");g(this,"_gameStartSignalResolver");g(this,"_possibleEngineState")}static tryEngineStateFromSaveData(i,e){const t=e;if(!(i in t)){be(`Failed: \`${i}\` not found in save data.`);return}const n=t.ks;if(!("state"in n)){be(`Failed: \`${i}.state\` not found in save data.`);return}const s=n.state;if(!Array.isArray(s)){be(`Failed: \`${i}.state\` not \`Array\`.`);return}return s[0]}async waitForGame(i,e,t=Wn??zn){if(O._isGameLoaded()){const s=v(O.window.game),a=v(O.window.$I),r=localStorage["com.nuclearunicorn.kittengame.language"];return new i(s,a,r,this._possibleEngineState)}const n=[qn(2e3)];if(m(this._gameStartSignal)&&typeof O.window.dojo<"u"){this._gameStartSignal=new Promise(a=>{this._gameStartSignalResolver=a});const s=O.window.dojo.subscribe("game/start",()=>{be(`'game/start' signal caught. Fast-tracking script load for '${e}'...`),v(this._gameStartSignalResolver)(!0),O.window.dojo.unsubscribe(s)});if(e!==void 0){const a=O.window.dojo.subscribe("server/load",r=>{H(`'server/load' signal caught. Looking for script state with key '${e}' in save data...`);const l=O.tryEngineStateFromSaveData(e,r);if(!l){H(`The Kittens Game save data did not contain a script state for '${e}'.`);return}H(`Found key '${e}'! Provided save data will be used as seed for next script instance.`),this._possibleEngineState=l,O.window.dojo.unsubscribe(a)})}}if(m(this._gameStartSignal)||n.push(this._gameStartSignal),t<0)throw new Error("Unable to find game. Giving up. Maybe the game is not exported at `window.game`?");return be(`Waiting for game... (timeout: ${Math.round(t/1e3)}s)`),await Promise.race(n),this.waitForGame(i,e,t-2e3)}static _isGameLoaded(){return!m(O.window.game)&&!Object.prototype.toString.apply(O.window.game).includes("HTMLDivElement")}static get window(){try{return v(unsafeWindow)}catch{return window}}}class Hn extends k{constructor(e,t=!1){super(t);B(this,We);P(this,We,e)}get policy(){return A(this,We)}}We=new WeakMap;class Ai extends k{constructor(e=!1){super(e);g(this,"policies");this.policies=this.initPolicies()}initPolicies(){const e={};for(const t of Cn)e[t]=new Hn(t);return e}static validateGame(e,t){const n=Object.keys(t.policies),s=e.science.policies.map(l=>l.name),a=se(s,n),r=se(n,s);for(const l of a)U(`The policy '${l}' is not tracked in Kitten Scientists!`);for(const l of r)U(`The policy '${l}' is not a policy in Kittens Game!`)}load(e){m(e)||(super.load(e),N(this.policies,e.policies,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}))}}class Fn extends X{constructor(e,t=!1){super(t,-1);B(this,He);P(this,He,e)}get tech(){return A(this,He)}}He=new WeakMap;class Bi extends X{constructor(e=!1){super(e,0);g(this,"techs");this.techs=this.initTechs()}initTechs(){const e={};for(const t of Tn)e[t]=new Fn(t);return e}static validateGame(e,t){const n=Object.keys(t.techs),s=e.science.techs.map(l=>l.name),a=se(s,n),r=se(n,s);for(const l of a)yi.includes(l)||U(`The technology '${l}' is not tracked in Kitten Scientists!`);for(const l of r){if(yi.includes(l)){H(`The technology '${l}' is a technology in Kittens Game, but it's no longer used.`);continue}U(`The technology '${l}' is not a technology in Kittens Game!`)}}load(e){m(e)||(super.load(e),N(this.techs,e.techs,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class Vt extends k{constructor(e=!1,t=new Ai,n=new Bi,s=new k){super(e);g(this,"policies");g(this,"techs");g(this,"observe");this.policies=t,this.techs=n,this.observe=s}static validateGame(e,t){Ai.validateGame(e,t.policies),Bi.validateGame(e,t.techs)}load(e){var t;m(e)||(super.load(e),this.policies.load(e.policies),this.techs.load(e.techs),this.observe.enabled=((t=e.observe)==null?void 0:t.enabled)??this.observe.enabled)}}class Gn extends yt{constructor(e,t,n=new Vt){super(e);g(this,"manager");g(this,"settings");g(this,"_workshopManager");this.settings=n,this.manager=new ue(this._host,"Science"),this._workshopManager=t}async tick(e){this.settings.enabled&&(this.manager.render(),this.settings.techs.enabled&&this._host.game.tabs[2].visible&&await this.autoUnlock(),this.settings.policies.enabled&&this._host.game.tabs[2].visible&&await this.autoPolicy(),this.settings.observe.enabled&&this.observeStars())}async autoUnlock(){const e=this._host.game.science.techs,t=new Array;e:for(const n of Object.values(this.settings.techs.techs)){if(!n.enabled)continue;const s=e.find(r=>r.name===n.tech);if(m(s)){ge(`Tech '${n.tech}' not found in game!`);continue}if(s.researched||!s.unlocked)continue;let a=O.window.dojo.clone(s.prices);a=this._host.game.village.getEffectLeader("scientist",a);for(const r of a){const l=this._workshopManager.getValueAvailable(r.name),u=this._workshopManager.getResource(r.name),c=re.evaluateSubSectionTrigger(this.settings.techs.trigger,n.trigger);if(c<0||l<u.maxValue*c||l<r.val)continue e}t.push(s)}for(const n of t)await this.upgrade(n,"science")}async autoPolicy(){const e=this._host.game.science.policies,t=new Array;for(const n of Object.values(this.settings.policies.policies)){if(!n.enabled)continue;const s=e.find(a=>a.name===n.policy);if(m(s)){ge(`Policy '${n.policy}' not found in game!`);continue}!s.researched&&!s.blocked&&s.unlocked&&(s.requiredLeaderJob===void 0||this._host.game.village.leader!==null&&this._host.game.village.leader.job===s.requiredLeaderJob)&&t.push(s)}for(const n of t)await this.upgrade(n,"policy")}observeStars(){this._host.game.calendar.observeBtn!==null&&(this._host.game.calendar.observeHandler(),this._host.engine.iactivity("act.observe",[],"ks-star"),this._host.engine.storeForSummary("stars",1))}}class Zn extends k{constructor(e,t=!1){super(t);B(this,Fe);P(this,Fe,e)}get mission(){return A(this,Fe)}}Fe=new WeakMap;class Pi extends k{constructor(e=!1){super(e);g(this,"missions");this.missions=this.initMissions()}initMissions(){const e={};for(const t of En)e[t]=new Zn(t);return e}static validateGame(e,t){const n=Object.keys(t.missions),s=e.space.programs.map(l=>l.name),a=se(s,n),r=se(n,s);for(const l of a)U(`The space mission '${l}' is not tracked in Kitten Scientists!`);for(const l of r)U(`The space mission '${l}' is not a space mission in Kittens Game!`)}load(e){m(e)||(super.load(e),N(this.missions,e.missions,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}))}}class Kn extends pt{constructor(e){super();B(this,Ge);P(this,Ge,e)}get building(){return A(this,Ge)}}Ge=new WeakMap;class kt extends X{constructor(e=!1,t=-1,n=new Pi){super(e,t);g(this,"buildings");g(this,"unlockMissions");this.buildings=this.initBuildings(),this.unlockMissions=n}initBuildings(){const e={};for(const t of ki)e[t]=new Kn(t);return e}static validateGame(e,t){Pi.validateGame(e,t.unlockMissions)}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.max=(n==null?void 0:n.max)??t.max,t.trigger=(n==null?void 0:n.trigger)??t.trigger}),this.unlockMissions.load(e.unlockMissions))}}class Vn{constructor(i,e,t=new kt){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_bulkManager");g(this,"_workshopManager");this._host=i,this.settings=t,this.manager=new ue(this._host,"Space"),this._workshopManager=e,this._bulkManager=new ft(this._host,this._workshopManager)}tick(i){this.settings.enabled&&(this.manager.render(),this.autoBuild(i),this.settings.unlockMissions.enabled&&this.autoUnlock(i))}autoBuild(i,e=this.settings.buildings){const t=this._bulkManager,n=this.settings.trigger,s={};for(const r of Object.values(e))s[r.building]=this.getBuild(r.building);const a=t.bulk(e,s,n,"Space");for(const r of a)r.count<=0||this.build(r.id,r.count)!==0&&(i.requestGameUiRefresh=!0)}autoUnlock(i){var t,n;if(!this._host.game.tabs[6].visible)return;const e=this._host.game.space.meta[0].meta;e:for(let s=0;s<e.length;s++){if(0<e[s].val||!e[s].unlocked||!this.settings.unlockMissions.missions[e[s].name].enabled)continue;const a=(t=this.manager.tab.GCPanel)==null?void 0:t.children[s];if(m(a))return;const r=v((n=a.model)==null?void 0:n.prices);for(const l of r)if(this._workshopManager.getValueAvailable(l.name)<l.val)continue e;a.domNode.click(),i.requestGameUiRefresh=!0,s===7||s===12?this._host.engine.iactivity("upgrade.space.mission",[e[s].label],"ks-upgrade"):this._host.engine.iactivity("upgrade.space",[e[s].label],"ks-upgrade")}}build(i,e){let t=e;const n=this.getBuild(i),s=this._getBuildButton(i);if(!n.unlocked||!(s!=null&&s.model)||!this.settings.buildings[i].enabled||!s.model.enabled)return 0;const a=t,r=n.label;return t=this._bulkManager.construct(s.model,s,t),t!==a&&U(`${r} Amount ordered: ${a} Amount Constructed: ${t}`),this._host.engine.storeForSummary(r,t,"build"),t===1?this._host.engine.iactivity("act.build",[r],"ks-build"):this._host.engine.iactivity("act.builds",[r,this._host.renderAbsolute(t)],"ks-build"),t}getBuild(i){return this._host.game.space.getBuilding(i)}_getBuildButton(i){const e=this.manager.tab.planetPanels;if(m(e))return null;for(const t of e){const n=t.children.find(s=>s.id===i);if(!m(n))return n}return null}}class Ui extends ae{constructor(e,t=!1,n=-1,s){super(t,n);B(this,Ze);B(this,Ke);B(this,Ve,0);P(this,Ke,e),s&&(P(this,Ve,1),P(this,Ze,s))}get baseBuilding(){return A(this,Ze)}get building(){return A(this,Ke)}get stage(){return A(this,Ve)}}Ze=new WeakMap,Ke=new WeakMap,Ve=new WeakMap;class jn extends k{constructor(e=!1){super(e);g(this,"buildings");this.buildings=this.initBuildings()}initBuildings(){const e={broadcasttower:"amphitheatre",dataCenter:"library",hydroplant:"aqueduct",solarfarm:"pasture",spaceport:"warehouse"},t={};for(const n of fi)n!=="unicornPasture"&&(t[n]=new Ui(n));for(const n of Ht)t[n]=new Ui(n,!1,-1,e[n]);return t}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class wt extends ae{constructor(e,t,n=!1,s=-1){super(n,s);B(this,je);B(this,Xe);P(this,je,e),P(this,Xe,t)}get building(){return A(this,je)}get variant(){return A(this,Xe)}}je=new WeakMap,Xe=new WeakMap;class Xn extends k{constructor(e=!1){super(e);g(this,"buildings");this.buildings=this.initBuildings()}initBuildings(){const e={};for(const t of pi)e[t]=new wt(t,Z.OrderOfTheSun);for(const t of bi)e[t]=new wt(t,Z.Cryptotheology);for(const t of vi)e[t]=new wt(t,Z.Ziggurat);return e.unicornPasture=new wt("unicornPasture",Z.UnicornPasture),e}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class Jn extends ae{constructor(e,t=!1,n=-1){super(t,n);B(this,Je);P(this,Je,e)}get resource(){return A(this,Je)}}Je=new WeakMap;class Yn extends k{constructor(e=!1){super(e);g(this,"resources");this.resources=this.initResources()}initResources(){const e={};for(const t of Ti)e[t]=new Jn(t);return e}load(e){m(e)||(super.load(e),N(this.resources,e.resources,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class Qn extends ae{constructor(e,t=!1,n=-1){super(t,n);B(this,Ye);P(this,Ye,e)}get building(){return A(this,Ye)}}Ye=new WeakMap;class es extends k{constructor(e=!1){super(e);g(this,"buildings");this.buildings=this.initBuildings()}initBuildings(){const e={};for(const t of ki)e[t]=new Qn(t);return e}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class Ii extends ae{constructor(e,t,n=!1,s=-1){super(n,s);B(this,Qe);B(this,et);P(this,Qe,e),P(this,et,t)}get building(){return A(this,Qe)}get variant(){return A(this,et)}}Qe=new WeakMap,et=new WeakMap;class ts extends k{constructor(e=!1){super(e);g(this,"buildings");this.buildings=this.initBuildings()}initBuildings(){const e={};for(const t of wi)e[t]=new Ii(t,de.Chronoforge);for(const t of _i)t!=="usedCryochambers"&&(e[t]=new Ii(t,de.VoidSpace));return e}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class is extends k{constructor(e,t=!1){super(t);B(this,tt);P(this,tt,e)}get upgrade(){return A(this,tt)}}tt=new WeakMap;class ns extends k{constructor(e=!1){super(e);g(this,"upgrades");this.upgrades=this.initUpgrades()}initUpgrades(){const e={};for(const t of xi)e[t]=new is(t);return e}load(e){m(e)||(super.load(e),N(this.upgrades,e.upgrades,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}))}}class ss extends k{constructor(e=!1,t=new jn,n=new Xn,s=new Yn,a=new es,r=new ts,l=new ns){super(e);g(this,"bonfire");g(this,"religion");g(this,"resources");g(this,"space");g(this,"time");g(this,"upgrades");this.bonfire=t,this.religion=n,this.resources=s,this.space=a,this.time=r,this.upgrades=l}load(e){m(e)||(super.load(e),this.bonfire.load(e.bonfire),this.religion.load(e.religion),this.resources.load(e.resources),this.space.load(e.space),this.time.load(e.time),this.upgrades.load(e.upgrades))}}class as extends X{constructor(e=new k){super(!1,1);g(this,"cycles");g(this,"activeHeatTransferStatus");this.cycles=this.initCycles(),this.activeHeatTransferStatus=e}initCycles(){const e={};for(const t of we)e[t]=new k;return e}load(e){m(e)||(super.load(e),N(this.cycles,e.cycles,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}),this.activeHeatTransferStatus.load(e.activeHeatTransferStatus))}}class rs extends Un{constructor(e=new k,t=new as){super(!1,5);g(this,"cycles");g(this,"seasons");g(this,"activeHeatTransfer");g(this,"ignoreOverheat");this.cycles=this.initCycles(),this.seasons=this.initSeason(),this.activeHeatTransfer=t,this.ignoreOverheat=e}initCycles(){const e={};for(const t of we)e[t]=new k;return e}initSeason(){const e={};for(const t of Mn)e[t]=new k;return e}load(e){m(e)||(super.load(e),N(this.cycles,e.cycles,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}),N(this.seasons,e.seasons,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled}),this.ignoreOverheat.load(e.ignoreOverheat),this.activeHeatTransfer.load(e.activeHeatTransfer))}}class Li extends k{constructor(e=!1,t=new X(!1,1),n=new ss,s=new rs){super(e);g(this,"accelerateTime");g(this,"timeSkip");g(this,"reset");this.accelerateTime=t,this.reset=n,this.timeSkip=s}load(e){m(e)||(super.load(e),this.accelerateTime.load(e.accelerateTime),this.reset.load(e.reset),this.timeSkip.load(e.timeSkip))}}class ls{constructor(i,e,t,n,s,a=new Li){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_bonfireManager");g(this,"_religionManager");g(this,"_spaceManager");g(this,"_workshopManager");this._host=i,this.settings=a,this.manager=new ue(this._host,"Time"),this._bonfireManager=e,this._religionManager=t,this._spaceManager=n,this._workshopManager=s}async tick(i){this.settings.enabled&&(this.settings.accelerateTime.enabled&&this.accelerateTime(),this.settings.timeSkip.enabled&&this.timeSkip(),this.settings.reset.enabled&&await this.autoReset(this._host.engine))}async autoReset(i){if(this._host.game.challenges.currentChallenge)return;const e=[],t=[],n=r=>{if(t.length!==0)for(const l of r){if(m(l.model))continue;const u=l.model.metadata.name,c=t.indexOf(u);if(c!==-1&&(t.splice(c,1),this._host.game.resPool.hasRes(v(l.model.prices))))return!0}return!1};for(const[r,l]of D(this.settings.reset.bonfire.buildings))if(l.enabled){let u;try{u=this._host.game.bld.getBuildingExt(r)}catch{u=null}if(m(u))continue;if(e.push({name:u.meta.label??v(u.meta.stages)[v(u.meta.stage)].label,trigger:l.trigger,val:u.meta.val}),0<l.trigger){if(u.meta.val<l.trigger)return}else t.push(r)}const s=this.settings.reset.religion.buildings.unicornPasture;if(s.enabled){const r=this._host.game.bld.getBuildingExt("unicornPasture");if(e.push({name:v(r.meta.label),trigger:s.trigger,val:r.meta.val}),0<s.trigger){if(r.meta.val<s.trigger)return}else t.push("unicornPasture")}if(n(this._bonfireManager.manager.tab.children)||t.length)return;for(const[r,l]of D(this.settings.reset.space.buildings))if(l.enabled){const u=this._host.game.space.getBuilding(r);if(e.push({name:u.label,trigger:l.trigger,val:u.val}),0<l.trigger){if(u.val<l.trigger)return}else t.push(r)}if(t.length===0){const r=v(this._spaceManager.manager.tab.planetPanels);for(const l of r)for(const u of l.children){const c=u.model,h=c.metadata.name,d=t.indexOf(h);if(d!==-1&&(t.splice(d,1),this._host.game.resPool.hasRes(v(c.prices))))break}}if(t.length)return;for(const[r,l]of D(this.settings.reset.religion.buildings)){if(!l.enabled)continue;const u=v(this._religionManager.getBuild(r,l.variant));if(e.push({name:u.label,trigger:l.trigger,val:u.val}),0<l.trigger){if(u.val<l.trigger)return}else t.push(r)}if(n(this._religionManager.manager.tab.zgUpgradeButtons)||n(this._religionManager.manager.tab.rUpgradeButtons)||n(this._religionManager.manager.tab.children[0].children[0].children)||t.length)return;for(const[r,l]of D(this.settings.reset.time.buildings))if(l.enabled){const u=v(this.getBuild(r,l.variant));if(e.push({name:u.label,trigger:l.trigger,val:u.val}),0<l.trigger){if(u.val<l.trigger)return}else t.push(r)}if(n(this.manager.tab.children[2].children[0].children)||n(this.manager.tab.children[3].children[0].children)||t.length)return;for(const[r,l]of D(this.settings.reset.resources.resources))if(l.enabled){const u=v(this._host.game.resPool.get(r));if(e.push({name:this._host.engine.i18n(`$resources.${l.resource}.title`),trigger:l.trigger,val:u.value}),u.value<l.trigger)return}for(const[,r]of D(this.settings.reset.upgrades.upgrades))if(r.enabled){const l=v(this._host.game.workshop.upgrades.find(u=>u.name===r.upgrade));if(e.push({name:l.label,trigger:1,val:l.researched?1:0}),!l.researched)return}i.stop(!1);const a=async(r=1500)=>new Promise((l,u)=>{if(!this._host.engine.settings.enabled){u(new Error("canceled by player"));return}setTimeout(l,r)});try{for(const r of e)await a(500),this._host.engine.imessage("reset.check",[r.name,this._host.game.getDisplayValueExt(r.trigger),this._host.game.getDisplayValueExt(r.val)]);await a(0),this._host.engine.imessage("reset.checked"),await a(),this._host.engine.iactivity("reset.tip"),await a(),this._host.engine.imessage("reset.countdown.10"),await a(2e3),this._host.engine.imessage("reset.countdown.9"),await a(),this._host.engine.imessage("reset.countdown.8"),await a(),this._host.engine.imessage("reset.countdown.7"),await a(),this._host.engine.imessage("reset.countdown.6"),await a(),this._host.engine.imessage("reset.countdown.5"),await a(),this._host.engine.imessage("reset.countdown.4"),await a(),this._host.engine.imessage("reset.countdown.3"),await a(),this._host.engine.imessage("reset.countdown.2"),await a(),this._host.engine.imessage("reset.countdown.1"),await a(),this._host.engine.imessage("reset.countdown.0"),await a(),this._host.engine.iactivity("reset.last.message"),await a()}catch{this._host.engine.imessage("reset.cancel.message"),this._host.engine.iactivity("reset.cancel.activity");return}for(let r=0;r<this._host.game.challenges.challenges.length;r++)this._host.game.challenges.challenges[r].pending=!1;this._host.game.resetAutomatic()}accelerateTime(){if(this._workshopManager.getValueAvailable("temporalFlux")<=0){this._host.game.time.isAccelerated&&(this._host.game.time.isAccelerated=!1);return}if(this._host.game.time.isAccelerated)return;const e=this._host.game.resPool.get("temporalFlux");e.maxValue*this.settings.accelerateTime.trigger<=e.value&&(this._host.game.time.isAccelerated=!0,this._host.engine.iactivity("act.accelerate",[],"ks-accelerate"),this._host.engine.storeForSummary("accelerate",1))}timeSkip(){if(!this._host.game.workshop.get("chronoforge").researched||this._host.game.calendar.day<0)return;const i=this._host.game.getEffect("shatterCostIncreaseChallenge"),e=this._workshopManager.getValueAvailable("timeCrystal");if(e<this.settings.timeSkip.trigger||e<1+i)return;const t=this._host.game.getEffect("shatterVoidCost"),n=this._workshopManager.getValueAvailable("void");if(n<t)return;const s=this._host.game.calendar.season;if(!this.settings.timeSkip.seasons[this._host.game.calendar.seasons[s].name].enabled)return;const a=this._host.game.calendar.cycle;if(!this.settings.timeSkip.cycles[we[a]].enabled)return;const r=this._host.game.getEffect("heatMax"),l=this._host.game.time.heat;if(!this.settings.timeSkip.ignoreOverheat.enabled&&r<=l)return;const u=this._host.game.challenges.getChallenge("1000Years").researched?5:10;let c=Number.POSITIVE_INFINITY;if(!this.settings.timeSkip.ignoreOverheat.enabled&&this.settings.timeSkip.activeHeatTransfer.enabled){const w=this._host.game.getEffect("heatPerTick"),G=this._host.game.ticksPerSecond;if(this.settings.timeSkip.activeHeatTransfer.activeHeatTransferStatus.enabled){l<=r*this.settings.timeSkip.activeHeatTransfer.trigger&&(this.settings.timeSkip.activeHeatTransfer.activeHeatTransferStatus.enabled=!1,this._host.refreshUi(),this._host.engine.iactivity("act.time.activeHeatTransferEnd",[],"ks-timeSkip"));const W=this._host.game.getEffect("temporalFluxProduction"),ee=(this._host.game.calendar.daysPerSeason+10+this._host.game.getEffect("temporalParadoxDay"))*this._host.game.calendar.seasonsPerYear,fe=this._host.game.calendar.ticksPerDay,ce=(1+this._host.game.timeAccelerationRatio())/fe,pe=ee/ce,te=this._host.game.resPool.get("temporalFlux"),Ae=te.maxValue>pe,gt=te.value<pe;if(!s&&this._host.game.calendar.day<10&&W>u/w&&this.settings.accelerateTime.enabled&&Ae&&gt)c=Math.ceil((pe+fe*10-te.value)/W),this._host.engine.iactivity("act.time.getTemporalFlux",[],"ks-timeSkip"),this._host.engine.storeForSummary("time.getTemporalFlux",1);else{if(this.settings.timeSkip.activeHeatTransfer.cycles[we[a]].enabled)return;c=this._host.game.calendar.yearsPerCycle-this._host.game.calendar.cycleYear}}else l>=r-w*G*10&&(this.settings.timeSkip.activeHeatTransfer.activeHeatTransferStatus.enabled=!0,this._host.refreshUi(),this._host.engine.iactivity("act.time.activeHeatTransferStart",[],"ks-timeSkip"),this._host.engine.storeForSummary("time.activeHeatTransferStart",1))}const h=Te(this.settings.timeSkip.max);let d=Math.floor(Math.min(this.settings.timeSkip.ignoreOverheat.enabled?Number.POSITIVE_INFINITY:(r-l)/u,h,c,e/(1+i),0<t?n/t:Number.POSITIVE_INFINITY)),f=0;const b=this._host.game.calendar.yearsPerCycle,p=b-this._host.game.calendar.cycleYear,y=this._host.game.calendar.cyclesPerEra;if(d<p)f=d;else{f+=p,d-=p;let w=1;for(;b<d&&this.settings.timeSkip.cycles[we[(a+w)%y]].enabled;)f+=b,d-=b,w+=1;this.settings.timeSkip.cycles[we[(a+w)%y]].enabled&&0<d&&(f+=d)}if(0<f){const w=this._host.game.timeTab.cfPanel.children[0].children[0];if(m(w.model))return;this._host.engine.iactivity("act.time.skip",[f],"ks-timeSkip"),w.controller.doShatterAmt(w.model,f),this._host.engine.storeForSummary("time.skip",f)}}getBuild(i,e){return e===de.Chronoforge?this._host.game.time.getCFU(i):this._host.game.time.getVSU(i)}}class $i extends pt{constructor(e,t,n=!1){super(n);B(this,it);B(this,nt);P(this,it,e),P(this,nt,t)}get building(){return A(this,it)}get variant(){return A(this,nt)}}it=new WeakMap,nt=new WeakMap;class Oi extends X{constructor(e=!1,t=-1,n=new k){super(e,t);g(this,"buildings");g(this,"fixCryochambers");this.buildings=this.initBuildings(),this.fixCryochambers=n}initBuildings(){const e={};for(const t of wi)e[t]=new $i(t,de.Chronoforge);for(const t of _i)t!=="usedCryochambers"&&(e[t]=new $i(t,de.VoidSpace));return e}load(e){m(e)||(super.load(e),N(this.buildings,e.buildings,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.max=(n==null?void 0:n.max)??t.max,t.trigger=(n==null?void 0:n.trigger)??t.trigger}),this.fixCryochambers.load(e.fixCryochambers))}}class os{constructor(i,e,t=new Oi){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_bulkManager");g(this,"_workshopManager");this._host=i,this.settings=t,this.manager=new ue(this._host,"Time"),this._bulkManager=new ft(this._host,e),this._workshopManager=e}tick(i){this.settings.enabled&&(this.manager.render(),this.autoBuild(i),this.settings.fixCryochambers.enabled&&this.fixCryochambers())}autoBuild(i,e=this.settings.buildings){const t=this._bulkManager,n=this.settings.trigger,s={};for(const r of Object.values(e)){const l=this.getBuild(r.building,r.variant);s[r.building]=v(l);const u=this.getBuildButton(r.building,r.variant);if(m(u))continue;const c=u.model,h=r.variant===de.Chronoforge?this.manager.tab.cfPanel:this.manager.tab.vsPanel,d=v(s[r.building]);d.tHidden=!(c!=null&&c.visible)||!c.enabled||!h.visible}const a=t.bulk(e,s,n,"Time");for(const r of a)r.count>0&&(this.build(r.id,r.variant,r.count),i.requestGameUiRefresh=!0)}build(i,e,t){var u;let n=t;const s=v(this.getBuild(i,e)),a=this.getBuildButton(i,e);if(!a||!((u=a.model)!=null&&u.enabled))return;const r=n,l=s.label;n=this._bulkManager.construct(a.model,a,n),n!==r&&U(`${l} Amount ordered: ${r} Amount Constructed: ${n}`),this._host.engine.storeForSummary(l,n,"build"),n===1?this._host.engine.iactivity("act.build",[l],"ks-build"):this._host.engine.iactivity("act.builds",[l,this._host.renderAbsolute(n)],"ks-build")}getBuild(i,e){return e===de.Chronoforge?this._host.game.time.getCFU(i):this._host.game.time.getVSU(i)}getBuildButton(i,e){let t;return e===de.Chronoforge?t=this.manager.tab.children[2].children[0].children:t=this.manager.tab.children[3].children[0].children,t.find(n=>n.id===i)??null}fixCryochambers(){if(this._host.game.time.getVSU("usedCryochambers").val<1)return;const i=v(this._host.game.time.getVSU("usedCryochambers").fixPrices);for(const s of i)if(this._workshopManager.getValueAvailable(s.name)<s.val)return;const e=this.manager.tab.vsPanel.children[0].children[0];let t=0,n;do n=!1,e.controller.buyItem(e.model,new MouseEvent("click"),s=>{n=s,t+=s?1:0});while(n);0<t&&(this._host.engine.iactivity("act.fix.cry",[this._host.renderAbsolute(t)],"ks-fixCry"),this._host.engine.storeForSummary("fix.cry",t))}}class cs extends Ri{constructor(e,t=!1){super(t);B(this,st);P(this,st,e)}get race(){return A(this,st)}}st=new WeakMap;class us extends X{constructor(e=!1){super(e);g(this,"races");this.races=this.initRaces()}initRaces(){const e={};for(const t of Si)e[t]=new cs(t);return e}load(e){m(e)||(super.load(e),N(this.races,e.races,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.max=(n==null?void 0:n.max)??t.max}))}}class gs extends Pn{constructor(e,t,n,s,a,r,l,u=!1){super(t,n);B(this,at);g(this,"seasons");B(this,rt);P(this,at,e),this.seasons={summer:new k(s),autumn:new k(a),winter:new k(r),spring:new k(l)},P(this,rt,u)}get race(){return A(this,at)}get require(){return A(this,rt)}}at=new WeakMap,rt=new WeakMap;class Di extends X{constructor(e=!1,t=1,n=new us,s=new k,a=new In(!1,1090,1095,1e4),r=new k){super(e,t);g(this,"races");g(this,"feedLeviathans");g(this,"buildEmbassies");g(this,"tradeBlackcoin");g(this,"unlockRaces");this.races=this.initRaces(),this.buildEmbassies=n,this.feedLeviathans=s,this.tradeBlackcoin=a,this.unlockRaces=r}initRaces(){const e={dragons:"titanium",griffins:"wood",leviathans:"unobtainium",lizards:"minerals",sharks:"iron"},t={};for(const n of Si){const s=e[n]??!1;t[n]=new gs(n,!1,!1,!1,!1,!1,!1,s)}return t}load(e){m(e)||(super.load(e),N(this.races,e.races,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.limited=(n==null?void 0:n.limited)??t.limited,t.trigger=(n==null?void 0:n.trigger)??t.trigger,t.seasons.autumn.enabled=(n==null?void 0:n.seasons.autumn.enabled)??t.seasons.autumn.enabled,t.seasons.spring.enabled=(n==null?void 0:n.seasons.spring.enabled)??t.seasons.spring.enabled,t.seasons.summer.enabled=(n==null?void 0:n.seasons.summer.enabled)??t.seasons.summer.enabled,t.seasons.winter.enabled=(n==null?void 0:n.seasons.winter.enabled)??t.seasons.winter.enabled}),this.buildEmbassies.load(e.buildEmbassies),this.feedLeviathans.load(e.feedLeviathans),this.tradeBlackcoin.load(e.tradeBlackcoin),this.unlockRaces.load(e.unlockRaces))}}class ds{constructor(i,e,t=new Di){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_workshopManager");this._host=i,this.settings=t,this.manager=new ue(this._host,"Trade"),this._workshopManager=e}tick(i){this.settings.enabled&&(this.manager.render(),this.autoTrade(),this.settings.unlockRaces.enabled&&this.autoUnlock(i),this.settings.buildEmbassies.enabled&&this.autoBuildEmbassies(i),this.settings.feedLeviathans.enabled&&this.autoFeedElders(),this.settings.tradeBlackcoin.enabled&&this.autoTradeBlackcoin())}autoTrade(i){var h;const e=this._workshopManager.getResource("manpower"),t=this._workshopManager.getResource("gold"),n=this.settings.trigger;if(!this.singleTradePossible(n,e,t))return;const s=[],a=this._host.game.calendar.getCurSeason().name;for(const d of Object.values(this.settings.races)){const f=this.getRace(d.race),b=re.evaluateSubSectionTrigger(n,d.trigger);if(b<0||!d.enabled||!d.seasons[a].enabled||!f.unlocked||!this.singleTradePossible(n,e,t,d))continue;const p=this.getTradeButton(f.name);if(!((h=p==null?void 0:p.model)!=null&&h.enabled))continue;const y=d.require?this._workshopManager.getResource(d.require):!1,w=this.getProfitability(d.race);(d.limited&&w||!y||b<=y.value/y.maxValue)&&s.push(d.race)}if(s.length===0)return;let r=this.getLowestTradeAmount(null,!0,!1);if(r<1)return;const l=[];for(let d=0;d<s.length;d++){const f=s[d],b=this.settings.races[f],p=b.require?this._workshopManager.getResource(b.require):!1,y=re.evaluateSubSectionTrigger(n,b.trigger),w=(!p||y<=p.value/p.maxValue)&&y<=t.value/t.maxValue,G=this.getLowestTradeAmount(f,b.limited,w);if(G<1){s.splice(d,1),d--;continue}l.push(G)}if(s.length===0)return;const u={};for(;0<s.length&&1<=r;){if(r<s.length){const p=Math.floor(Math.random()*s.length),y=s[p];m(u[y])&&(u[y]=0),u[y]+=1,r-=1,s.splice(p,1),l.splice(p,1);continue}let d=Math.floor(r/s.length),f=0;const b=s[f];for(let p=0;p<s.length;++p)l[p]<d&&(d=l[p],f=p);m(u[b])&&(u[b]=0),u[b]+=d,r-=d,s.splice(f,1),l.splice(f,1)}if(Object.values(u).length===0)return;const c={};for(const[d,f]of D(u)){const b=this.getRace(d),p=this.getMaterials(d);for(const[w,G]of D(p))c[w]||(c[w]=0),c[w]-=G*f;const y=this.getAverageTrade(b);for(const[w,G]of D(y)){const W=this._workshopManager.getResource(w);c[w]||(c[w]=0),c[w]+=W.maxValue>0?Math.min(v(y[w])*v(u[d]),Math.max(W.maxValue-W.value,0)):G*v(u[d])}}m(i)||i.pushToCache({materials:c,timeStamp:this._host.game.timer.ticksTotal});for(const[d,f]of D(u))0<f&&this.trade(d,f)}autoBuildEmbassies(i){var l;if(!this._host.game.diplomacy.races[0].embassyPrices)return;const e=this._workshopManager.getResource("culture");let t=0;const n=this.settings.buildEmbassies.trigger;if(e.value/e.maxValue<n)return;const s=this._host.game.diplomacyTab.racePanels;t=this._workshopManager.getValueAvailable("culture");const a={},r=[];for(let u=0;u<s.length;u++){if(!s[u].embassyButton)continue;const c=s[u].race.name,h=this._host.game.diplomacy.get(c),d=Te(this.settings.buildEmbassies.races[c].max);!this.settings.buildEmbassies.races[c].enabled||d<=h.embassyLevel||!h.unlocked||(a[c]={val:0,max:d,basePrice:v((l=h.embassyPrices)==null?void 0:l[0]).val,currentEm:h.embassyLevel,priceSum:0,race:h},r.push(c))}if(r.length!==0){for(;r.length>0;)for(let u=0;u<r.length;u++){const c=r[u],h=v(a[c]);if(h.max<=h.currentEm+h.val){r.splice(u,1),--u;continue}const d=h.basePrice*1.15**(h.currentEm+h.val);d<=t?(t-=d,h.priceSum+=d,h.val+=1,i.requestGameUiRefresh=!0):(r.splice(u,1),--u)}for(const[,u]of D(a))u.val!==0&&(t=this._workshopManager.getValueAvailable("culture"),t<u.priceSum&&U("Something has gone horribly wrong.",u.priceSum,t),this._workshopManager.getResource("culture").value-=u.priceSum,u.race.embassyLevel+=u.val,this._host.engine.storeForSummary("embassy",u.val),u.val!==1?this._host.engine.iactivity("build.embassies",[u.val,u.race.title],"ks-build"):this._host.engine.iactivity("build.embassy",[u.val,u.race.title],"ks-build"))}}autoFeedElders(){const i=this._host.game.diplomacy.get("leviathans"),e=this._host.game.resPool.get("necrocorn");!i.unlocked||e.value===0||(1<=e.value?i.energy<this._host.game.diplomacy.getMarkerCap()&&(this._host.game.diplomacy.feedElders(),this._host.engine.iactivity("act.feed"),this._host.engine.storeForSummary("feed",1)):.25*(1+this._host.game.getEffect("corruptionBoostRatio"))<1&&(this._host.engine.storeForSummary("feed",e.value),this._host.game.diplomacy.feedElders(),this._host.engine.iactivity("dispose.necrocorn")))}autoUnlock(i){if(!this._host.game.tabs[4].visible)return;const e=this._host.game.diplomacy.get("leviathans").unlocked?8:7;if(this._host.game.diplomacyTab.racePanels.length<e){let t=this._workshopManager.getValueAvailable("manpower");if(!this._host.game.diplomacy.get("lizards").unlocked&&t>=1e3){this._host.game.resPool.get("manpower").value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}if(!this._host.game.diplomacy.get("sharks").unlocked&&t>=1e3){this._host.game.resPool.get("manpower").value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}if(!this._host.game.diplomacy.get("griffins").unlocked&&t>=1e3){this._host.game.resPool.get("manpower").value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}if(!this._host.game.diplomacy.get("nagas").unlocked&&this._host.game.resPool.get("culture").value>=1500&&t>=1e3){this._host.game.resPool.get("manpower").value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}if(!this._host.game.diplomacy.get("zebras").unlocked&&this._host.game.resPool.get("ship").value>=1&&t>=1e3){this._host.game.resPool.get("manpower").value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}if(!this._host.game.diplomacy.get("spiders").unlocked&&v(this._host.game.resPool.get("ship")).value>=100&&v(this._host.game.resPool.get("science")).maxValue>125e3&&t>=1e3){v(this._host.game.resPool.get("manpower")).value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}if(!this._host.game.diplomacy.get("dragons").unlocked&&this._host.game.science.get("nuclearFission").researched&&t>=1e3){v(this._host.game.resPool.get("manpower")).value-=1e3;const n=this._host.game.diplomacy.unlockRandomRace();this._host.engine.iactivity("upgrade.race",[n.title],"ks-upgrade"),t-=1e3,i.requestGameUiRefresh=!0}}}autoTradeBlackcoin(){const i=this._host.game.calendar.cryptoPrice,e=this._host.game.resPool.get("relic").value,t=this._host.game.resPool.get("blackcoin").value;let n=0,s=0;if(i<this.settings.tradeBlackcoin.buy&&this.settings.tradeBlackcoin.trigger<e){this._host.game.diplomacy.buyBcoin();const a=this._host.game.resPool.get("blackcoin").value;n=Math.round(a-t),this._host.engine.iactivity("act.blackcoin.buy",[this._host.renderAbsolute(n)])}else if(i>this.settings.tradeBlackcoin.sell&&0<this._host.game.resPool.get("blackcoin").value){this._host.game.diplomacy.sellBcoin();const a=v(this._host.game.resPool.get("relic")).value;s=Math.round(a-e),this._host.engine.iactivity("act.blackcoin.sell",[this._host.renderAbsolute(s)])}}trade(i,e){var s;const t=this.getRace(i),n=this.getTradeButton(t.name);(!((s=n==null?void 0:n.model)!=null&&s.enabled)||!this.settings.races[i].enabled)&&U("KS trade checks are not functioning properly, please create an issue on the github page."),this._host.game.diplomacy.tradeMultiple(t,e),this._host.engine.storeForSummary(t.title,e,"trade"),this._host.engine.iactivity("act.trade",[this._host.renderAbsolute(e),Y(t.title)],"ks-trade")}getProfitability(i){const e=this.getRace(i);let t=0;const n=this.getMaterials(i);for(const[r,l]of D(n)){const u=this._workshopManager.getTickVal(this._workshopManager.getResource(r));if(u!=="ignore"){if(u<=0)return!1;t+=l/u}}let s=0;const a=this.getAverageTrade(e);for(const[r,l]of D(a)){const u=this._workshopManager.getResource(r),c=this._workshopManager.getTickVal(u);if(c!=="ignore"){if(c<=0)return!0;s+=0<u.maxValue?Math.min(l,Math.max(u.maxValue-u.value,0))/c:l/c}}return t<=s}getAverageTrade(i){const e=this._host.game.getEffect("standingRatio")+this._host.game.diplomacy.calculateStandingFromPolicies(i.name,this._host.game),t=1+i.energy*.02,n=1+this._host.game.diplomacy.getTradeRatio()+this._host.game.diplomacy.calculateTradeBonusFromPolicies(i.name,this._host.game),s=i.standing<0?i.standing+e:0,a=0<s?1+s:1,r=0<i.standing?Math.min(i.standing+e/2,1):0,l={};for(const h of i.sells){if(!this._isValidTrade(h,i)){l[h.name]=0;continue}let d=0;const f=i.embassyPrices?h.chance*(1+this._host.game.getLimitedDR(.01*i.embassyLevel,.75)):h.chance;if(i.name==="zebras"&&h.name==="titanium"){const b=this._host.game.resPool.get("ship").value,p=Math.min(.15+b*.0035,1);d=1.5*(1+b/50)*(a*p)}else{const b=h.seasons?1+h.seasons[this._host.game.calendar.getCurSeason().name]:1,p=(a-r)*Math.min(f/100,1),y=r*Math.min(f/100,1);d=(p+1.25*y)*h.value*t*b*n}l[h.name]=d}const u=i.embassyPrices?.35*(1+.01*i.embassyLevel):.35,c=a*Math.min(u,1);return l.spice=25*c+50*c*n/2,l.blueprint=.1*a,l}_isValidTrade(i,e){return!(i.minLevel&&e.embassyLevel<i.minLevel)&&(this._host.game.resPool.get(i.name).unlocked||i.name==="titanium"||i.name==="uranium"||e.name==="leviathans")}getLowestTradeAmount(i,e,t){let n;const s=this.getMaterials(i);let a;for(const[c,h]of D(s)){if(c==="manpower"){let d=h;this._host.game.challenges.isActive("postApocalypse")&&(d=h*(1+this._host.game.bld.getPollutionLevel())),a=this._workshopManager.getValueAvailable(c)/d}else if(c==="gold"){let d=h;this._host.game.challenges.isActive("postApocalypse")&&(d=h*(1+this._host.game.bld.getPollutionLevel())),a=this._workshopManager.getValueAvailable(c)/d}else a=this._workshopManager.getValueAvailable(c)/h;n=n===void 0||a<n?a:n}if(n=Math.floor(n??0),n===0)return 0;if(i===null||i==="leviathans")return n;const r=this.getRace(i);let l=0;const u=this.getAverageTrade(r);for(const c of r.sells){const h=this._workshopManager.getResource(c.name);let d=0;if(!h.maxValue)continue;d=v(u[c.name]);const f=Math.max((h.maxValue-h.value)/d,0);l=f<l?l:f}return l=Math.ceil(l),l===0?0:(n=l<n?Math.max(l-1,1):n,Math.floor(n))}getMaterials(i=null){const e={manpower:50-this._host.game.getEffect("tradeCatpowerDiscount"),gold:15-this._host.game.getEffect("tradeGoldDiscount")};if(m(i))return e;const t=this.getRace(i).buys;for(const n of t)e[n.name]=n.val;return e}getRace(i){const e=this._host.game.diplomacy.get(i);if(m(e))throw new Error(`Unable to retrieve race '${i}'`);return e}getTradeButton(i){const e=this.manager.tab.racePanels.find(t=>t.race.name===i);return(e==null?void 0:e.tradeBtn)??null}singleTradePossible(i,e,t,n){const s=n?re.evaluateSubSectionTrigger(i,n.trigger):i;if(s<0&&n===void 0)return!0;if(s<0&&n!==void 0||e.value/e.maxValue<s||t.value/t.maxValue<s)return!1;const a=this.getMaterials(n==null?void 0:n.race);for(const[r,l]of D(a))if(this._workshopManager.getValueAvailable(r)<l)return!1;return!0}}class hs{constructor(i){g(this,"_host");g(this,"_cache",new Array);g(this,"_cacheSum",{});this._host=i}pushToCache(i){this._cache.push(i);for(const[e,t]of D(i.materials))this._cacheSum[e]||(this._cacheSum[e]=0),this._cacheSum[e]+=t;for(let e=0;e<this._cache.length;++e){const t=this._cache[e];if(this._cache.length>1e4){const n=t.materials;for(const[s,a]of D(n))this._cacheSum[s]||(this._cacheSum[s]=0),this._cacheSum[s]-=a;this._cache.shift(),e--}else return}}getResValue(i){if(this._cache.length===0||!this._cacheSum[i])return 0;const e=this._host.game.timer.ticksTotal,t=this._cache[0].timeStamp;return this._cacheSum[i]/(e-t)}}class ms extends k{constructor(e=!1,t=new Ft("any",Ei.map(s=>({label:"",value:s}))),n=new Ft("none",Rn.map(s=>({label:"",value:s})))){super(e);g(this,"job");g(this,"trait");this.job=t,this.trait=n}load(e){m(e)||(super.load(e),this.job.load(e.job),this.trait.load(e.trait))}}class Ni extends k{constructor(e=!1,t=new k,n=new X(!1,.98),s=new X(!1,1),a=new k,r=new ms){super(e);g(this,"jobs");g(this,"holdFestivals");g(this,"hunt");g(this,"promoteKittens");g(this,"promoteLeader");g(this,"electLeader");this.jobs=this.initJobs(),this.holdFestivals=t,this.hunt=n,this.promoteKittens=s,this.promoteLeader=a,this.electLeader=r}initJobs(){const e={};for(const t of Ei)e[t]=new Ri(!1,-1);return e}load(e){var t,n,s;m(e)||(super.load(e),N(this.jobs,e.jobs,(a,r)=>{a.enabled=(r==null?void 0:r.enabled)??a.enabled,a.max=(r==null?void 0:r.max)??a.max}),this.holdFestivals.enabled=((t=e.holdFestivals)==null?void 0:t.enabled)??this.holdFestivals.enabled,this.hunt.load(e.hunt),this.promoteKittens.enabled=((n=e.promoteKittens)==null?void 0:n.enabled)??this.promoteKittens.enabled,this.promoteLeader.enabled=((s=e.promoteLeader)==null?void 0:s.enabled)??this.promoteLeader.enabled,this.electLeader.load(e.electLeader))}}class fs{constructor(i,e,t=new Ni){g(this,"_host");g(this,"settings");g(this,"manager");g(this,"_cacheManager");g(this,"_workshopManager");this._host=i,this.settings=t,this.manager=new ue(this._host,"Village"),this._cacheManager=new hs(this._host),this._workshopManager=e}tick(i){this.settings.enabled&&(this.autoDistributeKittens(),this.settings.hunt.enabled&&this.autoHunt(this._cacheManager),this.settings.holdFestivals.enabled&&this.autoFestival(this._cacheManager),this.settings.electLeader.enabled&&this.autoElect(),this.settings.promoteLeader.enabled&&this.autoPromoteLeader(),this.settings.promoteKittens.enabled&&this.autoPromoteKittens())}autoDistributeKittens(){const i=this._host.game.village.getFreeKittens();if(i){for(let e=0;e<i;++e){const t=new Array;for(const a of this._host.game.village.jobs){const r=this.settings.jobs[a.name].enabled,l=a.unlocked;if(!r||!l)continue;const u=this._host.game.village.getJobLimit(a.name),c=Te(this.settings.jobs[a.name].max),h=a.value;h<u&&h<c&&t.push({job:a,count:h,toCap:u-h})}if(!t.length)return;const n=!m(t.find(a=>a.job.name==="farmer"&&a.count===0));t.sort((a,r)=>a.count-r.count);const s=n?"farmer":t[0].job.name;this._host.game.village.assignJob(this._host.game.village.getJob(s),1),this.manager.render(),this._host.engine.iactivity("act.distribute",[this._host.engine.i18n(`$village.job.${s}`)],"ks-distribute")}this._host.engine.storeForSummary("distribute",i)}}autoElect(){const i=this._host.game.village.sim.kittens,e=this._host.game.village.leader,t=this.settings.electLeader.job.selected,n=this.settings.electLeader.trait.selected,s=i.filter(r=>(r.job===t||t==="any")&&r.trait.name===n);if(s.length===0)return;s.sort((r,l)=>l.rank-r.rank);const a=s[0];!m(e)&&e.trait.name===n&&(e.job===t||t==="any")&&a.rank<=e.rank||(this._host.game.village.makeLeader(a),this._host.engine.iactivity("act.elect"))}autoPromoteKittens(){const i=this._workshopManager.getResource("gold");if(!(this.settings.promoteKittens.trigger<i.value/i.maxValue))for(let e=0;e<this._host.game.village.sim.kittens.length;e++){let t=-1;const n=this._host.game.village.sim.kittens[e].engineerSpeciality;if(!m(n)&&(t=v(this._host.game.workshop.getCraft(n)).tier,!(t<=this._host.game.village.sim.kittens[e].rank))){this._host.game.village.promoteKittens();return}}}autoPromoteLeader(){var i,e;if(this._host.game.science.get("civil").researched&&this._host.game.village.leader!==null){const t=this._host.game.village.leader,n=t.rank,s=this._workshopManager.getResource("gold"),a=this._workshopManager.getStock("gold");this._host.game.village.sim.goldToPromote(n,n+1,s.value-a)[0]&&this._host.game.village.sim.promote(t,n+1)===1&&(this._host.engine.iactivity("act.promote",[n+1],"ks-promote"),(i=this._host.game.villageTab.censusPanel)==null||i.census.renderGovernment(this._host.game.villageTab.censusPanel.census),(e=this._host.game.villageTab.censusPanel)==null||e.census.update(),this._host.engine.storeForSummary("promote",1))}}autoHunt(i){const e=this._workshopManager.getResource("manpower"),t=this.settings.hunt.trigger;if(!(e.value<100||this._host.game.challenges.isActive("pacifism"))&&t<=e.value/e.maxValue&&100<=e.value){const n=Math.floor(e.value/100);this._host.engine.storeForSummary("hunt",n),this._host.engine.iactivity("act.hunt",[this._host.renderAbsolute(n)],"ks-hunt");const s=this._workshopManager.getAverageHunt(),a={};for(const[r,l]of D(s)){const u=this._workshopManager.getResource(r);a[r]=0<u.maxValue?Math.min(l*n,Math.max(u.maxValue-u.value,0)):l*n}m(i)||i.pushToCache({materials:a,timeStamp:this._host.game.timer.ticksTotal}),this._host.game.village.huntAll()}}autoFestival(i){var a;if(!this._host.game.science.get("drama").researched||400<this._host.game.calendar.festivalDays||!this._host.game.prestige.getPerk("carnivals").researched&&0<this._host.game.calendar.festivalDays)return;const e=this._workshopManager;if(e.getValueAvailable("manpower")<1500||e.getValueAvailable("culture")<5e3||e.getValueAvailable("parchment")<2500)return;const t=4e3*e.getTickVal(e.getResource("manpower"),i,!0)>1500,n=4e3*e.getTickVal(e.getResource("culture"),i,!0)>5e3,s=4e3*e.getTickVal(e.getResource("parchment"),i,!0)>2500;if(!(!t&&!n&&!s)&&(this.manager.render(),(a=this._host.game.villageTab.festivalBtn.model)!=null&&a.enabled)){const r=this._host.game.calendar.festivalDays;this._host.game.villageTab.festivalBtn.onClick(),this._host.engine.storeForSummary("festival"),r>0?this._host.engine.iactivity("festival.extend",[],"ks-festival"):this._host.engine.iactivity("festival.hold",[],"ks-festival")}}}class ps extends X{constructor(e,t=!1){super(t,-1);B(this,lt);P(this,lt,e)}get upgrade(){return A(this,lt)}}lt=new WeakMap;class qi extends X{constructor(e=!1){super(e,0);g(this,"upgrades");this.upgrades=this.initUpgrades()}initUpgrades(){const e={};for(const t of xi)e[t]=new ps(t);return e}static validateGame(e,t){const n=Object.keys(t.upgrades),s=e.workshop.upgrades.map(l=>l.name),a=se(s,n),r=se(n,s);for(const l of a)U(`The workshop upgrade '${l}' is not tracked in Kitten Scientists!`);for(const l of r)U(`The workshop upgrade '${l}' is not an upgrade in Kittens Game!`)}load(e){m(e)||(super.load(e),N(this.upgrades,e.upgrades,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.trigger=(n==null?void 0:n.trigger)??t.trigger}))}}class bs extends Bn{constructor(e,t=!1,n=!0){super(t,n);B(this,ot);P(this,ot,e)}get resource(){return A(this,ot)}}ot=new WeakMap;class _t extends X{constructor(e=!1,t=.95,n=new qi,s=new k){super(e,t);g(this,"resources");g(this,"shipOverride");g(this,"unlockUpgrades");this.resources=this.initResources(),this.shipOverride=s,this.unlockUpgrades=n}initResources(){const e={};for(const t of Ci)e[t]=new bs(t);return e}static validateGame(e,t){const n=Object.keys(t.resources),s=e.workshop.crafts.map(l=>l.name),a=se(s,n),r=se(n,s);for(const l of a)U(`The workshop craft '${l}' is not tracked in Kitten Scientists!`);for(const l of r)U(`The workshop craft '${l}' is not an upgrade in Kittens Game!`);qi.validateGame(e,t.unlockUpgrades)}load(e){var t;m(e)||(super.load(e),N(this.resources,e.resources,(n,s)=>{n.enabled=(s==null?void 0:s.enabled)??n.enabled,n.limited=(s==null?void 0:s.limited)??n.limited,n.max=(s==null?void 0:s.max)??n.max,n.trigger=(s==null?void 0:s.trigger)??n.trigger}),this.unlockUpgrades.load(e.unlockUpgrades),this.shipOverride.enabled=((t=e.shipOverride)==null?void 0:t.enabled)??this.shipOverride.enabled)}}class jt extends yt{constructor(e,t=new _t){super(e);g(this,"settings");g(this,"manager");this.settings=t,this.manager=new ue(this._host,"Workshop")}tick(e){return this.settings.enabled?(this.autoCraft(),this.refreshStock(),this.settings.unlockUpgrades.enabled?(this.manager.render(),this.autoUnlock()):Promise.resolve()):Promise.resolve()}async autoUnlock(){if(!this._host.game.workshopTab.visible)return;const e=this._host.game.workshop.upgrades,t=new Array;e:for(const n of Object.values(this.settings.unlockUpgrades.upgrades)){if(!n.enabled)continue;const s=e.find(r=>r.name===n.upgrade);if(m(s)){ge(`Upgrade '${n.upgrade}' not found in game!`);continue}if(s.researched||!s.unlocked)continue;let a=O.window.dojo.clone(s.prices);a=this._host.game.village.getEffectLeader("scientist",a);for(const r of a){const l=this.getValueAvailable(r.name),u=this.getResource(r.name),c=re.evaluateSubSectionTrigger(this.settings.unlockUpgrades.trigger,n.trigger);if(c<0||l<u.maxValue*c||l<r.val)continue e}t.push(s)}for(const n of t)await this.upgrade(n,"workshop")}autoCraft(e=this.settings.resources){const t=new Map,n=this.settings.trigger;for(const a of Object.values(e)){const r=re.evaluateSubSectionTrigger(n,a.trigger);if(r<0||!a.enabled)continue;const l=a.max?this.getResource(a.resource):!1,u=Te(a.max);if(l&&u<l.value||!this.singleCraftPossible(a.resource))continue;const c=Object.keys(this.getMaterials(a.resource));c.map(f=>this.getResource(f)).filter(f=>0<f.maxValue).filter(f=>f.value/f.maxValue<r).length===0&&t.set(a,{countRequested:1,materials:c.map(f=>({resource:f,consume:0}))})}if(t.size<1)return;const s=new Map;for(const[a,r]of t)for(const l of r.materials)s.has(l.resource)||s.set(l.resource,new Array),v(s.get(l.resource)).push(a.resource);for(const[,a]of t)for(const r of a.materials){const l=this.getValueAvailable(r.resource);r.consume=l/v(s.get(r.resource)).length}for(const[a,r]of t){const l=this.getMaterials(a.resource);let u=Number.MAX_VALUE;for(const f of r.materials){const b=v(l[f.resource]),p=this.getResource(f.resource);if(!a.limited||a.resource==="ship"&&this.settings.shipOverride.enabled&&this.getResource("ship").value<243){u=Math.min(u,f.consume/b);continue}const y=this._host.game.getResCraftRatio(a.resource),w=this.getValueAvailable(f.resource)/v(s.get(f.resource)).length,G=this.getValueAvailable(a.resource),W=b,ee=1+y,fe=w/W,ce=G/ee,pe=Math.max(0,Math.floor(Math.log(ce)/Math.LN10+1e-9));u=Math.min(u,Math.min(fe-(0<p.maxValue&&p.maxValue<=p.value?0:ce),10**(pe+1)),f.consume/b)}const c=this.getValueAvailable(a.resource),h=1+this._host.game.getResCraftRatio(a.resource),d=Number.MAX_VALUE/h-c/h;u=Math.min(u,d),r.countRequested=Math.max(0,a.max===-1?u:Math.min(u,(a.max-c)/h))}for(const[a,r]of t)r.countRequested<1||this.craft(a.resource,r.countRequested)}craft(e,t){let n=Math.floor(t);if(n<1||!this._canCraft(e,n))return;const s=this.getCraft(e),a=this._host.game.getResCraftRatio(s.name);this._host.game.craft(s.name,n);const r=v(this._host.game.resPool.get(e)).title;n=Number.parseFloat((n*(1+a)).toFixed(2)),this._host.engine.storeForSummary(r,n,"craft"),this._host.engine.iactivity("act.craft",[this._host.game.getDisplayValueExt(n),r],"ks-craft")}_canCraft(e,t){if(!this._host.game.workshopTab.visible&&e!=="wood")return!1;const n=this.getCraft(e),s=v(this.settings.resources[e]).enabled;let a=!1;if(n.unlocked&&s){a=!0;const r=this._host.game.workshop.getCraftPrice(n);for(const l of r)this.getValueAvailable(l.name)<l.val*t&&(a=!1)}return a}getCraft(e){const t=this._host.game.workshop.getCraft(e);if(!t)throw new Error(`Unable to find craft '${e}'`);return t}singleCraftPossible(e){if(!this._host.game.workshopTab.visible&&e!=="wood")return!1;const t=this.getMaterials(e);for(const[n,s]of D(t))if(this.getValueAvailable(n)<s)return!1;return!0}getMaterials(e){const t={},n=this.getCraft(e),s=this._host.game.workshop.getCraftPrice(n);for(const a of s)t[a.name]=a.val;return t}getTickVal(e,t,n=void 0){let s=this._host.game.getResourcePerTick(e.name,!0);if(e.craftable){let a=Number.MAX_VALUE;const r=this.getMaterials(e.name);for(const[l,u]of D(r)){const c=(1+this._host.game.getResCraftRatio(e.name))/u,h=this.getTickVal(this.getResource(l));h!=="ignore"&&(a=Math.min(h*c,a))}s+=a!==Number.MAX_VALUE?a:0}return s<=0&&(e.name==="spice"||e.name==="blueprint")?"ignore":(!n&&!m(t)&&(s+=t.getResValue(e.name)),s)}getAverageHunt(){const e={},t=this._host.game.getEffect("hunterRatio")+this._host.game.village.getEffectLeader("manager",0);return e.furs=40+32.5*t,e.ivory=50*Math.min(.225+.01*t,.5)+40*t*Math.min(.225+.01*t,.5),e.unicorns=.05,this.getValue("zebras")>=10&&(e.bloodstone=this.getValue("bloodstone")===0?.05:5e-4),this._host.game.ironWill&&this._host.game.workshop.get("goldOre").researched&&(e.gold=.625+.625*t),e}getResource(e){const t=this._host.game.resPool.get(e);if(m(t))throw new Error(`Unable to find resource ${e}`);return t}getValue(e){return this.getResource(e).value}getStock(e){const t=this._host.engine.settings.resources.resources[e];return t.enabled?t.stock:0}getConsume(e){const t=this._host.engine.settings.resources.resources[e];return t.enabled?t.consume:1}getValueAvailable(e){let t=this.getStock(e);if(e==="catnip"){const a=this._host.game.bld.getBuildingExt("pasture").meta,r=this._host.game.bld.getBuildingExt("aqueduct").meta,l=a.stage===0?a.val:0,u=r.stage===0?r.val:0,c=this.getPotentialCatnip(!0,l,u);c<0&&(t-=c*202*5)}let n=this.getValue(e);n=Math.max(n-t,0);const s=this.getConsume(e);return n*s}getPotentialCatnip(e,t,n){let s=this._host.game.getEffect("catnipPerTickBase");e?(s*=.1,s*=1+this._host.game.getLimitedDR(this._host.game.getEffect("coldHarshness"),1)):s*=this._host.game.calendar.getWeatherMod({name:"catnip"})+this._host.game.calendar.getCurSeason().modifiers.catnip,this._host.game.science.getPolicy("communism").researched&&(s=0);const a=this._host.game.village.getResProduction(),r=a.catnip?a.catnip*(1+this._host.game.getEffect("catnipJobRatio")):0;let l=s+r,u=this._host.game.space.getBuilding("hydroponics").val;this._host.game.prestige.meta[0].meta[21].researched&&(this._host.game.calendar.cycle===2&&(u*=2),this._host.game.calendar.cycle===7&&(u*=.5)),l*=1+.03*n+.025*u;const h=this._host.game.challenges.currentChallenge==="winterIsComing"?0:this._host.game.prestige.getParagonProductionRatio();l*=1+h,l*=1+this._host.game.religion.getSolarRevolutionRatio(),this._host.game.opts.disableCMBR||(l*=1+this._host.game.getCMBRBonus()),l=v(this._host.game.calendar.cycleEffectsFestival({catnip:l}).catnip);let d=this._host.game.village.getResConsumption().catnip;const f=this._host.game.bld.getBuildingExt("unicornPasture").meta.val;if(d*=1+this._host.game.getLimitedDR(t*-.005+f*-.0015,1),this._host.game.village.sim.kittens.length>0&&this._host.game.village.happiness>1){const b=this._host.game.village.happiness-1,p=this._host.game.getEffect("catnipDemandWorkerRatioGlobal");this._host.game.challenges.currentChallenge==="anarchy"?d*=1+b*(1+p):d*=1+b*(1+p)*(1-this._host.game.village.getFreeKittens()/this._host.game.village.sim.kittens.length)}return l+=d,l+=this._host.game.getResourcePerTickConvertion("catnip"),l}refreshStock(){for(const[e,t]of D(this._host.engine.settings.resources.resources)){const n=[...$(`#game .res-row.resource_${e} .res-cell.resAmount`),...$(`#game .res-row.resource_${e} .res-cell.resource-value`)];if(!t.enabled||t.stock===0){for(const a of n)a.classList.remove("ks-stock-above","ks-stock-below");continue}const s=this._host.game.resPool.get(e).value<t.stock;for(const a of n)a.classList.add(s?"ks-stock-below":"ks-stock-above"),a.classList.remove(s?"ks-stock-above":"ks-stock-below")}}}g(jt,"DEFAULT_CONSUME_RATE",1);class vs{constructor(i){g(this,"_host");g(this,"_lastday");g(this,"_lastyear");g(this,"_sections",new Map);this._host=i,this.resetActivity()}resetActivity(){this._sections=new Map,this._lastday=this._host.game.calendar.day,this._lastyear=this._host.game.calendar.year}storeActivity(i,e=1,t="other"){this._sections.has(t)||this._sections.set(t,new Map);const n=v(this._sections.get(t));n.has(i)||n.set(i,0),n.set(i,v(n.get(i))+e)}renderSummary(){const i=new Array;if(this._sections.has("other")&&v(this._sections.get("other")).forEach((t,n)=>i.push(this._host.engine.i18n(`summary.${n}`,[this._host.game.getDisplayValueExt(t)]))),this._sections.has("research")&&v(this._sections.get("research")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.tech",[Y(n)]))}),this._sections.has("upgrade")&&v(this._sections.get("upgrade")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.upgrade",[Y(n)]))}),this._sections.has("build")&&v(this._sections.get("build")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.building",[this._host.game.getDisplayValueExt(t),Y(n)]))}),this._sections.has("refine")&&v(this._sections.get("refine")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.refine",[this._host.game.getDisplayValueExt(t),Y(n)]))}),this._sections.has("faith")&&v(this._sections.get("faith")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.sun",[this._host.game.getDisplayValueExt(t),Y(n)]))}),this._sections.has("craft")&&v(this._sections.get("craft")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.craft",[this._host.game.getDisplayValueExt(t),Y(n)]))}),this._sections.has("trade")&&v(this._sections.get("trade")).forEach((t,n)=>{i.push(this._host.engine.i18n("summary.trade",[this._host.game.getDisplayValueExt(t),Y(n)]))}),this._lastday&&this._lastyear){let e=this._host.game.calendar.year-this._lastyear,t=this._host.game.calendar.day-this._lastday;t<0&&(e-=1,t+=400);let n="";e>0&&(n+=`${e} `,n+=e===1?this._host.engine.i18n("summary.year"):this._host.engine.i18n("summary.years")),t>=0&&(e>0&&(n+=this._host.engine.i18n("summary.separator")),n+=`${xn(t)} `,n+=t===1?this._host.engine.i18n("summary.day"):this._host.engine.i18n("summary.days")),i.push(this._host.engine.i18n("summary.head",[n]))}return i}}const ys={"act.accelerate":"Accelerate time!","act.adore":"Adore the galaxy! Accumulated {0} worship to {1} epiphany","act.blackcoin.buy":"Kittens sold your Relics and bought {0} Blackcoins","act.blackcoin.sell":"Kittens sold your Blackcoins and bought {0} Relics","act.build":"Kittens have built a new {0}","act.builds":"Kittens have built a new {0} {1} times","act.craft":"Kittens have crafted {0} {1}","act.distribute":"Distributed a kitten to {0}","act.elect":"Kittens have elected a new leader.","act.feed":"Kittens fed the Elders. The elders are pleased","act.fix.cry":"Kittens fixed {0} Cryochambers","act.hunt":"Sent kittens on {0} hunts","act.observe":"Kitten Scientists have observed a star","act.praise":"Praised the sun! Accumulated {0} faith to {1} worship","act.promote":"Kittens' leader has been promoted to rank {0}","act.refineTCs":"Refined {0} time crystals","act.refineTears":"Refined {0} tears into BLS","act.sacrificeAlicorns":"Sacrificed {0} alicorns","act.sacrificeUnicorns":"Sacrificed {0} unicorns","act.sun.discover":"Kittens have discovered {0}","act.sun.discovers":"Kittens have discovered {0} {1} times","act.time.activeHeatTransferEnd":"End active Heat Transfer","act.time.activeHeatTransferStart":"Start active Heat Transfer","act.time.getTemporalFlux":"Burn crystals to obtain time flux to maintain time acceleration","act.time.skip":"Kittens combust a time crystal, {0} years skipped!","act.trade":"Kittens have traded {0} times with {1}","act.transcend":"Spent {0} epiphany, Transcended to T-level: {1}","blackcoin.buy.prompt":"Enter at which price you want to stop buying blackcoins.","blackcoin.buy.promptExplainer":"Blackcoin price always rises from 800 to 1100 (roughly), then it crashes. You usually want to buy until shortly before you sell.","blackcoin.buy.promptTitle":"Buy Limit for Blackcoins (Current: {0})","blackcoin.buy.title":"Buy Blackcoins until price reaches {0}","blackcoin.buy.trigger":"buying Blackcoins (in relics)","blackcoin.buy":"Buy Limit: {0}","blackcoin.sell.prompt":"Enter at which price you want to sell all your blackcoins.","blackcoin.sell.promptExplainer":"Blackcoin price always rises from 800 to 1100 (roughly), then it crashes. You usually want to sell close to the highest possible price.","blackcoin.sell.promptTitle":"Sell Order for Blackcoins (Current: {0})","blackcoin.sell.title":"Sell Blackcoins when price reaches {0}","blackcoin.sell":"Sell Order: {0}","build.embassies":"Built {0} embassies for {1}","build.embassy":"Built {0} embassy for {1}",copy:"Copy","craft.limited":"Crafting {0}: limited to be proportional to cost ratio","craft.unlimited":"Crafting {0}: unlimited",delete:"Delete","dispose.necrocorn":"Kittens disposed of inefficient necrocorns","festival.extend":"Kittens extend the festival","festival.hold":"Kittens begin holding a festival","filter.accelerate":"Tempus Fugit","filter.adore":"Adoring","filter.allKG":"All KG log entries.","filter.build":"Building","filter.craft":"Crafting","filter.disable":"Disabled {0} log messages","filter.distribute":"Distribute","filter.enable":"Enabled {0} log messages","filter.explainer":"Disabled items are hidden from the log.","filter.faith":"Order of the Sun","filter.festival":"Festivals","filter.hunt":"Hunting","filter.misc":"Miscellaneous","filter.praise":"Praising","filter.promote":"Promote leader","filter.research":"Researching","filter.star":"Astronomical Events","filter.timeSkip":"Time Skip","filter.trade":"Trading","filter.transcend":"Transcend","filter.upgrade":"Upgrading","option.accelerate":"Tempus Fugit","option.autofeed":"Feed Leviathans","option.catnip":"Gather Catnip","option.crypto":"Trade Blackcoin","option.elect.job.any":"Any","option.elect.job":"Job","option.elect.trait":"Trait","option.elect":"Elect leader","option.embassies":"Build Embassies","option.faith.adore":"Adore the Galaxy","option.faith.autoPraise":"Praise the Sun","option.faith.best.unicorn":"Automate Build Order","option.faith.refineTears":"Refine Tears","option.faith.refineTimeCrystals":"Refine TCs","option.faith.sacrificeAlicorns":"Sacrifice Alicorns","option.faith.sacrificeUnicorns":"Sacrifice Unicorns","option.faith.transcend":"Transcend","option.festival":"Hold festivals","option.fix.cry":"Fix Cryochamber","option.hunt":"Hunt","option.magnetos":"Turn on Magnetos","option.observe":"Observe Astro Events","option.praise":"Praise the Sun","option.promote":"Promote leader","option.promotekittens":"Promote kittens","option.reactors":"Turn on Reactors","option.shipOverride":"Force Ships to 243","option.steamworks":"Turn on Steamworks","option.time.activeHeatTransfer":"Active Heat Transfer","option.time.reset":"Reset Timeline (Danger!)","option.time.skip.ignoreOverheat":"Ignore overheat","option.time.skip":"Time Skip","reset.after":"Nice to meet you, the cute Kitten Scientists will serve you","reset.cancel.activity":"Meoston, We Have a Problem","reset.cancel.message":"Timeline Reset canceled","reset.check":"Trigger for {0}: {1}, you have {2}","reset.checked":"All conditions are met, the timeline will restart in the next few seconds!","reset.countdown.0":"0 - Temporal rifts opened!","reset.countdown.1":"1 - Time engine start","reset.countdown.10":"10 - Harvesting catnip","reset.countdown.2":"2 - Boosting the chronoforge","reset.countdown.3":"3 - Opening temporal rifts","reset.countdown.4":"4 - Turning off satellite","reset.countdown.5":"5 - Melting blackcoins","reset.countdown.6":"6 - Starting time engines","reset.countdown.7":"7 - Disassembling railguns","reset.countdown.8":"8 - Releasing lizards","reset.countdown.9":"9 - Sacrificing unicorns","reset.last.message":"See you next poincaré recurrence","reset.tip":'You can cancel this reset by disabling "Enable Kitten Scientists" at the top of the settings.',reset:"Reset","resources.consume.prompt":"Enter how much of the resource you want automations to consume as a percentage between 0.0 and 100.0.","resources.consume.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","resources.consume.promptTitle":"Consumption Share for {0} (Current: {1})","resources.consume.set":"Consume rate for {0}","resources.consume.title":"Consuming {0} of {1}","resources.consume.titleZero":"Not consuming {0}","resources.consume":"Consume: {0}","resources.stock.prompt":"Enter how much of the resource you always want to keep in stock.","resources.stock.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","resources.stock.promptTitle":"Stock value for {0} (Current: {1})","resources.stock.title":"Keeping {0} {1} in stock","resources.stock.titleInfinite":"Keeping all {0} in stock","resources.stock.titleZero":"Not keeping any {0} in stock","state.compress":"Compress copied Kittens Game saves","state.confirmDestruction":"Are you sure?","state.copied.game":"Save '{0}' copied to clipboard.","state.copied.gameCurrent":"Current save copied to clipboard.","state.copied.state":"State '{0}' copied to clipboard.","state.copied.stateCurrent":"Current state copied to clipboard.","state.copy.game":"Copy this save to the clipboard.","state.copy.gameCurrent":"Copy the entire Kittens Game save (includes KS settings) to the clipboard.","state.copy.state":"Copy these settings to the clipboard.","state.copy.stateCurrent":"Copy the current Kitten Scientists settings to the clipboard.","state.delete.game":"Delete this save.","state.delete.state":"Delete these settings.","state.deleted.game":"Save '{0}' deleted.","state.deleted.state":"State '{0}' deleted.","state.edit.game":"Change the name of this save.","state.edit.state":"Change the name of these settings.","state.exportAll":"Backup","state.exportAllTitle":"Stores all local states in a single file and downloads it.","state.import":"Import settings/saves","state.imported.game":"Save imported.","state.imported.state":"State imported.","state.importTitle":`Paste a save or settings from your clipboard.
Contents will be automatically detected and handled accordingly.`,"state.loaded.game":"Save '{0}' loaded.","state.loaded.state":"State '{0}' loaded.","state.loadPrompt":"Paste your (un/compressed) save or settings here:","state.local":"Local storage management","state.localGames":"Kittens Game Saves","state.localStates":"Kitten Scientists Settings","state.new":"New","state.noConfirm":"Don't ask for confirmation","state.store":"Store","state.stored.game":"Save stored.","state.stored.state":"State stored.","state.storeFactory":"Create a new state from factory defaults.","state.storeGame.prompt":"Provide a label for this save:","state.storeGame":"Create a new save from the current game.","state.storeState.prompt":"Provide a label for this state:","state.storeState":"Create a new state from current settings.","state.title":"State Management","state.unlabeledGame":"unlabeled save","state.unlabeledState":"unlabeled state","state.update.game":"Save the current game into this slot.","state.update.state":"Save the current settings into this slot.","state.updated.game":"Save '{0}' updated.","state.updated.state":"State '{0}' updated.","status.auto.disable":"Disabled Auto {0}","status.auto.enable":"Enabled Auto {0}","status.ks.disable":"Disabling the Kitten Scientists!","status.ks.enable":"Enabling the Kitten Scientists!","status.ks.init":"Kitten Scientists initialized.","status.ks.upgrade":"Kitten Scientists {0} (ours is {1}) is available at {2}.","status.reset.check.disable":"Disabled check {0} before Reset Timeline","status.reset.check.enable":"Enabled check {0} before Reset Timeline","status.resource.disable":"Disabled {0} resource management","status.resource.enable":"Enabled {0} resource management","status.sub.disable":"Disabled {0}","status.sub.enable":"Enabled {0}","summary.accelerate":"Accelerated time {0} times","summary.adore":"Accumulated {0} epiphany by adoring the galaxy","summary.building":"Built {0} {1}","summary.craft":"Crafted {0} {1}","summary.day":"day","summary.days":"days","summary.distribute":"Helped {0} kittens find a job","summary.embassy":"Built {0} embassies","summary.feed":"Fed the elders {0} necrocorns","summary.festival":"Held {0} festivals","summary.fix.cry":"Fixed {0} cryochambers","summary.head":"Summary of the last {0}","summary.hunt":"Sent adorable kitten hunters on {0} hunts","summary.praise":"Accumulated {0} worship by praising the sun","summary.promote":"Promoted our leader {0} times","summary.refine":"Refined {0} {1}","summary.separator":" and ","summary.show":"Show activity","summary.stars":"Observed {0} stars","summary.sun":"Discovered {0} {1}","summary.tech":"Researched {0}","summary.time.activeHeatTransferStart":"Active Heat Transfer {0} times","summary.time.getTemporalFlux":"Burn crystal to gain time flux {0} times","summary.time.reset.content":"Gained {0} Karma.<br>Gained {1} Paragon","summary.time.reset.title":"Summary of the last {0} timelines","summary.time.skip":"Skipped {0} years","summary.trade":"Traded {0} times with {1}","summary.transcend":"Transcended {0} times","summary.upgrade":"Upgraded {0}","summary.year":"year","summary.years":"years","time.heatTransfer.cycle.disable":"Disabled active heat transfer in cycle {0}","time.heatTransfer.cycle.enable":"Enabled active heat transfer in cycle {0}","time.skip.cycle.disable":"Disabled time skip in cycle {0} and disallow skip over this cycle","time.skip.cycle.enable":"Enabled time skip in cycle {0} and allow skip over this cycle","time.skip.season.disable":"Disabled time skip in the {0}","time.skip.season.enable":"Enabled time skip in the {0}","trade.limited":"Trading with {0}: limited to only occur when profitable based off relative production time","trade.season.disable":"Disabled trading with {0} in the {1}","trade.season.enable":"Enabled trading with {0} in the {1}","trade.seasons":"seasons","trade.unlimited":"Trading with {0}: unlimited","ui.additional":"Additional options","ui.build":"Bonfire","ui.close":"close","ui.craft.resources":"Resources","ui.craft":"Workshop","ui.cycles":"cycles","ui.disable.all":"Disable all options in this list.","ui.distribute":"Village","ui.enable.all":"Enable all options in this list.","ui.engine":"Enable Kitten Scientists","ui.faith":"Religion","ui.filter":"Log Filters","ui.infinity":"∞","ui.internals.interval.prompt":"Enter the new amount of milliseconds as an absolute value between 0 and Infinity.","ui.internals.interval.promptExplainer":"All notations that the game supports are accepted. If you set the limit to 0, Kitten Scientists will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.internals.interval.promptTitle":"Kitten Scientists Execution Interval (Current: {0})","ui.internals.interval":"Interval: {0}","ui.internals":"Internals","ui.itemsHide":"Collapse section","ui.itemsShow":"Expand section","ui.ksColumn":"Display KS in fourth column in UI","ui.language":"Language","ui.limit":"Limited","ui.limited.off":"Unlimited","ui.limited.on":"Eco Mode","ui.max.build.prompt":"Limit for {0} (Current: {1})","ui.max.build.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.build.title":"Build {0} {1}","ui.max.build.titleInfinite":"Never stop building {0}","ui.max.build.titleZero":"Don't build {0}","ui.max.craft.prompt":"Enter the new limit of how many {0} to craft as an absolute value between 0 and Infinity.","ui.max.craft.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.craft.promptTitle":"Limit for Crafting {0} (Current: {1})","ui.max.craft.title":"Craft {0} {1}","ui.max.craft.titleInfinite":"Never stop crafting {0}","ui.max.craft.titleZero":"Don't craft {0}","ui.max.distribute.prompt":"Enter the new amount of kittens to assign as {0} as an absolute value between 0 and Infinity.","ui.max.distribute.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.distribute.promptTitle":"Assign Max. Kittens as {0} (Current: {1})","ui.max.distribute.title":"Assign {0} kittens as {1}","ui.max.distribute.titleInfinite":"Assign as many kittens as possible as {0}","ui.max.distribute.titleZero":"Don't assign any kittens as {0}","ui.max.embassy.title":"Build {0} embassy for {1}","ui.max.embassy.titleInfinite":"Never stop building embassies for {0}","ui.max.embassy.titleZero":"Don't build embassies for {0}","ui.max.prompt.absolute":"Enter the new limit as an absolute value between 0 and Infinity.","ui.max.prompt.float":"Enter the new limit as an absolute value between 0.0 and Infinity.","ui.max.set":"Maximum for {0}","ui.max.timeSkip.prompt":"Enter the new amount of years as an absolute value between 0 and Infinity.","ui.max.timeSkip.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.timeSkip.promptTitle":"Max. Years to skip (Current: {0})","ui.max.timeSkip.title":"Skip {0} years at once","ui.max.timeSkip.titleInfinite":"Skip as many years as possible","ui.max.timeSkip.titleZero":"Don't skip time","ui.max":"Max: {0}","ui.maximum":"Maximum","ui.min":"Min: {0}","ui.options":"Options","ui.reset":"Reset list options to default configuration.","ui.resources":"Resource Control","ui.space":"Space","ui.time":"Time","ui.timeCtrl":"Time Control","ui.trade":"Trade","ui.trigger.accelerateTime.prompt":"Enter the new temporal flux storage level at which to enable Tempus Fugit as a percentage between 0.0 and 100.0.","ui.trigger.accelerateTime.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.accelerateTime.promptTitle":"Trigger to Accelerate Time (Current: {0})","ui.trigger.activeHeatTransfer.prompt":"Enter the new temporal heat storage level at which to enable heat transfer as a percentage between 0.0 and 100.0.","ui.trigger.activeHeatTransfer.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.activeHeatTransfer.promptTitle":"Trigger for Heat Transfer (Current: {0})","ui.trigger.build.blocked":`∞
🛈 The {0} section has no trigger set. This build will not be triggered!`,"ui.trigger.build.inherited":"inherited from section","ui.trigger.build.prompt":"Trigger for {0} (Current: {1})","ui.trigger.build.promptExplainer":"If you submit an empty value, or a negative value, the section trigger is used instead. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.trigger.crypto.prompt":"Enter the new relic storage level at which to trade blackcoin as an absolute value between 0.0 and Infinity.","ui.trigger.crypto.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.crypto.promptTitle":"Trigger to Trade Blackcoin (Current: {0})","ui.trigger.embassies.prompt":"Enter the new culture storage level at which to build embassies as a percentage between 0.0 and 100.0.","ui.trigger.embassies.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.embassies.promptTitle":"Trigger to Build Embassies (Current: {0})","ui.trigger.hunt.prompt":"Trigger for Hunting (Current: {0})","ui.trigger.hunt.promptExplainer":"If you submit a negative value, hunting will be disabled. If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.inactive":"inactive","ui.trigger.promoteKittens.prompt":"Enter the new gold storage level at which to promote kittens as a percentage between 0.0 and 100.0.","ui.trigger.promoteKittens.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.promoteKittens.promptTitle":"Trigger to Promote Kittens (Current: {0})","ui.trigger.prompt.absolute":"Enter the new trigger value as an absolute value between 0 and Infinity.","ui.trigger.prompt.float":"Enter the new trigger value as an absolute value between 0.0 and Infinity.","ui.trigger.prompt.percentage":"Enter the new trigger value as a percentage between 0.0 and 100.0.","ui.trigger.reset.promptExplainer":"If you submit a negative value, the item will be disabled. If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.section.blocked":`∞
🛈 The {0} section has no trigger set. This automation will not be triggered!`,"ui.trigger.section.inactive":"∞ (nothing is triggered automatically)","ui.trigger.section.inherited":"inherited from section","ui.trigger.section.prompt":"Trigger for section {0} (Current: {1})","ui.trigger.section.promptExplainer":`If you submit an empty value, or a negative value, the section trigger will be set to infinity (∞). Individual automations in this section need to have their own trigger set to be activated.
If you submit an invalid value, it will be treated as if you hit Cancel.`,"ui.trigger.section":"Section default trigger: {0}","ui.trigger.setinteger.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.setinteger":"Enter a new trigger value for {0}. Should be in the range from 0 up to any number. -1 means infinity.","ui.trigger.setpercentage.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.setpercentage":"Enter a new trigger value for {0}. Should be in the range from 0 to 100.","ui.trigger.timeSkip.prompt":"Enter the new amount of Time Crystals at which to skip time as an absolute value between 1 and Infinity.","ui.trigger.timeSkip.promptExplainer":"If you submit a negative value, time skipping will be disabled. If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.timeSkip.promptTitle":"Trigger for Time Skip (Current: {0})","ui.trigger":"Trigger: {0}","ui.upgrade.buildings":"Upgrade buildings","ui.upgrade.missions":"Start missions","ui.upgrade.policies":"Research policies","ui.upgrade.races":"Explore new races","ui.upgrade.techs":"Research technologies","ui.upgrade.upgrades":"Research upgrades","ui.upgrade":"Science","ui.upgrades":"Upgrades",update:"Update","upgrade.building.amphitheatre":"Upgraded amphitheatres to broadcast towers!","upgrade.building.aqueduct":"Upgraded aqueducts to hydro plants!","upgrade.building.library":"Upgraded libraries to data centers!","upgrade.building.pasture":"Upgraded pastures to solar farms!","upgrade.building.warehouse":"Upgraded warehouses to spaceports!","upgrade.policy":"Kittens have passed {0}","upgrade.race":"Kittens met the {0}","upgrade.space.mission":"Kittens conducted a mission to {0}","upgrade.space":"Kittens conducted a {0}","upgrade.tech":"Kittens have bought the tech {0}","upgrade.upgrade":"Kittens have bought the upgrade {0}"},ks={"act.accelerate":"Zeit beschleunigen!","act.adore":"Verehre die Galaxie! Kumulierte {0} Anbetung zu {1} Offenbarung","act.blackcoin.buy":"Kätzchen haben deine Relikte verkauft und {0} Blackcoins gekauft","act.blackcoin.sell":"Kätzchen haben deine Blackcoins verkauft und {0} Relikte gekauft","act.build":"Kätzchen haben ein neues {0} gebaut","act.builds":"Kätzchen haben ein neues {0} {1} Mal gebaut","act.craft":"Kätzchen haben {0} {1} hergestellt","act.distribute":"Ein Kätzchen an {0} verteilt","act.elect":"Kätzchen haben einen neuen Anführer gewählt.","act.feed":"Kätzchen haben die Ältesten gefüttert. Die Ältesten sind zufrieden","act.fix.cry":"Kätzchen haben {0} Kryokammern repariert","act.hunt":"Kätzchen auf {0} Jagden entsendet","act.observe":"Kitten Scientists haben einen Stern beobachtet","act.praise":"Die Sonne gelobt! {0} Glaube zu {1} Anbetung kumuliert","act.promote":"Der Anführer der Kätzchen wurde zum Rang {0} befördert","act.refineTCs":"{0} Zeit-Kristalle verfeinert","act.refineTears":"{0} Tränen zu STF verfeinert","act.sacrificeAlicorns":"{0} Alihörner geopfert","act.sacrificeUnicorns":"{0} Einhörner geopfert","act.sun.discover":"Kätzchen haben {0} entdeckt","act.sun.discovers":"Kätzchen haben {0} {1} mal entdeckt","act.time.activeHeatTransferEnd":"Aktiver Wärmetransfer beendet","act.time.activeHeatTransferStart":"Starte aktiven Wärmetransfer","act.time.getTemporalFlux":"Verbrennt Kristalle, um Flux zur Erhaltung der Zeitbeschleunigung zu bekommen","act.time.skip":"Kätzchen verbrennen einen Zeit-Kristall, {0} Jahre übersprungen!","act.trade":"Kätzchen haben {0} mal mit {1} gehandelt","act.transcend":"{0} Offenbarung ausgegeben, auf T-Level {1} aufgestiegen","blackcoin.buy.prompt":"Gib den Preis ein, ab welchem du keine Blackcoins mehr kaufen möchtest.","blackcoin.buy.promptExplainer":"Der Blackcoin-Preis steigt immer von 800 auf 1100 (ungefähr), dann stürzt er ab. Du möchtest normalerweise bis kurz vor dem Verkauf einkaufen.","blackcoin.buy.promptTitle":"Kauf-Limit für Blackcoins (Aktuell: {0})","blackcoin.buy.title":"Blackcoins kaufen bis der Preis {0} erreicht","blackcoin.buy.trigger":"kaufe Blackcoins (in Relikten)","blackcoin.buy":"Kauf-Limit: {0}","blackcoin.sell.prompt":"Gib den Preis ein, zu welchem du deine Blackcoins verkaufen möchtest.","blackcoin.sell.promptExplainer":"Der Blackcoin-Preis steigt immer von 800 auf 1100 (ungefähr), dann stürzt er ab. Du möchtest normalerweise nahe dem höchstmöglichen Preis verkaufen.","blackcoin.sell.promptTitle":"Verkauf-Order für Blackcoins (Aktuell: {0})","blackcoin.sell.title":"Blackcoins verkaufen, wenn der Preis {0} erreicht","blackcoin.sell":"Verkauf-Order: {0}","build.embassies":"{0} Botschaften für {1} gebaut","build.embassy":"{0} Botschaft für {1} gebaut",copy:"Kopieren","craft.limited":"Herstellen von {0}: im Verhältnis zum Kostenverhältnis begrenzt","craft.unlimited":"Herstellung von {0}: unbegrenzt",delete:"Löschen","dispose.necrocorn":"Kätzchen haben ineffiziente Necrocorns entsorgt","festival.extend":"Kätzchen haben das Festival verlängert","festival.hold":"Kätzchen fangen an, ein Festival abzuhalten","filter.accelerate":"Tempus Fugit","filter.adore":"Bewundern","filter.allKG":"Alle KG Protokollnachrichten.","filter.build":"Bauen","filter.craft":"Herstellen","filter.disable":"{0} Protokollnachrichten deaktiviert","filter.distribute":"Verteilen","filter.enable":"{0} Protokollnachrichten aktiviert","filter.explainer":"Deaktivierte Nachrichtentypen erscheinen nicht im Protokoll.","filter.faith":"Orden der Sonne","filter.festival":"Festivals","filter.hunt":"Jagen","filter.misc":"Diverses","filter.praise":"Bewundern","filter.promote":"Anführer befördern","filter.research":"Erforschen","filter.star":"Astronomische Ereignisse","filter.timeSkip":"Zeitsprung","filter.trade":"Handeln","filter.transcend":"Transzendenz","filter.upgrade":"Verbesserungen","option.accelerate":"Tempus Fugit","option.autofeed":"Leviathane füttern","option.catnip":"Katzenminze sammeln","option.crypto":"Blackcoin handeln","option.elect.job.any":"Beliebig","option.elect.job":"Beruf","option.elect.trait":"Eigenschaft","option.elect":"Anführer benennen","option.embassies":"Botschaften bauen","option.faith.adore":"Bewundere die Galaxie","option.faith.autoPraise":"Lobe die Sonne","option.faith.best.unicorn":"Reihenfolge automatisch optimieren","option.faith.refineTears":"Tränen verfeinern","option.faith.refineTimeCrystals":"ZKs verfeinern","option.faith.sacrificeAlicorns":"Alihörner opfern","option.faith.sacrificeUnicorns":"Einhörner opfern","option.faith.transcend":"Transzendenz","option.festival":"Festivals veranstalten","option.fix.cry":"Kryokammern reparieren","option.hunt":"Jagen","option.magnetos":"Magnetos einschalten","option.observe":"Astro-Ereignisse beobachten","option.praise":"Lobe die Sonne","option.promote":"Anführer befördern","option.promotekittens":"Kätzchen befördern","option.reactors":"Reaktoren einschalten","option.shipOverride":"Erzwinge 243 Schiffe","option.steamworks":"Dampfmaschinen einschalten","option.time.activeHeatTransfer":"Aktiver Wärmetransfer","option.time.reset":"Zeitleiste zurücksetzen (Gefahr!)","option.time.skip.ignoreOverheat":"Überhitzen ignorieren","option.time.skip":"Zeitsprung","reset.after":"Schön, dich kennenzulernen, die niedlichen Kitten Scientists werden dir dienen","reset.cancel.activity":"Miauston, wir haben ein Problem","reset.cancel.message":"Zeitleiste zurücksetzen abgebrochen","reset.check":"Auslöser für {0}: {1}, du hast {2}","reset.checked":"Alle Bedingungen sind erfüllt, die Zeitlinie wird in den nächsten Sekunden neu gestartet!","reset.countdown.0":"0 - Temporale Risse geöffnet!","reset.countdown.1":"1 - Start der Zeitmaschine","reset.countdown.10":"10 - Katzenminzeernte","reset.countdown.2":"2 - Chronoschmiede wird beschleunigt","reset.countdown.3":"3 - Zeit-Risse werden geöffnet","reset.countdown.4":"4 - Satellit wird ausgeschaltet","reset.countdown.5":"5 - Schmelze Blackcoins","reset.countdown.6":"6 - Zeit-Motoren werden gestartet","reset.countdown.7":"7 - Strahlenkanonen werden demontiert","reset.countdown.8":"8 - Freisetzung von Echsen","reset.countdown.9":"9 - Opfere Einhörner","reset.last.message":"Wir sehen uns bei der nächsten poincaréschen Wiederkehr","reset.tip":'Du kannst diesen Neustart abbrechen, indem du "Kitten Scientists aktivieren" oben in den Einstellungen deaktivierst.',reset:"Zurücksetzen","resources.consume.prompt":"Gib ein wie viel von der Ressource von Automatisierungen verbraucht werden darf. Der Wert sollte zwischen 0,0 und 100,0 liegen.","resources.consume.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","resources.consume.promptTitle":"Verbrauchsanteil für {0} (Aktuell: {1})","resources.consume.set":"Verbrauchs-Rate für {0}","resources.consume.title":"Verbraucht {0} von {1}","resources.consume.titleZero":"{0} werden nicht verbraucht","resources.consume":"Verbrauch: {0}","resources.stock.prompt":"Gib ein wie viel von der Ressource jederzeit im Lager bleiben soll.","resources.stock.promptExplainer":"Alle Notationen, die das Spiel unterstützt werden, akzeptiert. Wenn du gar nichts, oder einen negativen Wert eingibst, wird die Grenze auf unendlich gesetzt. Wenn du die Grenze auf 0 setzt, wird Zeit Überspringen deaktiviert. Wenn du einen ungültigen Wert eingibst, wird das genauso behandelt als ob du Abbrechen gedrückt hättest.","resources.stock.promptTitle":"Mindest-Lagerbestand von {0} (Aktuell: {1})","resources.stock.title":"{0} {1} werden auf Lager gehalten","resources.stock.titleInfinite":"Alle {0} werden auf Lager gehalten","resources.stock.titleZero":"{0} werden nicht auf Lager gehalten","state.compress":"Kopierte Kittens Game Spielstände komprimieren","state.confirmDestruction":"Bist du sicher?","state.copied.game":"Spielstand '{0}' in die Zwischenablage kopiert.","state.copied.gameCurrent":"Aktueller Spielstand in Zwischenablage kopiert.","state.copied.state":"Zustand '{0}' in Zwischenablage kopiert.","state.copied.stateCurrent":"Aktueller Zustand wurde in die Zwischenablage kopiert.","state.copy.game":"Diesen Spielstand in die Zwischenablage kopieren.","state.copy.gameCurrent":"Kopiere den gesamten Kittens Game Spielstand (inklusive KS-Einstellungen) in die Zwischenablage.","state.copy.state":"Diese Einstellungen in die Zwischenablage kopieren.","state.copy.stateCurrent":"Kopiere die aktuellen Kitten Scientists Einstellungen in die Zwischenablage.","state.delete.game":"Diesen Spielstand löschen.","state.delete.state":"Diese Einstellungen löschen.","state.deleted.game":"Spielstand '{0}' gelöscht.","state.deleted.state":"Zustand '{0}' gelöscht.","state.edit.game":"Ändere den Namen von diesem Spielstand.","state.edit.state":"Ändere den Namen von diesen Einstellungen.","state.exportAll":"Export","state.exportAllTitle":"Speichert alle lokalen Zustände in einer Datei und lädt sie herunter.","state.import":"Einstellungen/Spielstände importieren","state.imported.game":"Spielstand importiert.","state.imported.state":"Zustand importiert.","state.importTitle":`Füge ein Spielstand oder Einstellungen aus deiner Zwischenablage ein.
Inhalte werden automatisch erkannt und entsprechend behandelt.`,"state.loaded.game":"Spielstand '{0}' geladen.","state.loaded.state":"Zustand '{0}' geladen.","state.loadPrompt":"Füge deinen (un/komprimierten) Spielstand oder deine Einstellungen hier ein:","state.local":"Lokale Speicherverwaltung","state.localGames":"Kittens Game Spielstände","state.localStates":"Kitten Scientists Einstellungen","state.new":"Neu","state.noConfirm":"Nicht nach Bestätigung fragen","state.store":"Speichern","state.stored.game":"Spielstand gespeichert.","state.stored.state":"Zustand gespeichert.","state.storeFactory":"Neuen Zustand aus Werkseinstellungen erstellen.","state.storeGame.prompt":"Gib eine Beschreibung für diesen Spielstand ein:","state.storeGame":"Neuen Spielstand vom aktuellen Spiel erstellen.","state.storeState.prompt":"Gib eine Beschreibung für diesen Zustand ein:","state.storeState":"Erstelle einen neuen Zustand aus den aktuellen Einstellungen.","state.title":"Zustandsverwaltung","state.unlabeledGame":"unbeschriftetes Spiel","state.unlabeledState":"unbeschrifteter Zustand","state.update.game":"Speichere das aktuelle Spiel in diesem Slot.","state.update.state":"Speichere die aktuellen Einstellungen in diesem Slot.","state.updated.game":"Spielstand '{0}' aktualisiert.","state.updated.state":"Zustand '{0}' aktualisiert.","status.auto.disable":"Auto {0} deaktiviert","status.auto.enable":"Auto {0} aktiviert","status.ks.disable":"Deaktiviere die Kitten Scientists!","status.ks.enable":"Aktiviere die Kitten Scientists!","status.ks.init":"Kitten Scientists initialisiert.","status.ks.upgrade":"Kitten Scientists {0} (unsere ist {1}) ist unter {2} verfügbar.","status.reset.check.disable":"Überprüfung von {0} vor dem Zurücksetzen der Zeitlinie deaktiviert","status.reset.check.enable":"Überprüfung von {0} vor dem Zurücksetzen der Zeitlinie aktiviert","status.resource.disable":"{0} Ressourcenverwaltung deaktiviert","status.resource.enable":"{0} Ressourcenverwaltung aktiviert","status.sub.disable":"{0} deaktiviert","status.sub.enable":"{0} aktiviert","summary.accelerate":"Zeit {0} Mal beschleunigt","summary.adore":"{0} Offenbarung durch das Bewundern der Galaxie akkumuliert","summary.building":"{0} {1} gebaut","summary.craft":"{0} {1} hergestellt","summary.day":"Tag","summary.days":"Tage","summary.distribute":"{0} Kätzchen geholfen einen Beruf zu finden","summary.embassy":"{0} Botschaften gebaut","summary.feed":"{0} Necrocorns an die Ältesten verfüttert","summary.festival":"{0} Festivals veranstaltet","summary.fix.cry":"{0} Kryokammern repariert","summary.head":"Zusammenfassung der letzten {0}","summary.hunt":"Niedliche Jäger Kätzchen auf {0} Jagden versandt","summary.praise":"{0} Anbetung durch Loben der Sonne akkumuliert","summary.promote":"Unseren Anführer {0} mal befördert","summary.refine":"{0} {1} verfeinert","summary.separator":" und ","summary.show":"Aktivitäten anzeigen","summary.stars":"{0} Sterne beobachtet","summary.sun":"{0} {1} entdeckt","summary.tech":"{0} erforscht","summary.time.activeHeatTransferStart":"Aktive Wärmeübertragung {0} mal","summary.time.getTemporalFlux":"{0} Mal Kristalle verbrannt, um Zeit Flux zu generieren","summary.time.reset.content":"{0} Karma erhalten.<br>{1} Paragon erhalten","summary.time.reset.title":"Zusammenfassung der letzten {0} Zeitleisten","summary.time.skip":"{0} Jahre übersprungen","summary.trade":"{0} mal mit {1} gehandelt","summary.transcend":"{0} mal aufgestiegen","summary.upgrade":"{0} verbessert","summary.year":"Jahr","summary.years":"Jahre","time.heatTransfer.cycle.disable":"Aktiver Wärmetransfer im Zyklus {0} deaktiviert","time.heatTransfer.cycle.enable":"Aktiver Wärmetransfer im Zyklus {0} aktiviert","time.skip.cycle.disable":"Zeitsprung im Zyklus {0} und Überspringen über diesen Zyklus verboten","time.skip.cycle.enable":"Zeitsprung im Zyklus {0} und Überspringen über diesen Zyklus erlaubt","time.skip.season.disable":"Zeitsprung in {0} deaktiviert","time.skip.season.enable":"Zeitsprung in {0} aktiviert","trade.limited":"Handel mit {0}: limitiert auf nur, wenn profitabel auf Basis der relativen Produktionszeit","trade.season.disable":"Handel mit {0} in {1} deaktiviert","trade.season.enable":"Handel mit {0} in {1} aktiviert","trade.seasons":"Jahreszeiten","trade.unlimited":"Handel mit {0}: unbegrenzt","ui.additional":"Weitere Optionen","ui.build":"Lagerfeuer","ui.close":"schließen","ui.craft.resources":"Ressourcen","ui.craft":"Werkstatt","ui.cycles":"Zyklen","ui.disable.all":"Alle Optionen in dieser Liste deaktivieren.","ui.distribute":"Dorf","ui.enable.all":"Alle Optionen in dieser Liste aktivieren.","ui.engine":"Kitten Scientists aktivieren","ui.faith":"Religion","ui.filter":"Protokollfilter","ui.infinity":"∞","ui.internals.interval.prompt":"Gib die neue Anzahl an Millisekunden als absoluten Wert zwischen 0 und unendlich ein.","ui.internals.interval.promptExplainer":"Alle Notationen, die das Spiel unterstützt werden, akzeptiert. Wenn du die Grenze auf 0 setzt, werden die Kitten Scientists deaktiviert. Wenn du einen ungültigen Wert eingibst, wird das genauso behandelt als ob du Abbrechen gedrückt hättest.","ui.internals.interval.promptTitle":"Kitten Scientists Ausführungsintervall (Aktuell: {0})","ui.internals.interval":"Intervall: {0}","ui.internals":"Intern","ui.itemsHide":"Abschnitt einklappen","ui.itemsShow":"Abschnitt ausklappen","ui.ksColumn":"KS in vierter Spalte im UI anzeigen","ui.language":"Sprache","ui.limit":"Begrenzt","ui.limited.off":"Unbegrenzt","ui.limited.on":"Öko-Modus","ui.max.build.prompt":"Grenze für {0} (Aktuell: {1})","ui.max.build.promptExplainer":"Alle Notationen, die das Spiel unterstützt werden, akzeptiert. Wenn du gar nichts, oder einen negativen Wert eingibst, wird die Grenze auf unendlich gesetzt. Wenn du die Grenze auf 0 setzt, wird Zeit Überspringen deaktiviert. Wenn du einen ungültigen Wert eingibst, wird das genauso behandelt als ob du Abbrechen gedrückt hättest.","ui.max.build.title":"Baue {0} {1}","ui.max.build.titleInfinite":"Nie aufhören {0} zu bauen","ui.max.build.titleZero":"{0} nicht bauen","ui.max.craft.prompt":"Gib die neue Grenze zum Herstellen von {0} als absoluten Wert zwischen 0 und unendlich ein.","ui.max.craft.promptExplainer":"Alle Notationen, die das Spiel unterstützt werden, akzeptiert. Wenn du gar nichts, oder einen negativen Wert eingibst, wird die Grenze auf unendlich gesetzt. Wenn du die Grenze auf 0 setzt, wird Zeit Überspringen deaktiviert. Wenn du einen ungültigen Wert eingibst, wird das genauso behandelt als ob du Abbrechen gedrückt hättest.","ui.max.craft.promptTitle":"Grenze für Herstellen von {0} (Aktuell: {1})","ui.max.craft.title":"{0} {1} herstellen","ui.max.craft.titleInfinite":"Nie aufhören {0} herzustellen","ui.max.craft.titleZero":"{0} nicht herstellen","ui.max.distribute.prompt":"Gib die neue Anzahl an Kätzchen im {0} Beruf als absoluten Wert zwischen 0 und unendlich ein.","ui.max.distribute.promptExplainer":"Alle Notationen, die das Spiel unterstützt werden, akzeptiert. Wenn du gar nichts, oder einen negativen Wert eingibst, wird die Grenze auf unendlich gesetzt. Wenn du die Grenze auf 0 setzt, wird Zeit Überspringen deaktiviert. Wenn du einen ungültigen Wert eingibst, wird das genauso behandelt als ob du Abbrechen gedrückt hättest.","ui.max.distribute.promptTitle":"Max. Kätzchen als {0} zuweisen (Aktuell: {1})","ui.max.distribute.title":"{0} Kätzchen als {1} zuweisen","ui.max.distribute.titleInfinite":"So viele Kätzchen wie möglich als {0} zuweisen","ui.max.distribute.titleZero":"Keine Kätzchen als {0} zuweisen","ui.max.embassy.title":"Baue {0} Botschaften für {1}","ui.max.embassy.titleInfinite":"Nie aufhören Botschaften für {0} zu bauen","ui.max.embassy.titleZero":"Keine Botschaften für {0} bauen","ui.max.prompt.absolute":"Gib die neue Grenze als absoluten Wert zwischen 0 und unendlich ein.","ui.max.prompt.float":"Gib die neue Grenze als absoluten Wert zwischen 0,0 und unendlich ein.","ui.max.set":"Maximum für {0}","ui.max.timeSkip.prompt":"Gib die neue Anzahl an Jahren als absoluten Wert zwischen 0 und unendlich ein.","ui.max.timeSkip.promptExplainer":"Alle Notationen, die das Spiel unterstützt werden, akzeptiert. Wenn du gar nichts, oder einen negativen Wert eingibst, wird die Grenze auf unendlich gesetzt. Wenn du die Grenze auf 0 setzt, wird Zeit Überspringen deaktiviert. Wenn du einen ungültigen Wert eingibst, wird das genauso behandelt als ob du Abbrechen gedrückt hättest.","ui.max.timeSkip.promptTitle":"Max. Jahre zum Überspringen (Aktuell: {0})","ui.max.timeSkip.title":"{0} Jahre auf einmal überspringen","ui.max.timeSkip.titleInfinite":"So viele Jahre wie möglich überspringen","ui.max.timeSkip.titleZero":"Keine Zeit überspringen","ui.max":"Max: {0}","ui.maximum":"Maximum","ui.min":"Min. {0}","ui.options":"Optionen","ui.reset":"Optionen in der Liste auf Standardkonfiguration zurücksetzen.","ui.resources":"Ressourcensteuerung","ui.space":"Weltraum","ui.time":"Zeit","ui.timeCtrl":"Zeitsteuerung","ui.trade":"Handel","ui.trigger.accelerateTime.prompt":"Gib den neuen Lagerbestand von Temporalem Flux, bei welchem Tempus Fugit aktiviert werden soll, als Prozentzahl ein. Der Wert sollte zwischen 0,0 und 100,0 liegen.","ui.trigger.accelerateTime.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.accelerateTime.promptTitle":"Auslöser zur Zeit-Beschleunigung (Aktuell: {0})","ui.trigger.activeHeatTransfer.prompt":"Gib den neuen Stand von Chronohitze, bei welchem aktiver Wärmetransfer aktiviert werden sollen, als Prozentzahl ein. Der Wert sollte zwischen 0,0 und 100,0 liegen.","ui.trigger.activeHeatTransfer.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.activeHeatTransfer.promptTitle":"Auslöser für Wärmetransfer (Aktuell: {0})","ui.trigger.build.blocked":`∞
🛈 Der Abschnitt {0} hat keinen Auslöser gesetzt. Diese Option wird nie ausgelöst!`,"ui.trigger.build.inherited":"von Abschnitt übernommen","ui.trigger.build.prompt":"Auslöser für {0} (Aktuell: {1})","ui.trigger.build.promptExplainer":'Wenn du gar nichts, oder eine negative Zahl eingibst, wird der Auslöser des Abschnitts geerbt. Ungültige Eingaben werden so behandelt als ob du "Abbrechen" drückst.',"ui.trigger.crypto.prompt":"Gib den neuen Lagerbestand von Relikten, bei welchem Blackcoins gehandelt werden sollen, als absoluten Wert zwischen 0,0 und unendlich ein.","ui.trigger.crypto.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.crypto.promptTitle":"Auslöser um Blackcoin zu handeln (Aktuell: {0})","ui.trigger.embassies.prompt":"Gib den neuen Lagerbestand von Kultur, bei welchem Botschaften gebaut werden sollen, als Prozentzahl ein. Der Wert sollte zwischen 0,0 und 100,0 liegen.","ui.trigger.embassies.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.embassies.promptTitle":"Auslöser für den Bau von Botschaften (Aktuell: {0})","ui.trigger.hunt.prompt":"Auslöser für Jagd (Aktuell: {0})","ui.trigger.hunt.promptExplainer":"Wenn du einen negativen Wert eingibst, wird Jagen deaktiviert. Wenn du einen leeren Wert oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hast.","ui.trigger.inactive":"inaktiv","ui.trigger.promoteKittens.prompt":"Gib den neuen Lagerbestand von Gold, bei welchem Kätzchen befördert werden sollen, als Prozentzahl ein. Der Wert sollte zwischen 0,0 und 100,0 liegen.","ui.trigger.promoteKittens.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.promoteKittens.promptTitle":"Auslöser um Kätzchen zu befördern (Aktuell: {0})","ui.trigger.prompt.absolute":"Gib den neuen Auslöser als absoluten Wert zwischen 0 und unendlich ein.","ui.trigger.prompt.float":"Gib den neuen Auslöser als absoluten Wert zwischen 0,0 und unendlich ein.","ui.trigger.prompt.percentage":"Gib den neuen Auslöser als Prozentzahl zwischen 0,0 und 100,0 ein.","ui.trigger.reset.promptExplainer":"Wenn du einen negativen Wert eingibst, wird die Option deaktiviert. Wenn du einen leeren Wert oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hast.","ui.trigger.section.blocked":`∞
🛈 The {0} section has no trigger set. This automation will not be triggered!`,"ui.trigger.section.inactive":"∞ (nothing is triggered automatically)","ui.trigger.section.inherited":"von Abschnitt übernommen","ui.trigger.section.prompt":"Auslöser für Abschnitt {0} (Aktuell: {1})","ui.trigger.section.promptExplainer":`If you submit an empty value, or a negative value, the section trigger will be set to infinity (∞). Individual automations in this section need to have their own trigger set to be activated.
If you submit an invalid value, it will be treated as if you hit Cancel.`,"ui.trigger.section":"Abschnitt Standard-Auslöser: {0}","ui.trigger.setinteger.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.setinteger":"Gib einen neuen Auslöser für {0} ein. Sollte im Bereich von 0 bis zu einer beliebigen Zahl liegen. -1 bedeutet unendlich.","ui.trigger.setpercentage.promptExplainer":"Wenn du einen leeren oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hättest.","ui.trigger.setpercentage":"Geben Sie einen neuen Auslöser für {0} ein. Sollte im Bereich von 0 bis 100 liegen.","ui.trigger.timeSkip.prompt":"Gib die neue Menge an Zeitkristallen ein, bei welcher Zeit übersprungen werden soll. Der Wert sollte zwischen 1 und unendlich liegen.","ui.trigger.timeSkip.promptExplainer":"Wenn du einen negativen Wert eingibst, werden Zeit-Sprünge deaktiviert. Wenn du einen leeren Wert oder einen ungültigen Wert eingibst, wird das so behandelt, als ob du Abbrechen gedrückt hast.","ui.trigger.timeSkip.promptTitle":"Auslöser für Zeitsprung (Aktuell: {0})","ui.trigger":"Auslöser: {0}","ui.upgrade.buildings":"Gebäude verbessern","ui.upgrade.missions":"Missionen starten","ui.upgrade.policies":"Politik erforschen","ui.upgrade.races":"Neue Völker erforschen","ui.upgrade.techs":"Technologien erforschen","ui.upgrade.upgrades":"Verbesserungen erforschen","ui.upgrade":"Wissenschaft","ui.upgrades":"Verbesserungen",update:"Aktualisieren","upgrade.building.amphitheatre":"Amphitheater zu Sendetürmen verbessert!","upgrade.building.aqueduct":"Aquädukte zu Wasserwerken verbessert!","upgrade.building.library":"Bibliotheken zu Rechenzentren verbessert!","upgrade.building.pasture":"Weiden zu Solarfarmen verbessert!","upgrade.building.warehouse":"Lagerhäuser zu Raumhäfen verbessert!","upgrade.policy":"Kätzchen haben {0} veranlasst","upgrade.race":"Kätzchen haben die {0} getroffen","upgrade.space.mission":"Kätzchen haben eine Mission zu {0} durchgeführt","upgrade.space":"Kätzchen haben {0} durchgeführt","upgrade.tech":"Kätzchen haben die Technologie {0} gekauft","upgrade.upgrade":"Kätzchen haben die Verbesserung {0} gekauft"},ws={"act.accelerate":"האץ את הזמן!","act.adore":"העריץ את הגלקסיה! נאסף {0} פולחן ל-{1} תגלית","act.blackcoin.buy":"Kittens sold your Relics and bought {0} Blackcoins","act.blackcoin.sell":"Kittens sold your Blackcoins and bought {0} Relics","act.build":"חתלתולים בנו {0} חדש","act.builds":"חתלתולים בנו {0} חדש {1} פעמים","act.craft":"חתלתולים יצרו {0} {1}","act.distribute":"הופץ חתלתול ל-{0}","act.elect":"חתלתולים בחרו מנהיג חדש.","act.feed":"חתלתולים האכילו את העתיקים. העתיקים מרוצים","act.fix.cry":"חתלתולים תיקנו {0} תאי קריו","act.hunt":"נשלחו חתלתולים {0} פעמים לציד","act.observe":"מדעניתלתול צפו בכוכב","act.praise":"הריעו לשמש! נצבר {0} אמונה עבור {1} פולחן","act.promote":"מנהיג החתלתולים קודם לדרגה {0}","act.refineTCs":"זוקקו {0} בדולחי זמן","act.refineTears":"Refined {0} tears into BLS","act.sacrificeAlicorns":"הוקרבו {0} מכונפי קרן","act.sacrificeUnicorns":"Sacrificed {0} unicorns","act.sun.discover":"חתותולים גילו {0}","act.sun.discovers":"חתלתולים גילו {0} {1} פעמים","act.time.activeHeatTransferEnd":"End active Heat Transfer","act.time.activeHeatTransferStart":"Start active Heat Transfer","act.time.getTemporalFlux":"Burn crystals to obtain time flux to maintain time acceleration","act.time.skip":"חתלתולים שרפו בדולח זמן, ופסחו על {0} שנים!","act.trade":"חתלתולים סחרו {0} פעמים עם {1}","act.transcend":"נוצל {0} תגלית, התעלה לרמת התעלות: {1}","blackcoin.buy.prompt":"Enter at which price you want to stop buying blackcoins.","blackcoin.buy.promptExplainer":"Blackcoin price always rises from 800 to 1100 (roughly), then it crashes. You usually want to buy until shortly before you sell.","blackcoin.buy.promptTitle":"Buy Limit for Blackcoins (Current: {0})","blackcoin.buy.title":"Buy Blackcoins until price reaches {0}","blackcoin.buy.trigger":"קונה מטבעותשחור (בשרידים)","blackcoin.buy":"Buy Limit: {0}","blackcoin.sell.prompt":"Enter at which price you want to sell all your blackcoins.","blackcoin.sell.promptExplainer":"Blackcoin price always rises from 800 to 1100 (roughly), then it crashes. You usually want to sell close to the highest possible price.","blackcoin.sell.promptTitle":"Sell Order for Blackcoins (Current: {0})","blackcoin.sell.title":"Sell Blackcoins when price reaches {0}","blackcoin.sell":"Sell Order: {0}","build.embassies":"נבנו {0} שגרירויות של {1}","build.embassy":"נבנו {0} שגרירויות של {1}",copy:"Copy","craft.limited":"יוצר {0}: מוגבל לעלות היחסית","craft.unlimited":"יוצר {0}: ללא הגבלה",delete:"Delete","dispose.necrocorn":"חתלתולים נפטרו מאלמתי קרן לא יעילים","festival.extend":"חתלתולים האריכו את החגיגה","festival.hold":"חתלתולים החלו לערוך חגיגה","filter.accelerate":"הזמן עובר לו","filter.adore":"מעריץ","filter.allKG":"All KG log entries.","filter.build":"בנייה","filter.craft":"יצירה","filter.disable":"נכבו {0} רשומות","filter.distribute":"חלוקה","filter.enable":"Enabled {0} log messages","filter.explainer":"Disabled items are hidden from the log.","filter.faith":"מסדר השמש","filter.festival":"חגיגות","filter.hunt":"ציד","filter.misc":"שונות","filter.praise":"הילול","filter.promote":"העלאות דרגה","filter.research":"חקר","filter.star":"אירועים אסטרונומיים","filter.timeSkip":"קפיצת זמן","filter.trade":"סחר","filter.transcend":"עילוי","filter.upgrade":"שדרוג","option.accelerate":"הזמן עובר לו","option.autofeed":"האכל לוויתנים","option.catnip":"Gather Catnip","option.crypto":"סחור במטבעשחור","option.elect.job.any":"Any","option.elect.job":"Job","option.elect.trait":"Trait","option.elect":"בחר מנהיג","option.embassies":"בנה שגרירויות","option.faith.adore":"הערץ את הגלקסיה","option.faith.autoPraise":"הלל את השמש","option.faith.best.unicorn":"Automate Build Order","option.faith.refineTears":"זקק דמעות","option.faith.refineTimeCrystals":"זקק TCים","option.faith.sacrificeAlicorns":"הקרב מכונפי קרן","option.faith.sacrificeUnicorns":"Sacrifice Unicorns","option.faith.transcend":"עילוי","option.festival":"ארגן חגיגות","option.fix.cry":"תקן תאי קריו","option.hunt":"צוד","option.magnetos":"הפעל מגנטוים","option.observe":"צפה באירועים אסטרונומיים","option.praise":"הלל את השמש","option.promote":"העלאות דרגה","option.promotekittens":"העלה את דרגת החתלתולים","option.reactors":"Turn on Reactors","option.shipOverride":"הכרח ספינות ל-243","option.steamworks":"הפעל את מנוע הקיטור","option.time.activeHeatTransfer":"Active Heat Transfer","option.time.reset":"אתחל מחדש את ציר הזמן (סכנה!)","option.time.skip.ignoreOverheat":"Ignore overheat","option.time.skip":"קפיצת זמן","reset.after":"Nice to meet you, the cute Kitten Scientists will serve you","reset.cancel.activity":"מאוסטון, יש לנו בעיה","reset.cancel.message":"אתחול ציר הזמן בוטל","reset.check":"Trigger for {0}: {1}, you have {2}","reset.checked":"All conditions are met, the timeline will restart in the next few seconds!","reset.countdown.0":"0 - Temporal rifts opened!","reset.countdown.1":"1 - Time engine start","reset.countdown.10":"10 - קוצר נפית חתולים","reset.countdown.2":"2 - Boosting the chronoforge","reset.countdown.3":"3 - Opening temporal rifts","reset.countdown.4":"4 - Turning off satellite","reset.countdown.5":"5 - Melting blackcoins","reset.countdown.6":"6 - Starting time engines","reset.countdown.7":"7 - Disassembling railguns","reset.countdown.8":"8 - Releasing lizards","reset.countdown.9":"9 - Sacrificing unicorns","reset.last.message":"נתראה בהישנות פואנקרה הבאה","reset.tip":'You can cancel this reset by disabling "Enable Kitten Scientists" at the top of the settings.',reset:"Reset","resources.consume.prompt":"Enter how much of the resource you want automations to consume as a percentage between 0.0 and 100.0.","resources.consume.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","resources.consume.promptTitle":"Consumption Share for {0} (Current: {1})","resources.consume.set":"קצב צריכה עבור {0}","resources.consume.title":"Consuming {0} of {1}","resources.consume.titleZero":"Not consuming {0}","resources.consume":"צרוך: {0}","resources.stock.prompt":"Enter how much of the resource you always want to keep in stock.","resources.stock.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","resources.stock.promptTitle":"Stock value for {0} (Current: {1})","resources.stock.title":"Keeping {0} {1} in stock","resources.stock.titleInfinite":"Keeping all {0} in stock","resources.stock.titleZero":"Not keeping any {0} in stock","state.compress":"Compress data","state.confirmDestruction":"האם אתה בטוח?","state.copied.game":"Save '{0}' copied to clipboard.","state.copied.gameCurrent":"Current save copied to clipboard.","state.copied.state":"State '{0}' copied to clipboard.","state.copied.stateCurrent":"Current state copied to clipboard.","state.copy.game":"Copy this save to the clipboard.","state.copy.gameCurrent":"Copy the entire Kittens Game save (includes KS settings) to the clipboard.","state.copy.state":"Copy these settings to the clipboard.","state.copy.stateCurrent":"Copy the current Kitten Scientists settings to the clipboard.","state.delete.game":"Delete this save.","state.delete.state":"Delete these settings.","state.deleted.game":"Save '{0}' deleted.","state.deleted.state":"State '{0}' deleted.","state.edit.game":"Change the name of this save.","state.edit.state":"Change the name of these settings.","state.exportAll":"Backup","state.exportAllTitle":"Stores all local states in a single file and downloads it.","state.import":"Import from clipboard","state.imported.game":"Save imported.","state.imported.state":"State imported.","state.importTitle":`Paste a save or settings from your clipboard.
Contents will be automatically detected and handled accordingly.`,"state.loaded.game":"Save '{0}' loaded.","state.loaded.state":"State '{0}' loaded.","state.loadPrompt":"Paste your (un/compressed) save or settings here:","state.local":"Local states","state.localGames":"Kittens Game Saves","state.localStates":"Kitten Scientists Settings","state.new":"New","state.noConfirm":"Do NOT confirm destructive actions. (Danger!)","state.store":"Store","state.stored.game":"Save stored.","state.stored.state":"State stored.","state.storeFactory":"Create a new state from factory defaults.","state.storeGame.prompt":"Provide a label for this save:","state.storeGame":"Create a new save from the current game.","state.storeState.prompt":"Provide a label for this state:","state.storeState":"Create a new state from current settings.","state.title":"State Management","state.unlabeledGame":"unlabeled save","state.unlabeledState":"unlabeled state","state.update.game":"Save the current game into this slot.","state.update.state":"Save the current settings into this slot.","state.updated.game":"Save '{0}' updated.","state.updated.state":"State '{0}' updated.","status.auto.disable":"Disabled Auto {0}","status.auto.enable":"Enabled Auto {0}","status.ks.disable":"מבטל את המדעניתלתול!","status.ks.enable":"מאפשר את המדעניתלתול!","status.ks.init":"Kitten Scientists initialized.","status.ks.upgrade":"Kitten Scientists {0} (ours is {1}) is available at {2}.","status.reset.check.disable":"Disabled check {0} before Reset Timeline","status.reset.check.enable":"Enabled check {0} before Reset Timeline","status.resource.disable":"כבה ניהול משאבי {0}","status.resource.enable":"הפעל ניהול משאבי {0}","status.sub.disable":"{0} הושבת","status.sub.enable":"{0} אופשר","summary.accelerate":"הזמן הועץ {0} פעמים","summary.adore":"נצבר {0} תגלית על ידי הערצת הגלקסיה","summary.building":"נבנה {0} {1}","summary.craft":"נוצר {0} {1}","summary.day":"יום","summary.days":"ימים","summary.distribute":"עזרת ל-{0} חתלתולים למצוא עבודה","summary.embassy":"נבנו {0} שגרירויות","summary.feed":"האכלת את הוותיקים {0} אלמתי קרן","summary.festival":"אורגנו {0} חגיגות","summary.fix.cry":"תוקנו {0} תאי קריו","summary.head":"תקציר {0} האחרונים","summary.hunt":"צידיתלתול יצאו לצוד {0} פעמים","summary.praise":"נצבר {0} פולחן על ידי הילול השמש","summary.promote":"המנהיג קודם {0} פעמים","summary.refine":"זוקק {0} {1}","summary.separator":" ועוד ","summary.show":"הצג פעילות","summary.stars":"נצפו {0} כוכבים","summary.sun":"התגלו {0} {1}","summary.tech":"נחקרו {0}","summary.time.activeHeatTransferStart":"Active Heat Transfer {0} times","summary.time.getTemporalFlux":"Burn crystal to gain time flux {0} times","summary.time.reset.content":"נאסף {0} קרמה.<br>נאסף {1} מופת","summary.time.reset.title":"סיכום {0} צירי הזמן האחרונים","summary.time.skip":"{0} שנים נפסחו","summary.trade":"סחרת {0} פעמים עם {1}","summary.transcend":"התעלית {0} פעמים","summary.upgrade":"שודרג {0}","summary.year":"שנה","summary.years":"שנים","time.heatTransfer.cycle.disable":"Disabled active heat transfer in cycle {0}","time.heatTransfer.cycle.enable":"Enabled active heat transfer in cycle {0}","time.skip.cycle.disable":"Disabled time skip in cycle {0} and disallow skip over this cycle","time.skip.cycle.enable":"Enabled time skip in cycle {0} and allow skip over this cycle","time.skip.season.disable":"Disabled time skip in the {0}","time.skip.season.enable":"Enabled time skip in the {0}","trade.limited":"סחר עם {0}: מוגבל רק כאשר זה רווחי ביחס לזמן ייצור","trade.season.disable":"בוטל הסחר עם {0} עבור {1}","trade.season.enable":"אופשר הסחר עם {0} עבור {1}","trade.seasons":"עונות","trade.unlimited":"סחר עם {0}: ללא הגבלה","ui.additional":"Additional options","ui.build":"מדורה","ui.close":"סגור","ui.craft.resources":"משאבים","ui.craft":"סדנא","ui.cycles":"מחזורים","ui.disable.all":"Disable all options in this list.","ui.distribute":"כפר","ui.enable.all":"Enable all options in this list.","ui.engine":"Enable Kitten Scientists","ui.faith":"דת","ui.filter":"סנני רשומות","ui.infinity":"∞","ui.internals.interval.prompt":"Enter the new amount of milliseconds as an absolute value between 0 and Infinity.","ui.internals.interval.promptExplainer":"All notations that the game supports are accepted. If you set the limit to 0, Kitten Scientists will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.internals.interval.promptTitle":"Kitten Scientists Execution Interval (Current: {0})","ui.internals.interval":"Interval: {0}","ui.internals":"Internals","ui.itemsHide":"Collapse section","ui.itemsShow":"Expand section","ui.ksColumn":"Display in fourth column","ui.language":"Language","ui.limit":"מוגבל","ui.limited.off":"Unlimited","ui.limited.on":"Eco Mode","ui.max.build.prompt":"Limit for {0} (Current: {1})","ui.max.build.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.build.title":"Build {0} {1}","ui.max.build.titleInfinite":"Never stop building {0}","ui.max.build.titleZero":"Don't build {0}","ui.max.craft.prompt":"Enter the new limit of how many {0} to craft as an absolute value between 0 and Infinity.","ui.max.craft.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.craft.promptTitle":"Limit for Crafting {0} (Current: {1})","ui.max.craft.title":"Craft {0} {1}","ui.max.craft.titleInfinite":"Never stop crafting {0}","ui.max.craft.titleZero":"Don't craft {0}","ui.max.distribute.prompt":"Enter the new amount of kittens to assign as {0} as an absolute value between 0 and Infinity.","ui.max.distribute.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.distribute.promptTitle":"Assign Max. Kittens as {0} (Current: {1})","ui.max.distribute.title":"Assign {0} kittens as {1}","ui.max.distribute.titleInfinite":"Assign as many kittens as possible as {0}","ui.max.distribute.titleZero":"Don't assign any kittens as {0}","ui.max.embassy.title":"Build {0} embassy for {1}","ui.max.embassy.titleInfinite":"Never stop building embassies for {0}","ui.max.embassy.titleZero":"Don't build embassies for {0}","ui.max.prompt.absolute":"Enter the new limit as an absolute value between 0 and Infinity.","ui.max.prompt.float":"Enter the new limit as an absolute value between 0.0 and Infinity.","ui.max.set":"מירבי עבור {0}","ui.max.timeSkip.prompt":"Enter the new amount of years as an absolute value between 0 and Infinity.","ui.max.timeSkip.promptExplainer":"All notations that the game supports are accepted. If you submit an empty value, or a negative value, the limit will be set to infinity. If you set the limit to 0, this option will be automatically disabled. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.max.timeSkip.promptTitle":"Max. Years to skip (Current: {0})","ui.max.timeSkip.title":"Skip {0} years at once","ui.max.timeSkip.titleInfinite":"Skip as many years as possible","ui.max.timeSkip.titleZero":"Don't skip time","ui.max":"מירבי: {0}","ui.maximum":"מירבי","ui.min":"מינימלי: {0}","ui.options":"אפשרויות","ui.reset":"Reset list options to default configuration.","ui.resources":"בקרת משאבים","ui.space":"חלל","ui.time":"זמן","ui.timeCtrl":"שליטה בזמן","ui.trade":"סחר","ui.trigger.accelerateTime.prompt":"Enter the new temporal flux storage level at which to enable Tempus Fugit as a percentage between 0.0 and 100.0.","ui.trigger.accelerateTime.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.accelerateTime.promptTitle":"Trigger to Accelerate Time (Current: {0})","ui.trigger.activeHeatTransfer.prompt":"Enter the new temporal heat storage level at which to enable heat transfer as a percentage between 0.0 and 100.0.","ui.trigger.activeHeatTransfer.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.activeHeatTransfer.promptTitle":"Trigger for Heat Transfer (Current: {0})","ui.trigger.build.blocked":`∞
🛈 The {0} section has no trigger set. This build will not be triggered!`,"ui.trigger.build.inherited":"inherited from section","ui.trigger.build.prompt":"Trigger for {0} (Current: {1})","ui.trigger.build.promptExplainer":"If you submit an empty value, or a negative value, the section trigger is used instead. If you submit an invalid value, it will be treated as if you hit Cancel.","ui.trigger.crypto.prompt":"Enter the new relic storage level at which to trade blackcoin as an absolute value between 0.0 and Infinity.","ui.trigger.crypto.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.crypto.promptTitle":"Trigger to Trade Blackcoin (Current: {0})","ui.trigger.embassies.prompt":"Enter the new culture storage level at which to build embassies as a percentage between 0.0 and 100.0.","ui.trigger.embassies.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.embassies.promptTitle":"Trigger to Build Embassies (Current: {0})","ui.trigger.hunt.prompt":"Trigger for Hunting (Current: {0})","ui.trigger.hunt.promptExplainer":"If you submit a negative value, hunting will be disabled. If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.inactive":"inactive","ui.trigger.promoteKittens.prompt":"Enter the new gold storage level at which to promote kittens as a percentage between 0.0 and 100.0.","ui.trigger.promoteKittens.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.promoteKittens.promptTitle":"Trigger to Promote Kittens (Current: {0})","ui.trigger.prompt.absolute":"Enter the new trigger value as an absolute value between 0 and Infinity.","ui.trigger.prompt.float":"Enter the new trigger value as an absolute value between 0.0 and Infinity.","ui.trigger.prompt.percentage":"Enter the new trigger value as a percentage between 0.0 and 100.0.","ui.trigger.reset.promptExplainer":"If you submit a negative value, the item will be disabled. If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.section.blocked":`∞
🛈 The {0} section has no trigger set. This automation will not be triggered!`,"ui.trigger.section.inactive":"∞ (nothing is triggered automatically)","ui.trigger.section.inherited":"inherited from section","ui.trigger.section.prompt":"Trigger for section {0} (Current: {1})","ui.trigger.section.promptExplainer":`If you submit an empty value, or a negative value, the section trigger will be set to infinity (∞). Individual automations in this section need to have their own trigger set to be activated.
If you submit an invalid value, it will be treated as if you hit Cancel.`,"ui.trigger.section":"Section default trigger: {0}","ui.trigger.setinteger.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.setinteger":"Enter a new trigger value for {0}. Should be in the range from 0 up to any number. -1 means infinity.","ui.trigger.setpercentage.promptExplainer":"If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.setpercentage":"Enter a new trigger value for {0}. Should be in the range from 0 to 100.","ui.trigger.timeSkip.prompt":"Enter the new amount of Time Crystals at which to skip time as an absolute value between 1 and Infinity.","ui.trigger.timeSkip.promptExplainer":"If you submit a negative value, time skipping will be disabled. If you submit an empty value, or an invalid value, it will be treated as if you hit Cancel.","ui.trigger.timeSkip.promptTitle":"Trigger for Time Skip (Current: {0})","ui.trigger":"מפעיל: {0}","ui.upgrade.buildings":"שדרג בניינים","ui.upgrade.missions":"התחל משימות","ui.upgrade.policies":"פוליסת מחקר","ui.upgrade.races":"גלה גזעים חדשים","ui.upgrade.techs":"חקור טכנולוגיות","ui.upgrade.upgrades":"חקור שדרוגים","ui.upgrade":"מדע","ui.upgrades":"Upgrades",update:"Update","upgrade.building.amphitheatre":"אמפיטאטראות שודרגו למגדלי שידור!","upgrade.building.aqueduct":"אקוודוקטים שודרגו למפעלי מים!","upgrade.building.library":"ספריות שודרגו למרכזיות מידע!","upgrade.building.pasture":"אדמות חקלאיות שודרגו לשדות קולטני שמש!","upgrade.building.warehouse":"Upgraded warehouses to spaceports!","upgrade.policy":"חתלתולים העבירו {0}","upgrade.race":"חתלתולים פגשו את {0}","upgrade.space.mission":"חתלתולים ביצעו משימה אל {0}","upgrade.space":"חתלתולים ביצעו {0}","upgrade.tech":"חתלתולים קנו את הטכנולוגיה {0}","upgrade.upgrade":"חתלתולים קנו את השדרוג {0}"},_s={"act.accelerate":"固有时制御，二倍速!","act.adore":"赞美群星! 转化 {0} 虔诚为 {1} 顿悟","act.blackcoin.buy":"小猫出售遗物并买入 {0} 黑币","act.blackcoin.sell":"小猫出售黑币并买入了 {0} 遗物","act.build":"小猫建造了一个 {0}","act.builds":"小猫建造了 {1} 个新的 {0}","act.craft":"小猫制作了 {0} {1}","act.distribute":"分配一只猫猫成为 {0}","act.elect":"小猫选出了一位新领导人","act.feed":"小猫向上古神献上祭品。上古神很高兴","act.fix.cry":"小猫修复了 {0} 个冷冻仓","act.hunt":"派出 {0} 波小猫去打猎","act.observe":"小猫珂学家观测到一颗流星","act.praise":"赞美太阳! 转化 {0} 信仰为 {1} 虔诚","act.promote":"领袖被提拔到 {0} 级","act.refineTCs":"精炼 {0} 时间水晶","act.refineTears":"将 {0} 泪水提炼成黑色眼泪","act.sacrificeAlicorns":"献祭了 {0} 只天角兽","act.sacrificeUnicorns":"已献祭的独角兽数：{0}","act.sun.discover":"小猫在 {0} 方面获得顿悟","act.sun.discovers":"小猫在 {0} 方面获得 {1} 次顿悟","act.time.activeHeatTransferEnd":"主动散热完成","act.time.activeHeatTransferStart":"开始主动散热","act.time.getTemporalFlux":"烧水晶获取时间通量以维持时间加速","act.time.skip":"燃烧时间水晶, 跳过接下来的 {0} 年!","act.trade":"小猫与 {1} 交易 {0} 次","act.transcend":"消耗 {0} 顿悟，达到超越 {1}","blackcoin.buy.prompt":"输入您想要停止购买黑币的价格。","blackcoin.buy.promptExplainer":"黑币价格总是从 800 上涨到 1100 (大致)，然后暴跌。你通常应该一直买入直到卖出前不久。","blackcoin.buy.promptTitle":"黑币购买限额 (当前：{0})","blackcoin.buy.title":"购买黑币直至价格达到 {0}","blackcoin.buy.trigger":"购买黑币(遗迹)","blackcoin.buy":"买入单价：{0}","blackcoin.sell.prompt":"输入您想要出售所有黑币的价格。","blackcoin.sell.promptExplainer":"黑币价格总是从 800 上涨到 1100 (大致)，然后暴跌。你通常希望以接近最高价的价格出售。","blackcoin.sell.promptTitle":"黑币卖单 (当前：{0})","blackcoin.sell.title":"当价格达到 {0} 时出售黑币","blackcoin.sell":"卖出单价：{0}","build.embassies":"在 {1} 设立了 {0} 个大使馆","build.embassy":"在 {1} 设立了 {0} 个大使馆",copy:"复制","craft.limited":"制作 {0} 受库存消耗比率的限制","craft.unlimited":"制作 {0} 不受限制",delete:"删除","dispose.necrocorn":"小猫处理掉了影响效率的多余死灵兽","festival.extend":"小猫延长了节日","festival.hold":"小猫开始举办节日","filter.accelerate":"时间加速","filter.adore":"赞美群星","filter.allKG":"所有游戏日志","filter.build":"建筑","filter.craft":"工艺","filter.disable":"过滤 {0} 日志消息","filter.distribute":"猫口分配","filter.enable":"启用 {0} 日志消息","filter.explainer":"已禁用的项目不会显示在日志中。","filter.faith":"太阳秩序","filter.festival":"节日","filter.hunt":"狩猎","filter.misc":"杂项","filter.praise":"赞美太阳","filter.promote":"提拔领袖","filter.research":"研究","filter.star":"天文事件","filter.timeSkip":"时间跳转","filter.trade":"贸易","filter.transcend":"超越","filter.upgrade":"升级","option.accelerate":"时间加速","option.autofeed":"献祭上古神","option.catnip":"采集猫薄荷","option.crypto":"黑币交易","option.elect.job.any":"任何","option.elect.job":"工作","option.elect.trait":"特质","option.elect":"选择领导人","option.embassies":"建造大使馆","option.faith.adore":"赞美群星","option.faith.autoPraise":"赞美太阳","option.faith.best.unicorn":"优先最佳独角兽建筑","option.faith.refineTears":"提炼眼泪","option.faith.refineTimeCrystals":"精炼时间水晶","option.faith.sacrificeAlicorns":"献祭天角兽","option.faith.sacrificeUnicorns":"献祭独角兽","option.faith.transcend":"自动超越","option.festival":"举办节日","option.fix.cry":"修复冷冻仓","option.hunt":"狩猎","option.magnetos":"开启磁电机","option.observe":"观测天文事件","option.praise":"赞美太阳","option.promote":"提拔领袖","option.promotekittens":"提拔小猫","option.reactors":"开启反应堆","option.shipOverride":"强制243船","option.steamworks":"启动蒸汽工房","option.time.activeHeatTransfer":"主动散热","option.time.reset":"重启时间线 (危险!)","option.time.skip.ignoreOverheat":"忽略过热","option.time.skip":"时间跳转","reset.after":"初次见面，可爱的猫猫科学家为您服务","reset.cancel.activity":"喵斯顿，我们有麻烦了","reset.cancel.message":"重启时间线计划取消","reset.check":"{0} 的触发值: {1}, 现在共有 {2}","reset.checked":"所有条件都已满足，时间线将在几秒后重启!","reset.countdown.0":"&nbsp;0 - 时空裂缝已打开!","reset.countdown.1":"&nbsp;1 - 时间引擎已启动!","reset.countdown.10":"&nbsp;10 - 正在收获猫薄荷","reset.countdown.2":"&nbsp;2 - 正在启动时间锻造","reset.countdown.3":"&nbsp;3 - 正在打开时空裂隙","reset.countdown.4":"&nbsp;4 - 正在关闭卫星","reset.countdown.5":"&nbsp;5 - 正在融化黑币","reset.countdown.6":"&nbsp;6 - 正在启动时间引擎","reset.countdown.7":"&nbsp;7 - 正在拆解电磁炮","reset.countdown.8":"&nbsp;8 - 正在放生蜥蜴","reset.countdown.9":"&nbsp;9 - 正在献祭独角兽","reset.last.message":"我们下个庞加莱回归再见","reset.tip":"您可以通过在设置顶部禁用“启用小猫珂学家”选项来取消此重置。",reset:"重置","resources.consume.prompt":"输入您希望自动化消耗的资源量，以 0.0 到 100.0 之间的百分比表示。","resources.consume.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","resources.consume.promptTitle":"{0} 的消耗份额 (当前：{1})","resources.consume.set":"设置 {0} 的消耗率","resources.consume.title":"消耗 {0} 的 {1}","resources.consume.titleZero":"不消耗 {0}","resources.consume":"消耗率: {0}","resources.stock.prompt":"输入您希望始终保留的资源库存量。","resources.stock.promptExplainer":"游戏支持的所有符号均可接受。如果您提交空值或负值，限制将设置为无穷大。如果您将限制设置为 0，此选项将自动禁用。如果您提交无效值，将被视为您点击了“取消”。","resources.stock.promptTitle":"{0} 的库存值 (当前：{1})","resources.stock.title":"保持 {0} {1} 库存","resources.stock.titleInfinite":"保持所有 {0} 库存","resources.stock.titleZero":"不保留任何 {0} 库存","state.compress":"压缩数据","state.confirmDestruction":"你确定吗？","state.copied.game":"保存“{0}”复制到剪贴板。","state.copied.gameCurrent":"当前保存已复制到剪贴板。","state.copied.state":"状态“{0}”已复制到剪贴板。","state.copied.stateCurrent":"当前状态已复制到剪贴板。","state.copy.game":"将此保存复制到剪贴板。","state.copy.gameCurrent":"将整个小猫游戏保存 (包括 KS 设置) 复制到剪贴板。","state.copy.state":"将这些设置复制到剪贴板。","state.copy.stateCurrent":"将当前的 Kitten Scientists 设置复制到剪贴板。","state.delete.game":"删除此保存。","state.delete.state":"删除这些设置。","state.deleted.game":"保存“{0}”已删除。","state.deleted.state":"状态“{0}”已删除。","state.edit.game":"更改此保存的名称。","state.edit.state":"更改这些设置的名称。","state.exportAll":"备份","state.exportAllTitle":"将所有本地状态存储在单个文件中并下载。","state.import":"从剪贴板导入","state.imported.game":"保存导入。","state.imported.state":"状态导入。","state.importTitle":`从剪贴板粘贴保存或设置。
内容将被自动检测并进行相应处理。`,"state.loaded.game":"已加载保存“{0}”。","state.loaded.state":"已加载状态“{0}”。","state.loadPrompt":"在此处粘贴您的 (未压缩的) 保存或设置：","state.local":"本地状态","state.localGames":"小猫游戏保存","state.localStates":"小猫科学家设置","state.new":"新的","state.noConfirm":"不要求确认","state.store":"储存","state.stored.game":"保存储存。","state.stored.state":"状态储存。","state.storeFactory":"根据出厂默认设置创建新状态。","state.storeGame.prompt":"为此次保存提供标签：","state.storeGame":"从当前游戏中创建一个新的保存。","state.storeState.prompt":"为该状态提供标签：","state.storeState":"根据当前设置创建一个新状态。","state.title":"状态管理器","state.unlabeledGame":"未标记的保存","state.unlabeledState":"未标记状态","state.update.game":"将当前游戏保存到此位置。","state.update.state":"将当前设置保存到此槽中。","state.updated.game":"保存'{0}'已更新。","state.updated.state":"状态“{0}”已更新。","status.auto.disable":"禁用自动化 {0}","status.auto.enable":"启用自动化 {0}","status.ks.disable":"太敬业了，该歇了","status.ks.enable":"神说，要有猫猫珂学家!","status.ks.init":"小猫珂学家已初始化。","status.ks.upgrade":"小猫珂学家 (当前版本:{1}) {0} 可在这里获取：{2} 。","status.reset.check.disable":"在重启时间线前不检查 {0}","status.reset.check.enable":"在重启时间线前检查 {0}","status.resource.disable":"禁用 {0} 资源管理","status.resource.enable":"启用 {0} 资源管理","status.sub.disable":"禁用 {0}","status.sub.enable":"启用 {0}","summary.accelerate":"加速时间 {0} 次","summary.adore":"通过赞美群星积累了 {0} 顿悟","summary.building":"建造了 {0} 个 {1}","summary.craft":"制作了 {0} 个 {1}","summary.day":"天","summary.days":"天","summary.distribute":"帮助 {0} 只猫猫找到工作","summary.embassy":"设立了 {0} 个大使馆","summary.feed":"向上古神献祭 {0} 只死灵兽","summary.festival":"举办了 {0} 次节日","summary.fix.cry":"修复了 {0} 个冷冻仓","summary.head":"过去 {0} 的总结","summary.hunt":"派出了 {0} 批可爱的小猫猎人","summary.praise":"通过赞美太阳积累了 {0} 虔诚","summary.promote":"提拔领袖 {0} 次","summary.refine":"已精炼 {0} {1}","summary.separator":" ","summary.show":"总结","summary.stars":"观测了 {0} 颗流星","summary.sun":"在 {1} 方面顿悟 {0} 次","summary.tech":"掌握了 {0}","summary.time.activeHeatTransferStart":"主动散热 {0} 次","summary.time.getTemporalFlux":"烧水晶获取时间通量 {0} 次","summary.time.reset.content":"获得 {0} 业.<br>获得 {1} 领导力","summary.time.reset.title":"过去 {0} 个时间线的总结","summary.time.skip":"跳过 {0} 年","summary.trade":"与 {1} 贸易了 {0} 次","summary.transcend":"超越了 {0} 次","summary.upgrade":"发明了 {0}","summary.year":"年","summary.years":"年","time.heatTransfer.cycle.disable":"停止在 {0} 主动散热","time.heatTransfer.cycle.enable":"启用在 {0} 主动散热","time.skip.cycle.disable":"停止在 {0} 跳转时间并禁止跳过该周期","time.skip.cycle.enable":"启用在 {0} 跳转时间并允许跳过该周期","time.skip.season.disable":"停止在 {0} 跳转时间","time.skip.season.enable":"启用在 {0} 跳转时间","trade.limited":"与 {0} 的交易限制为比产量更优时才会触发","trade.season.disable":"停止在 {1} 与 {0} 的交易","trade.season.enable":"启用在 {1} 与 {0} 的交易","trade.seasons":"季节","trade.unlimited":"取消与 {0} 交易的限制","ui.additional":"附加选项","ui.build":"营火","ui.close":"关闭","ui.craft.resources":"资源","ui.craft":"工艺","ui.cycles":"周期","ui.disable.all":"全部禁用","ui.distribute":"猫力资源","ui.enable.all":"全部启用","ui.engine":"启用小猫珂学家","ui.faith":"宗教","ui.filter":"日志过滤","ui.infinity":"∞","ui.internals.interval.prompt":"输入新的毫秒数作为 0 到无穷大之间的绝对值。","ui.internals.interval.promptExplainer":"游戏支持的所有符号均可接受。如果您将限制设置为 0，Kitten Scientists 将自动禁用。如果您提交了无效值，则将被视为您点击了“取消”。","ui.internals.interval.promptTitle":"小猫科学家执行间隔 (当前：{0})","ui.internals.interval":"运行间隔(ms): {0}","ui.internals":"小喵设置","ui.itemsHide":"隐藏选项","ui.itemsShow":"显示选项","ui.ksColumn":"显示在第四栏","ui.language":"语言","ui.limit":"限制","ui.limited.off":"无限","ui.limited.on":"环保模式","ui.max.build.prompt":"{0} 的限制 (当前：{1})","ui.max.build.promptExplainer":"游戏支持的所有符号均可接受。如果您提交空值或负值，限制将设置为无穷大。如果您将限制设置为 0，此选项将自动禁用。如果您提交无效值，将被视为您点击了“取消”。","ui.max.build.title":"构建 {0} {1}","ui.max.build.titleInfinite":"永不停止建设{0}","ui.max.build.titleZero":"不要构建{0}","ui.max.craft.prompt":"输入要制作的 {0} 数量的新限制，以 0 到无穷大之间的绝对值表示。","ui.max.craft.promptExplainer":"游戏支持的所有符号均可接受。如果您提交空值或负值，限制将设置为无穷大。如果您将限制设置为 0，此选项将自动禁用。如果您提交无效值，将被视为您点击了“取消”。","ui.max.craft.promptTitle":"制作限制 {0} (当前：{1})","ui.max.craft.title":"制造 {0} {1}","ui.max.craft.titleInfinite":"永不停止创造{0}","ui.max.craft.titleZero":"不要制造 {0}","ui.max.distribute.prompt":"输入要分配的新小猫数量 {0}，作为 0 到无穷大之间的绝对值。","ui.max.distribute.promptExplainer":"游戏支持的所有符号均可接受。如果您提交空值或负值，限制将设置为无穷大。如果您将限制设置为 0，此选项将自动禁用。如果您提交无效值，将被视为您点击了“取消”。","ui.max.distribute.promptTitle":"将最大小猫数量指定为 {0} (当前：{1})","ui.max.distribute.title":"将 {0} 只小猫指定为 {1}","ui.max.distribute.titleInfinite":"分配尽可能多的小猫作为{0}","ui.max.distribute.titleZero":"不将任何小猫指定为{0}","ui.max.embassy.title":"为{1}建造{0}大使馆","ui.max.embassy.titleInfinite":"永不停止为{0}修建大使馆","ui.max.embassy.titleZero":"不要为{0}建造大使馆","ui.max.prompt.absolute":"输入新的限制作为 0 到无穷大之间的绝对值。","ui.max.prompt.float":"输入新的限制作为 0.0 和无穷大之间的绝对值。","ui.max.set":"设置 {0} 的最大值","ui.max.timeSkip.prompt":"输入新的年数作为 0 至无穷大之间的绝对值。","ui.max.timeSkip.promptExplainer":"游戏支持的所有符号均可接受。如果您提交空值或负值，限制将设置为无穷大。如果您将限制设置为 0，此选项将自动禁用。如果您提交无效值，将被视为您点击了“取消”。","ui.max.timeSkip.promptTitle":"最多跳过年份 (当前：{0})","ui.max.timeSkip.title":"一次跳过 {0} 年","ui.max.timeSkip.titleInfinite":"跳过尽可能多的年份","ui.max.timeSkip.titleZero":"不要跳过时间","ui.max":"最大值：{0}","ui.maximum":"上限","ui.min":"最小值 {0}","ui.options":"选项","ui.reset":"恢复至默认","ui.resources":"资源控制","ui.space":"太空","ui.time":"时间","ui.timeCtrl":"时间操纵","ui.trade":"贸易","ui.trigger.accelerateTime.prompt":"输入启用 Tempus Fugit 的新时间通量存储级别，以 0.0 至 100.0 之间的百分比表示。","ui.trigger.accelerateTime.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.accelerateTime.promptTitle":"加速时间的触发值 (当前：{0})","ui.trigger.activeHeatTransfer.prompt":"输入新的启用热传递的时间热存储量，以 0.0 到 100.0 之间的百分比表示。","ui.trigger.activeHeatTransfer.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.activeHeatTransfer.promptTitle":"热传递触发值 (当前：{0})","ui.trigger.build.blocked":`∞
🛈 {0} 部分未设置触发值。此构建不会被触发！`,"ui.trigger.build.inherited":"继承自部分","ui.trigger.build.prompt":"{0} 的触发值 (当前：{1})","ui.trigger.build.promptExplainer":"如果您提交了空值或负值，则将使用部分触发值。如果您提交了无效值，则将被视为您点击了“取消”。","ui.trigger.crypto.prompt":"输入交易黑币的新文物存储级别，以 0.0 到 Infinity 之间的绝对值表示。","ui.trigger.crypto.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.crypto.promptTitle":"触发黑币交易 (当前：{0})","ui.trigger.embassies.prompt":"以 0.0 至 100.0 之间的百分比输入建造大使馆的新文化存储级别。","ui.trigger.embassies.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.embassies.promptTitle":"建立大使馆的触发值 (当前：{0})","ui.trigger.hunt.prompt":"狩猎触发值 (当前：{0})","ui.trigger.hunt.promptExplainer":"如果您提交了负值，则搜索将被禁用。如果您提交了空值或无效值，则将被视为您点击了“取消”。","ui.trigger.inactive":"不活跃","ui.trigger.promoteKittens.prompt":"输入新的可用于升级小猫的黄金库存量，以 0.0 到 100.0 之间的百分比表示。","ui.trigger.promoteKittens.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.promoteKittens.promptTitle":"小猫促销触发值 (当前：{0})","ui.trigger.prompt.absolute":"输入新的触发值作为 0 到无穷大之间的绝对值。","ui.trigger.prompt.float":"输入新的触发值作为 0.0 到无穷大之间的绝对值。","ui.trigger.prompt.percentage":"以 0.0 至 100.0 之间的百分比形式输入新的触发值。","ui.trigger.reset.promptExplainer":"如果您提交了负值，则该项目将被禁用。如果您提交了空值或无效值，则将被视为您点击了“取消”。","ui.trigger.section.blocked":`∞
🛈 The {0} section has no trigger set. This automation will not be triggered!`,"ui.trigger.section.inactive":"∞ (nothing is triggered automatically)","ui.trigger.section.inherited":"继承自部分","ui.trigger.section.prompt":"{0} 部分的触发值 (当前：{1})","ui.trigger.section.promptExplainer":`If you submit an empty value, or a negative value, the section trigger will be set to infinity (∞). Individual automations in this section need to have their own trigger set to be activated.
If you submit an invalid value, it will be treated as if you hit Cancel.`,"ui.trigger.section":"部分默认触发值：{0}","ui.trigger.setinteger.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.setinteger":"输入 {0} 的新触发值。范围应在 0 到任意数字之间。-1表示无穷大。","ui.trigger.setpercentage.promptExplainer":"如果您提交一个空值或者一个无效值，则被视为您点击了取消。","ui.trigger.setpercentage":"输入新的 {0} 触发值，取值范围为 0 到 100 的小数。","ui.trigger.timeSkip.prompt":"输入跳过时间所需的时间水晶的新数量，以 1 到无穷大之间的绝对值表示。","ui.trigger.timeSkip.promptExplainer":"如果您提交了负值，时间跳过将被禁用。如果您提交了空值或无效值，它将被视为您点击了“取消”。","ui.trigger.timeSkip.promptTitle":"时间跳跃触发值 (当前：{0})","ui.trigger":"触发值：{0}","ui.upgrade.buildings":"升级建筑","ui.upgrade.missions":"探索星球","ui.upgrade.policies":"政策","ui.upgrade.races":"探险队出发!","ui.upgrade.techs":"科技","ui.upgrade.upgrades":"升级","ui.upgrade":"升级","ui.upgrades":"升级",update:"更新","upgrade.building.amphitheatre":"剧场 升级为 广播塔!","upgrade.building.aqueduct":"水渠 升级为 水电站!","upgrade.building.library":"图书馆 升级为 数据中心!","upgrade.building.pasture":"牧场 升级为 太阳能发电站!","upgrade.building.warehouse":"已将仓库升级为太空港！","upgrade.policy":"小猫通过了 {0} 法案","upgrade.race":"小猫遇到了 {0}","upgrade.space.mission":"小猫执行了 {0} 的任务","upgrade.space":"小猫执行了 {0}","upgrade.tech":"小猫掌握了 {0}","upgrade.upgrade":"小猫发明了 {0}"};var zi=(o=>(o.build="ks-activity type_ks-build",o.craft="ks-activity type_ks-craft",o.upgrade="ks-activity type_ks-upgrade",o.research="ks-activity type_ks-research",o.trade="ks-activity type_ks-trade",o.hunt="ks-activity type_ks-hunt",o.praise="ks-activity type_ks-praise",o.adore="ks-activity type_ks-adore",o.transcend="ks-activity type_ks-transcend",o.faith="ks-activity type_ks-faith",o.accelerate="ks-activity type_ks-accelerate",o.timeSkip="ks-activity type_ks-timeSkip",o.festival="ks-activity type_ks-festival",o.star="ks-activity type_ks-star",o.distribute="ks-activity type_ks-distribute",o.promote="ks-activity type_ks-promote",o.misc="ks-activity",o))(zi||{});const Wi=["accelerate","adore","build","craft","distribute","faith","festival","hunt","misc","praise","promote","research","star","timeSkip","trade","transcend","upgrade"];class Ss extends k{constructor(e){super(!0);B(this,ct);P(this,ct,e)}get variant(){return A(this,ct)}}ct=new WeakMap;class xs extends k{constructor(e=!1,t=new k(!0)){super(e);g(this,"filters");g(this,"disableKGLog");this.filters=this.initFilters(),this.disableKGLog=t}initFilters(){const e={};for(const t of Wi)e[t]=new Ss(zi[t]);return e}load(e){var t;m(e)||(super.load(e),N(this.filters,e.filters,(n,s)=>{n.enabled=(s==null?void 0:s.enabled)??n.enabled}),this.disableKGLog.enabled=((t=e.disableKGLog)==null?void 0:t.enabled)??this.disableKGLog.enabled)}}class Cs extends k{constructor(e,t=!1,n=jt.DEFAULT_CONSUME_RATE,s=0){super(t);B(this,ut);g(this,"consume");g(this,"stock",0);P(this,ut,e),this.consume=n,this.stock=s}get resource(){return A(this,ut)}}ut=new WeakMap;class Ts extends k{constructor(e=!1){super(e);g(this,"resources");this.resources=this.initResources()}initResources(){const e={};for(const t of Ti)e[t]=new Cs(t);return e}load(e){m(e)||(super.load(e),N(this.resources,e.resources,(t,n)=>{t.enabled=(n==null?void 0:n.enabled)??t.enabled,t.consume=(n==null?void 0:n.consume)??t.consume,t.stock=(n==null?void 0:n.stock)??t.stock}))}}class Es extends k{constructor(e=new k,t=new k(!0)){super(!0);g(this,"noConfirm");g(this,"compress");this.noConfirm=e,this.compress=t}load(e){m(e)||(super.load(e),this.noConfirm.load(e.noConfirm),this.compress.load(e.compress))}}class Hi extends k{constructor(e=!1,t=new xs,n=new Ts,s=new Es,a=Ee,r=new k){super(e);g(this,"interval",2e3);g(this,"locale");g(this,"ksColumn");g(this,"filters");g(this,"resources");g(this,"states");this.filters=t,this.resources=n,this.states=s,this.locale=new Ft(a,[{label:"Deutsch",value:"de-DE"},{label:"English",value:"en-US"},{label:"עִברִית",value:"he-IL"},{label:"中文",value:"zh-CN"}]),this.ksColumn=r}load(e,t=!1){m(e)||(super.load(e),t||(this.interval=e.interval??this.interval,this.states.load(e.states),this.locale.load(e.locale),this.ksColumn.load(e.ksColumn)),this.filters.load(e.filters),this.resources.load(e.resources))}}const Fi={"de-DE":ks,"en-US":ys,"he-IL":ws,"zh-CN":_s};class re{constructor(i,e){g(this,"_i18nData");g(this,"_isLoaded",!1);g(this,"_host");g(this,"settings");g(this,"bonfireManager");g(this,"religionManager");g(this,"scienceManager");g(this,"spaceManager");g(this,"timeControlManager");g(this,"timeManager");g(this,"tradeManager");g(this,"villageManager");g(this,"workshopManager");g(this,"_activitySummary");g(this,"_timeoutMainLoop");this.settings=new Hi,this._i18nData=Fi,this.setLanguage(e,!1),this._host=i,this._activitySummary=new vs(this._host),this.workshopManager=new jt(this._host),this.bonfireManager=new On(this._host,this.workshopManager),this.religionManager=new Nn(this._host,this.bonfireManager,this.workshopManager),this.scienceManager=new Gn(this._host,this.workshopManager),this.spaceManager=new Vn(this._host,this.workshopManager),this.timeControlManager=new ls(this._host,this.bonfireManager,this.religionManager,this.spaceManager,this.workshopManager),this.timeManager=new os(this._host,this.workshopManager),this.tradeManager=new ds(this._host,this.workshopManager),this.villageManager=new fs(this._host,this.workshopManager)}get isLoaded(){return this._isLoaded}isLanguageSupported(i){return Object.keys(this._i18nData).some(e=>e.startsWith(`${i}-`))}isLocaleSupported(i){return i in this._i18nData}localeSupportsFirstLetterSplits(i=this.settings.locale.selected){return i!=="zh-CN"}localeForLanguage(i){return Object.keys(this._i18nData).find(e=>e.startsWith(`${i}-`))}setLanguage(i,e=!0){const t=this.settings.locale.selected;if(!this.isLanguageSupported(i))U(`Requested language '${i}' is not available. Falling back to '${Ee}'.`),this.settings.locale.selected=Ee;else{const n=v(this.localeForLanguage(i));H(`Selecting language '${n}'.`),this.settings.locale.selected=n}t!==this.settings.locale.selected&&e&&this._host.rebuildUi()}setLocale(i,e=!0){const t=this.settings.locale.selected;this.isLocaleSupported(i)?(H(`Selecting language '${i}'.`),this.settings.locale.selected=i):(U(`Requested language '${i}' is not available. Falling back to '${Ee}'.`),this.settings.locale.selected=Ee),t!==this.settings.locale.selected&&e&&this._host.rebuildUi()}stateLoad(i,e=!1){this._isLoaded=!0,this.stop(!1);const t=Ie();i.v!==t&&U(`Attempting to load engine state with version tag '${i.v}' when engine is at version '${t}'!`);const n=(s,a)=>{try{s()}catch(r){ge(`Failed load of ${a} settings.`,r)}};n(()=>{this.settings.load(i.engine,e)},"engine"),n(()=>{this.bonfireManager.settings.load(i.bonfire)},"bonfire"),n(()=>{this.religionManager.settings.load(i.religion)},"religion"),n(()=>{this.scienceManager.settings.load(i.science)},"science"),n(()=>{this.spaceManager.settings.load(i.space)},"space"),n(()=>{this.timeControlManager.settings.load(i.timeControl)},"time control"),n(()=>{this.timeManager.settings.load(i.time)},"time"),n(()=>{this.tradeManager.settings.load(i.trade)},"trade"),n(()=>{this.villageManager.settings.load(i.village)},"village"),n(()=>{this.workshopManager.settings.load(i.workshop)},"workshop"),this.setLocale(this.settings.locale.selected),this.settings.enabled?this.start(!1):this.stop(!1)}static get DEFAULT_STATE(){return{v:Ie(),engine:new Hi,bonfire:new Zt,religion:new Kt,science:new Vt,space:new kt,timeControl:new Li,time:new Oi,trade:new Di,village:new Ni,workshop:new _t}}stateReset(){this.stateLoad(re.DEFAULT_STATE)}stateSerialize(){return{v:Ie(),engine:this.settings,bonfire:this.bonfireManager.settings,religion:this.religionManager.settings,science:this.scienceManager.settings,space:this.spaceManager.settings,timeControl:this.timeControlManager.settings,time:this.timeManager.settings,trade:this.tradeManager.settings,village:this.villageManager.settings,workshop:this.workshopManager.settings}}start(i=!0){if(this._timeoutMainLoop)return;const e=()=>{const t={requestGameUiRefresh:!1,entry:new Date().getTime(),exit:0,measurements:{}};this._iterate(t).then(()=>{t.exit=new Date().getTime();const n=t.exit-t.entry;document.dispatchEvent(new CustomEvent("ks.reportFrame",{detail:t})),this._timeoutMainLoop!==void 0&&(this._timeoutMainLoop=window.setTimeout(e,Math.max(10,this._host.engine.settings.interval-n)))}).catch(n=>{U(Sn(n))})};this._timeoutMainLoop=window.setTimeout(e,this._host.engine.settings.interval),i&&this._host.engine.imessage("status.ks.enable")}stop(i=!0){this._timeoutMainLoop&&(clearTimeout(this._timeoutMainLoop),this._timeoutMainLoop=void 0,i&&this._host.engine.imessage("status.ks.disable"))}async _iterate(i){this.settings.filters.disableKGLog.enabled||this._maintainKGLogFilters();let[,e]=await ht(()=>this.scienceManager.tick(i));i.measurements.scienceManager=e,[,e]=Ce(()=>{this.bonfireManager.tick(i)}),i.measurements.bonfireManager=e,[,e]=Ce(()=>{this.spaceManager.tick(i)}),i.measurements.spaceManager=e,[,e]=await ht(()=>this.workshopManager.tick(i)),i.measurements.workshopManager=e,[,e]=Ce(()=>{this.tradeManager.tick(i)}),i.measurements.tradeManager=e,[,e]=await ht(()=>this.religionManager.tick(i)),i.measurements.religionManager=e,[,e]=Ce(()=>{this.timeManager.tick(i)}),i.measurements.timeManager=e,[,e]=Ce(()=>{this.villageManager.tick(i)}),i.measurements.villageManager=e,[,e]=await ht(()=>this.timeControlManager.tick(i)),i.measurements.timeControlManager=e,[,e]=Ce(()=>{i.requestGameUiRefresh&&this._host.game.ui.render()}),i.measurements.gameUiRefresh=e}_maintainKGLogFilters(){for(const e of Object.values(this._host.game.console.filters))e.enabled=!1;const i=window.document.querySelectorAll("[id^=filter-]");for(const e of i)e.checked=!1}symbolForCycle(i){var e;return((e=this._host.game.calendar.cycles.find(t=>t.name===i))==null?void 0:e.uglyph)??""}labelForCycle(i){const e=this.symbolForCycle(i),t=this._host.engine.i18n(`$space.planet.${i==="redmoon"?"moon":i}.label`);return`${e} ${t}`}labelForPlanet(i){const e=i==="moon"?"redmoon":i,t=we.includes(e)?e:void 0,n=this._host.engine.i18n(`$space.planet.${i}.label`);return t===void 0?n:`${this.symbolForCycle(t)} ${n}`}i18n(i,e=[]){let t;if(i.startsWith("$")&&(t=this._host.i18nEngine(i.slice(1))),t=t??this._i18nData[this.settings.locale.selected][i],m(t)){if(t=Fi[Ee][i],!t)return U(`i18n key '${i}' not found in default language.`),`$${i}`;U(`i18n key '${i}' not found in selected language.`)}for(let s=0;s<e.length;++s)t=t.replace(`{${s}}`,`${e[s]}`);return t}iactivity(i,e=[],t){const n=this.i18n(i,e);if(t){const s=`type_${t}`;this._printOutput(`ks-activity ${s}`,"#e65C00",n)}else this._printOutput("ks-activity","#e65C00",n)}imessage(i,e=[]){this._printOutput("ks-default","#aa50fe",this.i18n(i,e))}storeForSummary(i,e=1,t="other"){this._activitySummary.storeActivity(i,e,t)}getSummary(){return this._activitySummary.renderSummary()}displayActivitySummary(){const i=this.getSummary();for(const e of i)this._printOutput("ks-summary","#009933",e);this.resetActivitySummary()}resetActivitySummary(){this._activitySummary.resetActivity()}_printOutput(i,e,...t){if(this.settings.filters.enabled){for(const s of Object.values(this.settings.filters.filters))if(s.variant===i&&!s.enabled)return}const n=this._host.game.msg(...t,i);$(n.span).css("color",e),be(...t)}static evaluateSubSectionTrigger(i,e){return i<0?e:e<0?i:e}}const M={Bonfire:"M80-80v-183l363-491-67-90 49-35 55 75 56-75 48 35-66 90 362 491v183H80Zm400-623L140-243v103h145l195-273 195 273h145v-103L480-703ZM359-140h242L480-310 359-140Zm121-273 195 273-195-273-195 273 195-273Z",CheckboxCheck:"m419-321 289-289-43-43-246 246-119-119-43 43 162 162ZM120-120v-720h720v720H120Zm60-60h600v-600H180v600Zm0 0v-600 600Z",CheckboxUnCheck:"M120-120v-720h720v720H120Zm60-60h600v-600H180v600Z",Copy:"M240-200v-680h560v680H240Zm60-60h440v-560H300v560ZM120-80v-680h60v620h500v60H120Zm180-180v-560 560Z",Cycles:"M120-80v-740h125v-60h65v60h340v-60h65v60h125v360h-60v-110H180v430h324v60H120ZM760 0q-73 0-127.5-45.5T564-160h62q13 44 49.5 72T760-60q58 0 99-41t41-99q0-58-41-99t-99-41q-29 0-54 10.5T662-300h58v60H560v-160h60v57q27-26 63-41.5t77-15.5q83 0 141.5 58.5T960-200q0 83-58.5 141.5T760 0ZM180-630h600v-130H180v130Zm0 0v-130 130Z",DataUsage:"M480-80q-82 0-155-31.5T197.5-197q-54.5-54-86-127T80-479q0-158 106.5-272T451-877v102q-115 11-192 95.5T182-479q0 124 87 210.5T480-182q72 0 136-32.5T725-306l88 51q-58 83-145.5 129T480-80Zm362-229-88-49q12-31 18-61.5t6-60.5q0-116-76.5-201T511-776v-102q157 11 263 124.5T880-484q0 45-9.5 88.5T842-309Z",Delete:"M201-120v-630h-41v-60h188v-30h264v30h188v60h-41v630H201Zm60-60h438v-570H261v570Zm106-86h60v-399h-60v399Zm166 0h60v-399h-60v399ZM261-750v570-570Z",Draft:"M160-80v-800h421l219 219v581H160Zm391-554v-186H220v680h520v-494H551ZM220-820v186-186 680-680Z",Eco:"M213-175q-43.59-45-68.3-104Q120-338 120-400q0-73 25.5-133.5T222-645q35-35 87-59t122.5-37.5Q502-755 591-758.5t198 3.5q8 108 5.5 197.5t-16 160.75q-13.5 71.25-38 124.56Q716-218.87 680-183q-51 51-110 77T444-80q-69 0-126.5-23.5T213-175Zm103 0q25 17 58 26t69.92 9Q497-140 547-162t91-64q27-27 46-70.5t31-103Q727-459 731-534t0-165q-94-2-168.5 2.5T431-680q-57 12-98 30.5T266-604q-42 43-64 91t-22 98q0 48 20.5 100.5T251-230q53-98 127-176t157-123q-87 75-141 162.5T316-175Zm0 0Zm0 0Z",Edit:"M180-180h44l472-471-44-44-472 471v44Zm-60 60v-128l617-616 128 128-617 616H120Zm659-617-41-41 41 41Zm-105 64-22-22 44 44-22-22Z",ExpandCircleDown:"m480-351 173-173-43-42-130 130-130-130-43 42 173 173Zm0 271q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-156t86-127Q252-817 325-848.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82-31.5 155T763-197.5q-54 54.5-127 86T480-80Zm0-60q142 0 241-99.5T820-480q0-142-99-241t-241-99q-141 0-240.5 99T140-480q0 141 99.5 240.5T480-140Zm0-340Z",ExpandCircleUp:"m350-394 130-130 130 130 43-42-173-173-173 173 43 42ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-155.5t85.5-127q54-54.5 127-86T480-880q83 0 155.5 31.5t127 86q54.5 54.5 86 127T880-480q0 83-31.5 156t-86 127q-54.5 54-127 85.5T480-80Zm0-60q141 0 240.5-99T820-480q0-141-99.5-240.5T480-820q-142 0-241 99.5T140-480q0 142 99 241t241 99Zm0-340Z",Import:"M450-160v-371L330-411l-43-43 193-193 193 193-43 43-120-120v371h-60ZM160-597v-203h640v203h-60v-143H220v143h-60Z",Religion:"M40-120v-560q0-45.83 32.12-77.92 32.12-32.08 78-32.08T228-757.92q32 32.09 32 77.92v31l220-191 220 191v-31q0-45.83 32.12-77.92 32.12-32.08 78-32.08T888-757.92q32 32.09 32 77.92v560H530v-250H430v250H40Zm720-510h100v-49.82q0-21.18-14.32-35.68-14.33-14.5-35.5-14.5-21.18 0-35.68 14.37Q760-701.25 760-680v50Zm-660 0h100v-49.82q0-21.18-14.32-35.68-14.33-14.5-35.5-14.5-21.18 0-35.68 14.37Q100-701.25 100-680v50Zm0 450h100v-390H100v390Zm160 0h110v-250h220v250h110v-390L480-761 260-570v390Zm500 0h100v-390H760v390ZM479.94-505Q457-505 441-521.06q-16-16.06-16-39T441.06-599q16.06-16 39-16T519-598.94q16 16.06 16 39T518.94-521q-16.06 16-39 16Z",Reset:"M480-160q-133 0-226.5-93.5T160-480q0-133 93.5-226.5T480-800q85 0 149 34.5T740-671v-129h60v254H546v-60h168q-38-60-97-97t-137-37q-109 0-184.5 75.5T220-480q0 109 75.5 184.5T480-220q83 0 152-47.5T728-393h62q-29 105-115 169t-195 64Z",Save:"M840-683v563H120v-720h563l157 157Zm-60 27L656-780H180v600h600v-476ZM479.76-245q43.24 0 73.74-30.26 30.5-30.27 30.5-73.5 0-43.24-30.26-73.74-30.27-30.5-73.5-30.5-43.24 0-73.74 30.26-30.5 30.27-30.5 73.5 0 43.24 30.26 73.74 30.27 30.5 73.5 30.5ZM233-584h358v-143H233v143Zm-53-72v476-600 124Z",SaveAs:"M120-120v-720h563l157 157v117l-60 60v-150L656-780H180v600h280v60H120Zm60-660v600-600ZM520-40v-123l263-262 122 122L643-40H520Zm300-263-37-37 37 37ZM580-100h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19ZM233-584h358v-143H233v143Zm247 339q14 0 27-3t24-10l39-40q7-11 10.5-24t3.5-27q0-43.33-30.26-73.67Q523.47-453 480.24-453q-43.24 0-73.74 30.26-30.5 30.27-30.5 73.5 0 43.24 30.33 73.74Q436.67-245 480-245Z",Workshop:"M768-120 517-371l57-57 251 251-57 57Zm-581 0-57-57 290-290-107-107-23 23-44-44v85l-24 24-122-122 24-24h86l-48-48 131-131q17-17 37-23t44-6q24 0 44 8.5t37 25.5L348-699l48 48-24 24 104 104 122-122q-8-13-12.5-30t-4.5-36q0-53 38.5-91.5T711-841q15 0 25.5 3t17.5 8l-85 85 75 75 85-85q5 8 8.5 19.5T841-709q0 53-38.5 91.5T711-579q-18 0-31-2.5t-24-7.5L187-120Z",Resources:"M120-40v-880h60v80h600v-80h60v880h-60v-80H180v80h-60Zm60-469h110v-160h220v160h270v-271H180v271Zm0 329h270v-160h220v160h110v-269H180v269Zm170-329h100v-100H350v100Zm160 329h100v-100H510v100ZM350-509h100-100Zm160 329h100-100Z",Seasons:"M306-394q-17 0-28.5-11.5T266-434q0-17 11.5-28.5T306-474q17 0 28.5 11.5T346-434q0 17-11.5 28.5T306-394Zm177 0q-17 0-28.5-11.5T443-434q0-17 11.5-28.5T483-474q17 0 28.5 11.5T523-434q0 17-11.5 28.5T483-394Zm170 0q-17 0-28.5-11.5T613-434q0-17 11.5-28.5T653-474q17 0 28.5 11.5T693-434q0 17-11.5 28.5T653-394ZM120-80v-740h125v-60h65v60h340v-60h65v60h125v740H120Zm60-60h600v-430H180v430Zm0-490h600v-130H180v130Zm0 0v-130 130Z",Settings:"m388-80-20-126q-19-7-40-19t-37-25l-118 54-93-164 108-79q-2-9-2.5-20.5T185-480q0-9 .5-20.5T188-521L80-600l93-164 118 54q16-13 37-25t40-18l20-127h184l20 126q19 7 40.5 18.5T669-710l118-54 93 164-108 77q2 10 2.5 21.5t.5 21.5q0 10-.5 21t-2.5 21l108 78-93 164-118-54q-16 13-36.5 25.5T592-206L572-80H388Zm48-60h88l14-112q33-8 62.5-25t53.5-41l106 46 40-72-94-69q4-17 6.5-33.5T715-480q0-17-2-33.5t-7-33.5l94-69-40-72-106 46q-23-26-52-43.5T538-708l-14-112h-88l-14 112q-34 7-63.5 24T306-642l-106-46-40 72 94 69q-4 17-6.5 33.5T245-480q0 17 2.5 33.5T254-413l-94 69 40 72 106-46q24 24 53.5 41t62.5 25l14 112Zm44-210q54 0 92-38t38-92q0-54-38-92t-92-38q-54 0-92 38t-38 92q0 54 38 92t92 38Zm0-130Z",Space:"m187-551 106 45q18-36 38.5-71t43.5-67l-79-16-109 109Zm154 81 133 133q57-26 107-59t81-64q81-81 119-166t41-192q-107 3-192 41T464-658q-31 31-64 81t-59 107Zm229-96q-20-20-20-49.5t20-49.5q20-20 49.5-20t49.5 20q20 20 20 49.5T669-566q-20 20-49.5 20T570-566Zm-15 383 109-109-16-79q-32 23-67 43.5T510-289l45 106Zm326-694q9 136-34 248T705-418l-2 2-2 2 22 110q3 15-1.5 29T706-250L535-78l-85-198-170-170-198-85 172-171q11-11 25-15.5t29-1.5l110 22q1-1 2-1.5t2-1.5q99-99 211-142.5T881-877ZM149-325q35-35 85.5-35.5T320-326q35 35 34.5 85.5T319-155q-26 26-80.5 43T75-80q15-109 31.5-164t42.5-81Zm42 43q-14 15-25 47t-19 82q50-8 82-19t47-25q19-17 19.5-42.5T278-284q-19-18-44.5-17.5T191-282Z",State:"M820-240v-480h60v480h-60Zm-340 1-43-42 169-169H80v-60h526L438-679l42-42 241 241-241 241Z",Summary:"M279-621h60v-60h-60v60Zm0 171h60v-60h-60v60Zm0 171h60v-60h-60v60ZM120-120v-720h522l198 198v522H120Zm60-60h600v-429H609v-171H180v600Zm0-600v171.43V-780v600-600Z",Sync:"M167-160v-60h130l-15-12q-64-51-93-111t-29-134q0-106 62.5-190.5T387-784v62q-75 29-121 96.5T220-477q0 63 23.5 109.5T307-287l30 21v-124h60v230H167Zm407-15v-63q76-29 121-96.5T740-483q0-48-23.5-97.5T655-668l-29-26v124h-60v-230h230v60H665l15 14q60 56 90 120t30 123q0 106-62 191T574-175Z",Time:"m627-287 45-45-159-160v-201h-60v225l174 181ZM480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-82 31.5-155t86-127.5Q252-817 325-848.5T480-880q82 0 155 31.5t127.5 86Q817-708 848.5-635T880-480q0 82-31.5 155t-86 127.5Q708-143 635-111.5T480-80Zm0-400Zm0 340q140 0 240-100t100-240q0-140-100-240T480-820q-140 0-240 100T140-480q0 140 100 240t240 100Z",Trigger:"m393-165 279-335H492l36-286-253 366h154l-36 255Zm-73 85 40-280H160l360-520h80l-40 320h240L400-80h-80Zm154-396Z"},_={iconButton:"_iconButton_q7zpt_17",inactive:"_inactive_q7zpt_29",ineffective:"_ineffective_q7zpt_37",button:"_button_q7zpt_43",readonly:"_readonly_q7zpt_67",buttonIcon:"_buttonIcon_q7zpt_72",alignRight:"_alignRight_q7zpt_77",large:"_large_q7zpt_81",bordered:"_bordered_q7zpt_85",headAction:"_headAction_q7zpt_97",lastHeadAction:"_lastHeadAction_q7zpt_100",consumeButton:"_consumeButton_q7zpt_104",stockButton:"_stockButton_q7zpt_107"};class J extends EventTarget{constructor(e,t){super();g(this,"_host");g(this,"_options");g(this,"children",new Set);g(this,"_onClick");g(this,"_onRefresh");this._host=e,this._options=t??{},this._onClick=t==null?void 0:t.onClick,this._onRefresh=t==null?void 0:t.onRefresh}click(){var e;(e=this._onClick)==null||e.call(this,this)}refreshUi(){var e;(e=this._onRefresh)==null||e.call(this,this);for(const t of this.children)try{t.refreshUi()}catch(n){ge("Error while refreshing child component!",n)}}addChild(e){this.children.add(e),this.element.append(e.element)}addChildren(e){for(const t of e??[])this.addChild(t)}removeChild(e){this.children.has(e)&&(e.element.remove(),this.children.delete(e))}removeChildren(e){for(const t of e)this.removeChild(t)}}class Q extends J{constructor(e,t,n=null,s){super(e,{...s,children:[],classes:[]});g(this,"_iconElement");g(this,"element");g(this,"readOnly");g(this,"inactive");g(this,"ineffective");this.element=$("<div/>",{title:s==null?void 0:s.title}).addClass(_.button).text(t),(s==null?void 0:s.border)!==!1&&this.element.addClass(_.bordered),(s==null?void 0:s.alignment)==="right"&&this.element.addClass(_.alignRight),n!==null&&(this._iconElement=$(`<svg class="${_.buttonIcon}" style="width: 18px; height: 18px;" viewBox="0 -960 960 960" fill="currentColor"><path d="${n}"/></svg>`),(s==null?void 0:s.alignment)==="right"?this.element.append(this._iconElement):this.element.prepend(this._iconElement));for(const a of(s==null?void 0:s.classes)??[])this.element.addClass(a);this.element.on("click",()=>{this.readOnly||this.click()}),this.addChildren(s==null?void 0:s.children),this.readOnly=(s==null?void 0:s.readOnly)??!1,this.inactive=(s==null?void 0:s.inactive)??!1,this.ineffective=!1}updateLabel(e){this.element.text(e),this._iconElement!==void 0&&(this._options.alignment==="right"?this.element.append(this._iconElement):this.element.prepend(this._iconElement))}updateTitle(e){this.element.prop("title",e)}click(){this.readOnly||super.click()}refreshUi(){super.refreshUi(),this.readOnly?this.element.addClass(_.readonly):this.element.removeClass(_.readonly),this.inactive?this.element.addClass(_.inactive):this.element.removeClass(_.inactive),this.ineffective?this.element.addClass(_.ineffective):this.element.removeClass(_.ineffective)}}class R extends J{constructor(e,t){super(e,{...t,children:[],classes:[]});g(this,"element");this.element=$("<div/>");for(const n of(t==null?void 0:t.classes)??[])this.element.addClass(n);this.addChildren(t==null?void 0:t.children)}}const _e={delimiter:"_delimiter_16hnh_1"};class ie extends J{constructor(e){super(e,{});g(this,"element");const t=$("<div/>").addClass(_e.delimiter);this.element=t}}const Gi={dialog:"_dialog_b4vj0_1",close:"_close_b4vj0_7"},Zi={explainer:"_explainer_121s0_1"},Ms={header:"_header_19ql8_1"};class q extends J{constructor(e,t,n){super(e,n);g(this,"element");const s=$("<li/>",{text:t}).addClass(Ms.header);this.element=s,this.addChildren(n==null?void 0:n.children)}get elementLabel(){return this.element}}class Rs extends J{constructor(e,t){super(e,{...t,children:[],classes:[]});g(this,"element");this.element=$('<input type="text"/>').addClass("ks-input");for(const n of(t==null?void 0:t.classes)??[])this.element.addClass(n);t!=null&&t.onChange&&this.element.on("change",()=>{var n;return(n=t.onChange)==null?void 0:n.call(t,this.element[0].value)}),t!=null&&t.value&&(this.element[0].value=t.value),t!=null&&t.selected&&(this.element[0].selectionStart=0,this.element[0].selectionEnd=-1),this.element.on("keyup",n=>{var s,a;switch(n.key){case"Enter":(s=t==null?void 0:t.onEnter)==null||s.call(t,this.element[0].value);break;case"Escape":(a=t==null?void 0:t.onEscape)==null||a.call(t,this.element[0].value);break}}),this.addChildren(t==null?void 0:t.children)}}class Ki extends J{constructor(e,t,n){super(e,{...n,children:[],classes:[]});g(this,"element");this.element=$("<p/>").text(t);for(const s of(n==null?void 0:n.classes)??[])this.element.addClass(s);this.addChildren(n==null?void 0:n.children)}}const Vi={toolbar:"_toolbar_1654f_1"};class T extends J{constructor(e,t){super(e,{...t,children:[]});g(this,"element");g(this,"returnValue");this.element=$("<dialog/>").addClass("dialog").addClass("help").addClass(Gi.dialog),(t==null?void 0:t.hasClose)!==!1&&this.addChild(new Q(e,"close",null,{classes:[Gi.close],onClick:()=>{var n;this.close(),(n=t==null?void 0:t.onCancel)==null||n.call(t)}})),this.addChildren(t==null?void 0:t.children),this.returnValue=(t==null?void 0:t.promptValue)??"",this.addChildren(xe([t!=null&&t.prompt?new Rs(e,{onChange:n=>{this.returnValue=n},onEnter:n=>{var s;this.returnValue=n,this.close(),(s=t.onConfirm)==null||s.call(t,this.returnValue)},onEscape:n=>{var s;this.close(),(s=t.onCancel)==null||s.call(t)},selected:!0,value:t.promptValue}):void 0,...(t==null?void 0:t.childrenAfterPrompt)??[],new ie(e),new R(e,{children:xe([new Q(e,"OK",null,{classes:[_.large],onClick:()=>{var n;this.close(),(n=t==null?void 0:t.onConfirm)==null||n.call(t,this.returnValue)}}),t!=null&&t.hasCancel?new Q(e,"Cancel",null,{classes:[_.large],onClick:()=>{var n;this.close(),(n=t.onCancel)==null||n.call(t)}}):void 0]),classes:[Vi.toolbar]})]))}show(){$("#gamePageContainer").append(this.element),this.element[0].show()}showModal(){$("#gamePageContainer").append(this.element),this.element[0].showModal()}close(){this.element[0].close(),this.element.remove()}static async prompt(e,t,n,s,a){return new Promise(r=>{new T(e,{children:xe([n?new q(e,n):void 0,new Ki(e,t)]),childrenAfterPrompt:a?[new R(e,{children:[new Ki(e,a)],classes:[Zi.explainer]})]:[],hasCancel:!0,hasClose:!1,onCancel:()=>{r(void 0)},onConfirm:l=>{r(l)},prompt:!0,promptValue:s}).showModal()})}}const E={label:"_label_1nlev_1",splitter:"_splitter_1nlev_16",iconLabel:"_iconLabel_1nlev_20",fillSpace:"_fillSpace_1nlev_26"};class ve extends J{constructor(e,t){super(e,t);g(this,"element");this.element=$("<li/>");for(const n of(t==null?void 0:t.classes)??[])this.element.addClass(n);(t==null?void 0:t.delimiter)===!0&&this.element.addClass(_e.delimiter),this.addChildren(t==null?void 0:t.children)}}const St={head:"_head_wr1pj_1"};class ye extends ve{constructor(e,t,n){super(e,n);g(this,"head");g(this,"elementLabel");this.head=new R(e),this.head.element.addClass(St.head),this.addChild(this.head),this.elementLabel=$("<label/>",{text:`${(n==null?void 0:n.upgradeIndicator)===!0?"⮤ ":""}${t}`}).addClass(E.label).addClass(St.label).on("click",()=>{this.click()}),this.head.element.append(this.elementLabel);for(const s of(n==null?void 0:n.childrenHead)??[])this.head.addChild(s);if(n!=null&&n.icon){const s=$("<div/>",{html:`<svg style="width: 15px; height: 15px;" viewBox="0 -960 960 960" fill="currentColor"><path d="${n.icon}"/></svg>`}).addClass(E.iconLabel);this.elementLabel.prepend(s)}}}const L={setting:"_setting_1ndg5_1",checkbox:"_checkbox_1ndg5_6",panelContent:"_panelContent_1ndg5_10",hidden:"_hidden_1ndg5_17",checked:"_checked_1ndg5_22",expanded:"_expanded_1ndg5_26",readonly:"_readonly_1ndg5_34"},Ut=class Ut extends ye{constructor(e,t,n,s={}){super(e,n,{...s,children:[]});g(this,"setting");g(this,"checkbox");g(this,"readOnly");this.element.addClass(L.setting);const a=`ks-setting${fn(Ut,Pt)._++}`,r=$("<input/>",{id:a,type:"checkbox"}).addClass(L.checkbox);this.readOnly=s.readOnly??!1,r.prop("disabled",this.readOnly),r.on("change",()=>{var l,u;r.is(":checked")&&!t.enabled?(t.enabled=!0,(l=s.onCheck)==null||l.call(s),this.refreshUi()):!r.is(":checked")&&t.enabled&&(t.enabled=!1,(u=s.onUnCheck)==null||u.call(s),this.refreshUi())}),this.elementLabel.before(r),this.elementLabel.prop("for",a),this.checkbox=r,this.setting=t,this.addChildren(s.children)}check(){var e,t;this.setting.enabled=!0,(t=(e=this._options).onCheck)==null||t.call(e),this.refreshUi()}uncheck(){var e,t;this.setting.enabled=!1,(t=(e=this._options).onUnCheck)==null||t.call(e),this.refreshUi()}refreshUi(){super.refreshUi(),this.setting.enabled?this.element.addClass(L.checked):this.element.removeClass(L.checked),this.readOnly?this.element.addClass(L.readonly):this.element.removeClass(L.readonly),m(this.checkbox)||(this.checkbox.prop("checked",this.setting.enabled),this.checkbox.prop("disabled",this.readOnly))}};Pt=new WeakMap,B(Ut,Pt,0);let S=Ut;class xt extends ke{constructor(i,e=400){super("ERR_OS_INVALID_OPERATION",i,e),this.name="InvalidOperationError",typeof Error.captureStackTrace<"u"&&Error.captureStackTrace(this,xt)}}const As={maxButton:"_maxButton_133h2_1"};class Xt extends Q{constructor(e,t,n){super(e,"",null,{...n,classes:[As.maxButton,...(n==null?void 0:n.classes)??[]]});g(this,"setting");if(m(n==null?void 0:n.onClick))throw new xt("Missing click handler on MaxButton.");this.setting=t}}class Ct extends Q{constructor(e,t,n,s){super(e,"",M.Trigger,s);g(this,"behavior");g(this,"setting");g(this,"_onRefreshTitle");if(this._onRefreshTitle=s==null?void 0:s.onRefreshTitle,this.behavior=t instanceof X?"percentage":"integer",m(s==null?void 0:s.onClick))throw new xt("Missing click handler on TriggerButton.");this.setting=t}refreshUi(){if(super.refreshUi(),this._onRefreshTitle){this._onRefreshTitle(this);return}const e=this.behavior==="integer"?this._host.renderAbsolute(this.setting.trigger,"invariant"):this._host.renderPercentage(this.setting.trigger,"invariant",!0);this.updateTitle(this._host.engine.i18n("ui.trigger",[e])),this.updateLabel(e)}}class ji extends S{constructor(e,t,n,s,a){super(e,t,s,a);g(this,"maxButton");g(this,"triggerButton");this.maxButton=new Xt(e,t,{alignment:"right",border:!1,classes:[_.headAction],onClick:a!=null&&a.onSetMax?()=>{var r;return(r=a.onSetMax)==null?void 0:r.call(a,this)}:void 0,onRefresh:a!=null&&a.onRefreshMax?()=>{var r;return(r=a.onRefreshMax)==null?void 0:r.call(a,this)}:void 0}),this.triggerButton=new Ct(e,t,n,{border:!1,classes:[_.lastHeadAction],onClick:a!=null&&a.onSetTrigger?()=>{var r;return(r=a.onSetTrigger)==null?void 0:r.call(a,this)}:void 0,onRefreshTitle:a!=null&&a.onRefreshTrigger?()=>{var r;return(r=a.onRefreshTrigger)==null?void 0:r.call(a,this)}:void 0}),this.head.addChildren([new R(e,{classes:[E.fillSpace]}),this.maxButton,this.triggerButton])}refreshUi(){super.refreshUi()}}const le={getBuildOption:(o,i,e,t,n,s,a=!1,r=!1)=>{const l=()=>{T.prompt(o,o.engine.i18n("ui.max.prompt.absolute"),o.engine.i18n("ui.max.build.prompt",[n,o.renderAbsolute(i.max,e.selected)]),o.renderAbsolute(i.max),o.engine.i18n("ui.max.build.promptExplainer")).then(c=>{if(c!==void 0){if(c===""||c.startsWith("-")){i.max=-1;return}c==="0"&&(i.enabled=!1),i.max=o.parseAbsolute(c)??i.max}}).then(()=>{u.refreshUi()}).catch(x(console))},u=new ji(o,i,e,n,{delimiter:a,onCheck:()=>{o.engine.imessage("status.sub.enable",[n]),i.max===0&&l()},onUnCheck:()=>{o.engine.imessage("status.sub.disable",[n])},onRefresh:()=>{u.maxButton.inactive=!i.enabled||i.max===-1,u.maxButton.ineffective=t.enabled&&i.enabled&&i.max===0,u.triggerButton.inactive=!i.enabled||i.trigger===-1,u.triggerButton.ineffective=t.enabled&&i.enabled&&t.trigger===-1&&i.trigger===-1},onRefreshMax:()=>{u.maxButton.updateLabel(o.renderAbsolute(i.max)),u.maxButton.element[0].title=i.max<0?o.engine.i18n("ui.max.build.titleInfinite",[n]):i.max===0?o.engine.i18n("ui.max.build.titleZero",[n]):o.engine.i18n("ui.max.build.title",[o.renderAbsolute(i.max),n])},onRefreshTrigger:()=>{u.triggerButton.element[0].title=o.engine.i18n("ui.trigger",[i.trigger<0?t.trigger<0?o.engine.i18n("ui.trigger.build.blocked",[s]):`${o.renderPercentage(t.trigger,e.selected,!0)} (${o.engine.i18n("ui.trigger.build.inherited")})`:o.renderPercentage(i.trigger,e.selected,!0)])},onSetMax:l,onSetTrigger:()=>{T.prompt(o,o.engine.i18n("ui.trigger.prompt.percentage"),o.engine.i18n("ui.trigger.build.prompt",[n,i.trigger!==-1?o.renderPercentage(i.trigger,e.selected,!0):o.engine.i18n("ui.trigger.build.inherited")]),i.trigger!==-1?o.renderPercentage(i.trigger):"",o.engine.i18n("ui.trigger.build.promptExplainer")).then(c=>{if(c!==void 0){if(c===""||c.startsWith("-")){i.trigger=-1;return}i.trigger=o.parsePercentage(c)}}).then(()=>{u.refreshUi()}).catch(x(console))},upgradeIndicator:r});return u}};class oe extends J{constructor(e,t,n,s){super(e,s);g(this,"element");g(this,"readOnly");g(this,"inactive");const a=$("<div/>",{html:`<svg style="width: 18px; height: 18px;" viewBox="0 -960 960 960" fill="currentColor"><path d="${t}"/></svg>`,title:n}).addClass(_.iconButton);this.element=a,this.addChildren(s==null?void 0:s.children),this.readOnly=(s==null?void 0:s.readOnly)??!1,this.inactive=(s==null?void 0:s.inactive)??!1,this.element.on("click",()=>{this.click()})}click(){this.readOnly||super.click()}refreshUi(){super.refreshUi(),this.readOnly?this.element.addClass(_.readonly):this.element.removeClass(_.readonly),this.inactive?this.element.addClass(_.inactive):this.element.removeClass(_.inactive)}}const Tt={listContainer:"_listContainer_1kxbq_1",itemsList:"_itemsList_1kxbq_5",list:"_list_1kxbq_1",listTools:"_listTools_1kxbq_9"};class C extends J{constructor(e,t={}){super(e,{...t,children:[]});g(this,"element");g(this,"list");g(this,"disableAllButton");g(this,"enableAllButton");g(this,"resetButton");const n={hasDisableAll:!0,hasEnableAll:!0,...t},s=n.hasDisableAll||n.hasEnableAll||!m(n.onReset),a=$("<div/>").addClass(Tt.listContainer);if(this.list=$("<ul/>").addClass(Tt.list).addClass(Tt.itemsList),a.append(this.list),s){const r=$("<div/>").addClass(Tt.listTools);if(n.hasEnableAll){const u=t.onEnableAll;this.enableAllButton=new oe(this._host,M.CheckboxCheck,e.engine.i18n("ui.enable.all"),{onClick:()=>{const c=new Event("enableAll",{cancelable:!0});if(this.dispatchEvent(c),!c.defaultPrevented){for(const h of this.children)I(h,S)&&h.check();m(u)||u(),this.refreshUi()}}}),r.append(this.enableAllButton.element)}if(n.hasDisableAll){const u=t.onDisableAll;this.disableAllButton=new oe(this._host,M.CheckboxUnCheck,e.engine.i18n("ui.disable.all")),this.disableAllButton.element.on("click",()=>{const c=new Event("disableAll",{cancelable:!0});if(this.dispatchEvent(c),!c.defaultPrevented){for(const h of this.children)I(h,S)&&h.uncheck();m(u)||u(),this.refreshUi()}}),r.append(this.disableAllButton.element)}const l=n.onReset;m(l)||(this.resetButton=new oe(this._host,M.Reset,e.engine.i18n("ui.reset"),{onClick:()=>{l()}}),r.append(this.resetButton.element)),a.append(r)}this.element=a,this.addChildren(t.children)}addChild(e){this.children.add(e),this.list.append(e.element)}}const Pe={expandoButton:"_expandoButton_l1ukp_1",expanded:"_expanded_l1ukp_1",up:"_up_l1ukp_1",down:"_down_l1ukp_4"};class Xi extends J{constructor(e,t){super(e,t);g(this,"element");g(this,"ineffective");const n=$("<div/>",{html:`
      <svg style="width: 18px; height: 18px;" viewBox="0 -960 960 960" fill="currentColor" class="${Pe.down}"><path d="${M.ExpandCircleDown}"/></svg>
      <svg style="width: 18px; height: 18px;" viewBox="0 -960 960 960" fill="currentColor" class="${Pe.up}"><path d="${M.ExpandCircleUp}"/></svg>
      `,title:e.engine.i18n("ui.itemsShow")}).addClass(_.iconButton).addClass(Pe.expandoButton);this.element=n,this.addChildren(t==null?void 0:t.children),this.ineffective=!1}setCollapsed(){this.element.removeClass(Pe.expanded),this.element.prop("title",this._host.engine.i18n("ui.itemsShow"))}setExpanded(){this.element.addClass(Pe.expanded),this.element.prop("title",this._host.engine.i18n("ui.itemsHide"))}refreshUi(){super.refreshUi(),this.ineffective?this.element.addClass(_.ineffective):this.element.removeClass(_.ineffective)}}class Me extends J{constructor(e,t,n){super(e,n);g(this,"container");g(this,"element");g(this,"_expando");g(this,"_head");g(this,"_mainChildVisible");g(this,"parent");this.container=new R(e),this.container.element.addClass(L.panelContent),this.children.add(this.container),this._head=t,this.children.add(t);const s=new Xi(e);s.element.on("click",()=>{this.toggle()}),t.head.addChild(s),t.element.append(this.container.element),n!=null&&n.initiallyExpanded?(this.container.element.removeClass(L.hidden),s.setExpanded()):this.container.element.addClass(L.hidden),this._mainChildVisible=(n==null?void 0:n.initiallyExpanded)??!1,this.element=t.element,this.addChildren(n==null?void 0:n.children),this._expando=s}get expando(){return this._expando}get isExpanded(){return this._mainChildVisible}addChild(e){this.children.add(e),this.container.element.append(e.element)}toggle(e=void 0,t=!1){const n=e!==void 0?e:!this._mainChildVisible;if(n!==this._mainChildVisible&&(this._mainChildVisible=n,this._mainChildVisible?(this.container.refreshUi(),this.container.element.removeClass(L.hidden),this._expando.setExpanded(),this._head.element.addClass(L.expanded),this.dispatchEvent(new CustomEvent("panelShown"))):(this.container.element.addClass(L.hidden),this._expando.setCollapsed(),this._head.element.removeClass(L.expanded),this.dispatchEvent(new CustomEvent("panelHidden")))),t){const s=a=>{for(const r of a)I(r,Me)?r.toggle(e,t):s(r.children)};s(this.children)}}}class z extends Me{constructor(e,t,n,s){super(e,n,s);g(this,"setting");g(this,"settingItem");this.settingItem=n,this.setting=t}get isExpanded(){return this._mainChildVisible}get elementLabel(){return this._head.element}get head(){return this._head}get readOnly(){return!0}set readOnly(e){}check(){this.setting.enabled=!0,this.refreshUi()}uncheck(){this.setting.enabled=!1,this.refreshUi()}}class Bs extends z{constructor(i,e,t){const n=i.engine.i18n("ui.upgrade.buildings");super(i,e,new S(i,e,n,{childrenHead:[new R(i,{classes:[E.fillSpace]})],onCheck:()=>{i.engine.imessage("status.auto.enable",[n])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[n])}}),t);const s=[];for(const r of Object.values(this.setting.buildings)){const l=i.engine.i18n(`$buildings.${r.upgrade}.label`),u=new S(i,r,l,{onCheck:()=>{i.engine.imessage("status.sub.enable",[l])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[l])}});s.push({label:l,button:u})}s.sort((r,l)=>r.label.localeCompare(l.label));const a=new C(i);for(const r of s)a.addChild(r.button);this.addChild(a)}}class F extends S{constructor(e,t,n,s,a){super(e,t,s,a);g(this,"triggerButton");this.triggerButton=new Ct(e,t,n,{alignment:"right",border:!1,onClick:a!=null&&a.onSetTrigger?()=>{var r;return(r=a.onSetTrigger)==null?void 0:r.call(a,this)}:void 0,onRefreshTitle:a!=null&&a.onRefreshTrigger?()=>{var r;return(r=a.onRefreshTrigger)==null?void 0:r.call(a,this)}:void 0}),this.head.addChild(new R(e,{classes:[E.fillSpace]})),this.head.addChild(this.triggerButton)}refreshUi(){super.refreshUi(),this.triggerButton.refreshUi()}}class Ps extends z{constructor(i,e,t){const n=i.engine.i18n("ui.build");super(i,e,new F(i,e,t,n,{onCheck:()=>{i.engine.imessage("status.auto.enable",[n])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[n])},onRefresh:s=>{s.triggerButton.inactive=!e.enabled||e.trigger<0},onRefreshTrigger:s=>{s.triggerButton.element[0].title=i.engine.i18n("ui.trigger.section",[e.trigger<0?i.engine.i18n("ui.trigger.section.inactive"):i.renderPercentage(e.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[n,e.trigger!==-1?i.renderPercentage(e.trigger,t.selected,!0):i.engine.i18n("ui.infinity")]),e.trigger!==-1?i.renderPercentage(e.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(s=>{if(s!==void 0){if(s===""||s.startsWith("-")){e.trigger=-1;return}e.trigger=i.parsePercentage(s)}}).then(()=>{this.refreshUi()}).catch(x(console))}})),this.addChildren([new C(i,{children:xe(i.game.bld.buildingGroups.flatMap(s=>[new q(i,s.title),...s.buildings.flatMap(a=>this._getBuildOptions(i,e,t,n,a)),s!==i.game.bld.buildingGroups[i.game.bld.buildingGroups.length-1]?new ie(i):void 0])),onReset:()=>{this.setting.load({buildings:new Zt().buildings}),this.refreshUi()}}),new C(i,{children:[new q(i,i.engine.i18n("ui.additional")),new S(i,e.gatherCatnip,i.engine.i18n("option.catnip"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.catnip")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.catnip")])}}),new S(i,e.turnOnSteamworks,i.engine.i18n("option.steamworks"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.steamworks")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.steamworks")])}}),new S(i,e.turnOnMagnetos,i.engine.i18n("option.magnetos"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.magnetos")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.magnetos")])}}),new S(i,e.turnOnReactors,i.engine.i18n("option.reactors"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.reactors")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.reactors")])}}),new Bs(i,e.upgradeBuildings)],hasDisableAll:!1,hasEnableAll:!1})])}_getBuildOptions(i,e,t,n,s){var r;if(s==="unicornPasture"||m(e.buildings[s]))return[];const a=i.game.bld.getBuildingExt(s).meta;if(!m(a.stages)){const l=(r=Object.values(e.buildings).find(u=>u.baseBuilding===s))==null?void 0:r.building;return[le.getBuildOption(i,e.buildings[s],t,e,a.stages[0].label,n),le.getBuildOption(i,e.buildings[l],t,e,a.stages[1].label,n,!1,!0)]}return m(a.label)?[]:[le.getBuildOption(i,e.buildings[s],t,e,a.label,n)]}}class Us extends S{constructor(e,t){const n=Y(e.engine.i18n("ui.engine"));super(e,t,n,{childrenHead:[new R(e,{classes:[E.fillSpace]})],onCheck:()=>{e.engine.start(!0)},onUnCheck:()=>{e.engine.stop(!0)}});g(this,"expando");this.expando=new Xi(e),this.head.addChild(this.expando)}}class Jt extends ve{constructor(e,t,n={}){super(e,{...n,children:[]});g(this,"button");this.button=t,this.element.addClass(St.head),this.element.append(t.element),this.addChildren(n.children)}refreshUi(){super.refreshUi(),this.button.refreshUi()}}const Is={fieldset:"_fieldset_tfwil_1"};class Ls extends J{constructor(e,t,n){super(e,n);g(this,"element");const s=$("<fieldset/>").addClass(Is.fieldset);n!=null&&n.delimiter&&s.addClass(_e.delimiter);const a=$("<legend/>").text(t).addClass(E.label);s.append(a),this.element=s,this.addChildren(n==null?void 0:n.children)}}class $s extends J{constructor(e,t,n,s,a){super(e,a);g(this,"setting");g(this,"option");g(this,"element");g(this,"input");g(this,"readOnly");const r=$("<div/>");r.addClass(L.setting),(a==null?void 0:a.delimiter)===!0&&r.addClass(_e.delimiter);const l=$("<label/>",{text:`${a!=null&&a.upgradeIndicator?"⮤ ":""}${n.label}`}).addClass(E.label),u=$("<input/>",{name:s,type:"radio"}).addClass("ks-radio");this.readOnly=(a==null?void 0:a.readOnly)??!1,u.on("change",()=>{this.setting.selected=n.value,m(a==null?void 0:a.onCheck)||a.onCheck()}),l.prepend(u),r.append(l),this.input=u,this.element=r,this.addChildren(a==null?void 0:a.children),this.setting=t,this.option=n}refreshUi(){super.refreshUi(),this.input.prop("disabled",this.readOnly)}}class Yt extends J{constructor(e,t,n,s){super(e,s);g(this,"fieldset");g(this,"setting");g(this,"element");g(this,"_items");this.element=$("<li/>"),this.fieldset=new Ls(e,t),this.addChild(this.fieldset),this._items=new Array;for(const a of n.options)this._items.push(new $s(e,n,a,t,{onCheck:s==null?void 0:s.onCheck,readOnly:s==null?void 0:s.readOnly}));this.fieldset.addChildren(this._items),this.setting=n}refreshUi(){super.refreshUi();for(const e of this._items)if(e.option.value===this.setting.selected){e.input.prop("checked",!0);break}}}const Os={textButton:"_textButton_1mv97_1"};class Ue extends J{constructor(e,t,n){super(e,n);g(this,"element");g(this,"readOnly");const s=$("<div/>").addClass(Os.textButton);t!==void 0&&s.text(t);const a=n==null?void 0:n.title;m(a)||s.prop("title",a),this.element=s,this.addChildren(n==null?void 0:n.children),this.readOnly=!1,this.element.on("click",()=>{this.click()})}click(){this.readOnly||super.click()}refreshUi(){super.refreshUi(),this.readOnly?this.element.addClass(_.readonly):this.element.removeClass(_.readonly)}}class Ds extends z{constructor(i,e,t){super(i,e,new ye(i,i.engine.i18n("ui.internals"),{childrenHead:[new R(i,{classes:[E.fillSpace]})],classes:[L.checked,L.setting],icon:M.Settings}),{children:[new C(i,{children:[new Jt(i,new Ue(i,i.engine.i18n("ui.internals.interval",[e.interval]),{onClick:()=>{T.prompt(i,i.engine.i18n("ui.internals.interval.prompt"),i.engine.i18n("ui.internals.interval.promptTitle",[i.renderAbsolute(e.interval,t.selected)]),i.renderAbsolute(e.interval),i.engine.i18n("ui.internals.interval.promptExplainer")).then(n=>{n===void 0||n===""||n.startsWith("-")||(n==="0"&&(e.enabled=!1),e.interval=i.parseAbsolute(n)??e.interval)}).then(()=>{this.refreshUi()}).catch(x(console))},onRefresh:n=>{n.element.text(i.engine.i18n("ui.internals.interval",[e.interval]))}})),new ie(i),new S(i,e.ksColumn,i.engine.i18n("ui.ksColumn"),{onCheck:()=>{i.rebuildUi()},onUnCheck:()=>{i.rebuildUi()}}),new ie(i),new Yt(i,i.engine.i18n("ui.language"),e.locale,{onCheck:()=>{i.rebuildUi()}}),new ie(i),new ye(i,`Kitten Scientists ${Ie("v")}`)],hasDisableAll:!1,hasEnableAll:!1})]})}}class Ns extends J{constructor(e,t,n){super(e);g(this,"element");const s=$("<li/>",{text:e.engine.i18n(t)}).addClass(Zi.explainer);this.element=s,this.addChildren(n==null?void 0:n.children)}}class qs extends z{constructor(i,e){const t=i.engine.i18n("ui.filter");super(i,e,new S(i,e,t,{childrenHead:[new R(i,{classes:[E.fillSpace]})],onCheck:()=>{i.engine.imessage("status.auto.enable",[t])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[t])}})),this.addChild(new C(i,{children:[new S(i,e.disableKGLog,i.engine.i18n("filter.allKG"))],hasDisableAll:!1,hasEnableAll:!1}));const n=new C(i,{children:Wi.map(s=>({name:s,label:i.engine.i18n(`filter.${s}`)})).sort((s,a)=>s.label.localeCompare(a.label)).map(s=>new S(i,this.setting.filters[s.name],s.label,{onCheck:()=>{i.engine.imessage("filter.enable",[s.label])},onUnCheck:()=>{i.engine.imessage("filter.disable",[s.label])}}))});this.addChild(n),this.addChild(new Ns(i,"filter.explainer"))}}const Et={active:"_active_6c09s_16"};class zs extends z{constructor(e,t,n){const s=e.engine.i18n("ui.faith");super(e,t,new F(e,t,n,s,{onCheck:()=>{e.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s])},onRefresh:r=>{r.triggerButton.inactive=!t.enabled||t.trigger===-1},onRefreshTrigger:r=>{r.triggerButton.element[0].title=e.engine.i18n("ui.trigger.section",[t.trigger<0?e.engine.i18n("ui.trigger.section.inactive"):e.renderPercentage(t.trigger,n.selected,!0)])},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.prompt.percentage"),e.engine.i18n("ui.trigger.section.prompt",[s,t.trigger!==-1?e.renderPercentage(t.trigger,n.selected,!0):e.engine.i18n("ui.infinity")]),t.trigger!==-1?e.renderPercentage(t.trigger):"",e.engine.i18n("ui.trigger.section.promptExplainer")).then(r=>{if(r!==void 0){if(r===""||r.startsWith("-")){t.trigger=-1;return}t.trigger=e.parsePercentage(r)}}).then(()=>{this.refreshUi()}).catch(x(console))}}));g(this,"_unicornBuildings");g(this,"_bestUnicornBuilding");const a=[...bt];this._unicornBuildings=new Map([["unicornPasture",le.getBuildOption(e,this.setting.buildings.unicornPasture,n,this.setting,e.engine.i18n("$buildings.unicornPasture.label"),s)],...e.game.religion.zigguratUpgrades.filter(r=>a.includes(r.name)&&!m(this.setting.buildings[r.name])).map(r=>[r.name,le.getBuildOption(e,this.setting.buildings[r.name],n,this.setting,r.label,s)])]),this._bestUnicornBuilding=new S(e,this.setting.bestUnicornBuilding,e.engine.i18n("option.faith.best.unicorn"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.faith.best.unicorn")]);for(const r of this._unicornBuildings.values())r.setting.enabled=!0,r.setting.max=-1,r.setting.trigger=-1;this.refreshUi()},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.faith.best.unicorn")]),this.refreshUi()},upgradeIndicator:!0}),this.addChildren([new C(e,{children:[new q(e,e.engine.i18n("$religion.panel.ziggurat.label")),...this._unicornBuildings.values(),this._bestUnicornBuilding,new ie(e),...e.game.religion.zigguratUpgrades.filter(r=>!a.includes(r.name)&&!m(this.setting.buildings[r.name])).map(r=>le.getBuildOption(e,this.setting.buildings[r.name],n,this.setting,r.label,s)),new ie(e),new q(e,e.engine.i18n("$religion.panel.orderOfTheSun.label")),...e.game.religion.religionUpgrades.filter(r=>!m(this.setting.buildings[r.name])).map(r=>{var l;return le.getBuildOption(e,this.setting.buildings[r.name],n,this.setting,r.label,s,r.name===((l=e.game.religion.religionUpgrades.at(-1))==null?void 0:l.name))}),new q(e,e.engine.i18n("$religion.panel.cryptotheology.label")),...e.game.religion.transcendenceUpgrades.filter(r=>!m(this.setting.buildings[r.name])).map(r=>le.getBuildOption(e,this.setting.buildings[r.name],n,this.setting,r.label,s))],onEnableAll:()=>{this.refreshUi()},onDisableAll:()=>{this.refreshUi()},onReset:()=>{const r=new Kt;this.setting.load({buildings:r.buildings,bestUnicornBuilding:r.bestUnicornBuilding}),this.refreshUi()}}),new C(e,{children:[new q(e,e.engine.i18n("ui.additional")),...Dn.map(r=>{const l=e.engine.i18n(`option.faith.${r}`);if(r==="transcend")return new S(e,this.setting[r],l,{onCheck:()=>{e.engine.imessage("status.sub.enable",[l])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[l])}});const u=new F(e,this.setting[r],n,l,{classes:[_.lastHeadAction],onCheck:()=>{e.engine.imessage("status.sub.enable",[l])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[l])},onRefresh:c=>{c.triggerButton.inactive=!this.setting[r].enabled||this.setting[r].trigger===-1},onSetTrigger:()=>{T.prompt(e,e.engine.i18n(u.triggerButton.behavior==="integer"?"ui.trigger.setinteger":"ui.trigger.setpercentage",[l]),e.engine.i18n("ui.trigger.build.prompt",[l,u.triggerButton.behavior==="integer"?e.renderAbsolute(this.setting[r].trigger,n.selected):e.renderPercentage(this.setting[r].trigger,n.selected,!0)]),u.triggerButton.behavior==="integer"?e.renderAbsolute(this.setting[r].trigger):e.renderPercentage(this.setting[r].trigger),e.engine.i18n(u.triggerButton.behavior==="integer"?"ui.trigger.setinteger.promptExplainer":"ui.trigger.setpercentage.promptExplainer")).then(c=>{c===void 0||c===""||c.startsWith("-")||(this.setting[r].trigger=(u.triggerButton.behavior==="integer"?e.parseAbsolute(c):e.parsePercentage(c))??this.setting[r].trigger)}).then(()=>{this.refreshUi()}).catch(x(console))}});return u.triggerButton.element.addClass(_.lastHeadAction),u})],hasDisableAll:!1,hasEnableAll:!1})])}refreshUi(){for(const[e,t]of this._unicornBuildings.entries())t.readOnly=this._bestUnicornBuilding.setting.enabled,t.maxButton.readOnly=this._bestUnicornBuilding.setting.enabled,t.triggerButton.readOnly=this._bestUnicornBuilding.setting.enabled,t.elementLabel.attr("data-ks-active-from","❊"),t.elementLabel.attr("data-ks-active-to","✮"),this.setting.bestUnicornBuilding.enabled&&this.setting.bestUnicornBuildingCurrent===e?t.elementLabel.addClass(Et.active):t.elementLabel.removeClass(Et.active);super.refreshUi()}}class Ws extends Q{constructor(e,t,n,s,a){super(e,"",M.DataUsage,{...a,onClick:()=>{T.prompt(e,e.engine.i18n("resources.consume.prompt"),e.engine.i18n("resources.consume.promptTitle",[s,e.renderPercentage(t.consume,n.selected,!0)]),e.renderPercentage(t.consume),e.engine.i18n("resources.consume.promptExplainer")).then(r=>{r!==void 0&&(r===""||r.startsWith("-")||(t.consume=e.parsePercentage(r)))}).then(()=>{this.refreshUi(),a!=null&&a.onClick&&a.onClick(this)}).catch(x(console))}});g(this,"setting");g(this,"resourceName");this.element.addClass(_.consumeButton),this.resourceName=s,this.setting=t}refreshUi(){super.refreshUi();const e=this._host.renderPercentage(this.setting.consume,this._host.engine.settings.locale.selected,!0),t=this.setting.consume===0?this._host.engine.i18n("resources.consume.titleZero",[this.resourceName]):this._host.engine.i18n("resources.consume.title",[e,this.resourceName]);this.updateTitle(t)}}class Hs extends Q{constructor(e,t,n,s,a){super(e,"",null,{...a,onClick:()=>{T.prompt(e,e.engine.i18n("resources.stock.prompt"),e.engine.i18n("resources.stock.promptTitle",[s,e.renderAbsolute(t.stock,n.selected)]),e.renderAbsolute(t.stock),e.engine.i18n("resources.stock.promptExplainer")).then(r=>{if(r!==void 0){if(r===""||r.startsWith("-")){t.stock=-1;return}r==="0"&&(t.enabled=!1),t.stock=e.parseAbsolute(r)??t.stock}}).then(()=>{this.refreshUi(),a!=null&&a.onClick&&a.onClick(this)}).catch(x(console))}});g(this,"setting");g(this,"resourceName");this.element.addClass(_.stockButton),this.resourceName=s,this.setting=t}refreshUi(){super.refreshUi();const e=this._host.renderAbsolute(this.setting.stock),t=this.setting.stock<0?this._host.engine.i18n("resources.stock.titleInfinite",[this.resourceName]):this.setting.stock===0?this._host.engine.i18n("resources.stock.titleZero",[this.resourceName]):this._host.engine.i18n("resources.stock.title",[this._host.renderAbsolute(this.setting.stock),this.resourceName]);this.updateTitle(t),this.updateLabel(e)}}class Fs extends z{constructor(i,e,t,n){const s=i.engine.i18n("ui.resources");super(i,e,new ye(i,s,{childrenHead:[new R(i,{classes:[E.fillSpace]})],classes:[L.checked,L.setting],icon:M.Resources}),n);const a=["blackcoin","burnedParagon","elderBox","gflops","hashrates","kittens","paragon","temporalFlux","wrappingPaper","zebras"];this.addChild(new C(i,{children:i.game.resPool.resources.filter(r=>!a.includes(r.name)&&!m(this.setting.resources[r.name])).sort((r,l)=>r.title.localeCompare(l.title,t.selected)).map(r=>[this.setting.resources[r.name],Y(r.title)]).map(([r,l])=>this._makeResourceSetting(i,r,t,l))}))}_makeResourceSetting(i,e,t,n){const s=new S(i,e,n,{childrenHead:[new R(i,{classes:[E.fillSpace]})],onCheck:()=>{i.engine.imessage("status.resource.enable",[n])},onUnCheck:()=>{i.engine.imessage("status.resource.disable",[n])}}),a=new Hs(i,e,t,n,{alignment:"right",border:!1,classes:[_.headAction],onRefresh:()=>{a.inactive=!e.enabled||e.stock===0}});s.head.addChild(a);const r=new Ws(i,e,t,n,{border:!1,classes:[_.lastHeadAction],onRefresh:()=>{r.inactive=!e.enabled||e.consume!==100,r.ineffective=e.enabled&&e.consume===0}});return s.head.addChild(r),s}}class Gs extends z{constructor(i,e,t,n,s){const a=i.engine.i18n("ui.upgrade.policies");super(i,e,new S(i,e,a,{childrenHead:[new R(i,{classes:[E.fillSpace]})],onCheck:()=>{var c;i.engine.imessage("status.auto.enable",[a]),this.refreshUi(),(c=s==null?void 0:s.onCheck)==null||c.call(s)},onUnCheck:()=>{var c;i.engine.imessage("status.auto.disable",[a]),this.refreshUi(),(c=s==null?void 0:s.onUnCheck)==null||c.call(s)},onRefresh:c=>{this.expando.ineffective=n.enabled&&e.enabled&&!Object.values(e.policies).some(h=>h.enabled)}}),s);const r=i.game.science.policies.filter(c=>!m(this.setting.policies[c.name])),l=[];let u=r[0].label;for(const c of r.sort((h,d)=>h.label.localeCompare(d.label,t.selected))){const h=this.setting.policies[c.name],d=new S(i,h,c.label,{onCheck:()=>{i.engine.imessage("status.sub.enable",[c.label]),this.refreshUi()},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[c.label]),this.refreshUi()}});i.engine.localeSupportsFirstLetterSplits(t.selected)&&u[0]!==c.label[0]&&d.element.addClass(E.splitter),l.push(d),u=c.label}this.addChild(new C(i,{children:l}))}}class Zs extends z{constructor(i,e,t,n,s){const a=i.engine.i18n("ui.upgrade.techs");super(i,e,new F(i,e,t,a,{onCheck:()=>{var c;i.engine.imessage("status.auto.enable",[a]),this.refreshUi(),(c=s==null?void 0:s.onCheck)==null||c.call(s)},onUnCheck:()=>{var c;i.engine.imessage("status.auto.disable",[a]),this.refreshUi(),(c=s==null?void 0:s.onUnCheck)==null||c.call(s)},onRefresh:c=>{const h=c;h.triggerButton.inactive=!e.enabled||e.trigger===-1,h.triggerButton.ineffective=n.enabled&&e.enabled&&e.trigger===-1&&!Object.values(e.techs).some(d=>d.enabled&&0<=d.trigger),this.expando.ineffective=n.enabled&&e.enabled&&!Object.values(e.techs).some(d=>d.enabled)},onRefreshTrigger:c=>{c.triggerButton.element[0].title=i.engine.i18n("ui.trigger",[e.trigger<0?i.engine.i18n("ui.trigger.section.inactive"):i.renderPercentage(e.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[a,e.trigger!==-1?i.renderPercentage(e.trigger,t.selected,!0):i.engine.i18n("ui.infinity")]),e.trigger!==-1?i.renderPercentage(e.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(c=>{if(c!==void 0){if(c===""||c.startsWith("-")){e.trigger=-1;return}e.trigger=i.parsePercentage(c)}}).then(()=>{this.refreshUi()}).catch(x(console))}}),s);const r=i.game.science.techs.filter(c=>!m(this.setting.techs[c.name])),l=[];let u=r[0].label;for(const c of r.sort((h,d)=>h.label.localeCompare(d.label,t.selected))){const h=this.setting.techs[c.name],d=new F(i,h,t,c.label,{onCheck:()=>{i.engine.imessage("status.sub.enable",[c.label]),this.refreshUi()},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[c.label]),this.refreshUi()},onRefresh:()=>{d.triggerButton.inactive=!h.enabled||h.trigger===-1,d.triggerButton.ineffective=n.enabled&&e.enabled&&h.enabled&&e.trigger===-1&&h.trigger===-1},onRefreshTrigger:()=>{d.triggerButton.element[0].title=i.engine.i18n("ui.trigger",[h.trigger<0?e.trigger<0?i.engine.i18n("ui.trigger.section.blocked",[a]):`${i.renderPercentage(e.trigger,t.selected,!0)} (${i.engine.i18n("ui.trigger.section.inherited")})`:i.renderPercentage(h.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[a,h.trigger!==-1?i.renderPercentage(h.trigger,t.selected,!0):i.engine.i18n("ui.trigger.section.inherited")]),h.trigger!==-1?i.renderPercentage(h.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(f=>{if(f!==void 0){if(f===""||f.startsWith("-")){h.trigger=-1;return}h.trigger=i.parsePercentage(f)}}).then(()=>{this.refreshUi()}).catch(x(console))}});d.triggerButton.element.addClass(_.lastHeadAction),i.engine.localeSupportsFirstLetterSplits(t.selected)&&u[0]!==c.label[0]&&d.element.addClass(E.splitter),l.push(d),u=c.label}this.addChild(new C(i,{children:l}))}}class Ks extends z{constructor(e,t,n){const s=e.engine.i18n("ui.upgrade");super(e,t,new S(e,t,s,{childrenHead:[new R(e,{classes:[E.fillSpace]})],onCheck:()=>{e.engine.imessage("status.auto.enable",[s]),this.refreshUi()},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s]),this.refreshUi()},onRefresh:r=>{this.expando.ineffective=t.enabled&&!t.policies.enabled&&!t.techs.enabled&&!t.observe.enabled}}));g(this,"_policiesUi");g(this,"_techsUi");g(this,"_observeStars");this._policiesUi=new Gs(e,t.policies,n,t,{onCheck:()=>{this.refreshUi()},onUnCheck:()=>{this.refreshUi()}}),this._techsUi=new Zs(e,t.techs,n,t,{onCheck:()=>{this.refreshUi()},onUnCheck:()=>{this.refreshUi()}}),this._observeStars=new S(e,this.setting.observe,e.engine.i18n("option.observe"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.observe")]),this.refreshUi()},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.observe")]),this.refreshUi()}});const a=new C(e,{hasDisableAll:!1,hasEnableAll:!1});a.addChildren([this._techsUi,this._policiesUi,this._observeStars]),this.addChild(a)}refreshUi(){super.refreshUi(),this.setting.observe.enabled?$("#observeButton").hide():$("#observeButton").show()}}class Vs extends z{constructor(e,t,n){const s=e.engine.i18n("ui.upgrade.missions");super(e,t,new S(e,t,s,{childrenHead:[new R(e,{classes:[E.fillSpace]})],onCheck:()=>{e.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s])}}),n);g(this,"_missions");this._missions=e.game.space.programs.filter(r=>!m(this.setting.missions[r.name])).map(r=>new S(e,this.setting.missions[r.name],r.label,{onCheck:()=>{e.engine.imessage("status.sub.enable",[r.label])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[r.label])}}));const a=new C(e,{children:this._missions});this.addChild(a)}}class js extends z{constructor(e,t,n){const s=e.engine.i18n("ui.space");super(e,t,new F(e,t,n,s,{onCheck:()=>{e.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s])},onRefresh:r=>{r.triggerButton.inactive=!t.enabled||t.trigger===-1},onRefreshTrigger:r=>{r.triggerButton.element[0].title=e.engine.i18n("ui.trigger.section",[t.trigger<0?e.engine.i18n("ui.trigger.section.inactive"):e.renderPercentage(t.trigger,n.selected,!0)])},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.prompt.percentage"),e.engine.i18n("ui.trigger.section.prompt",[s,t.trigger!==-1?e.renderPercentage(t.trigger,n.selected,!0):e.engine.i18n("ui.infinity")]),t.trigger!==-1?e.renderPercentage(t.trigger):"",e.engine.i18n("ui.trigger.section.promptExplainer")).then(r=>{if(r!==void 0){if(r===""||r.startsWith("-")){t.trigger=-1;return}t.trigger=e.parsePercentage(r)}}).then(()=>{this.refreshUi()}).catch(x(console))}}));g(this,"_missionsUi");this.addChild(new C(e,{children:e.game.space.planets.filter(r=>0<r.buildings.length).flatMap((r,l,u)=>[new q(e,e.engine.labelForPlanet(r.name)),...r.buildings.filter(c=>!m(this.setting.buildings[c.name])).map((c,h,d)=>le.getBuildOption(e,this.setting.buildings[c.name],n,this.setting,c.label,s,l<u.length-1&&h===d.length-1))]),onReset:()=>{this.setting.load({buildings:new kt().buildings}),this.refreshUi()}}));const a=new C(e,{hasDisableAll:!1,hasEnableAll:!1});a.addChild(new q(e,e.engine.i18n("ui.additional"))),this._missionsUi=new Vs(e,this.setting.unlockMissions),a.addChild(this._missionsUi),this.addChild(a)}}const Mt=43200,Ji=1440,Yi=Symbol.for("constructDateFrom");function Qt(o,i){return typeof o=="function"?o(i):o&&typeof o=="object"&&Yi in o?o[Yi](i):o instanceof Date?new o.constructor(i):new Date(i)}function Xs(o){return Qt(o,Date.now())}const Js={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ys=(o,i,e)=>{let t;const n=Js[o];return typeof n=="string"?t=n:i===1?t=n.one:t=n.other.replace("{{count}}",i.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+t:t+" ago":t};function ne(o){return(i={})=>{const e=i.width?String(i.width):o.defaultWidth;return o.formats[e]||o.formats[o.defaultWidth]}}const Qs={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ea={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ta={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ia={date:ne({formats:Qs,defaultWidth:"full"}),time:ne({formats:ea,defaultWidth:"full"}),dateTime:ne({formats:ta,defaultWidth:"full"})},na={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sa=(o,i,e,t)=>na[o];function K(o){return(i,e)=>{const t=e!=null&&e.context?String(e.context):"standalone";let n;if(t==="formatting"&&o.formattingValues){const a=o.defaultFormattingWidth||o.defaultWidth,r=e!=null&&e.width?String(e.width):a;n=o.formattingValues[r]||o.formattingValues[a]}else{const a=o.defaultWidth,r=e!=null&&e.width?String(e.width):o.defaultWidth;n=o.values[r]||o.values[a]}const s=o.argumentCallback?o.argumentCallback(i):i;return n[s]}}const aa={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ra={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},la={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},oa={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ca={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ua={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ga={ordinalNumber:(o,i)=>{const e=Number(o),t=e%100;if(t>20||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},era:K({values:aa,defaultWidth:"wide"}),quarter:K({values:ra,defaultWidth:"wide",argumentCallback:o=>o-1}),month:K({values:la,defaultWidth:"wide"}),day:K({values:oa,defaultWidth:"wide"}),dayPeriod:K({values:ca,defaultWidth:"wide",formattingValues:ua,defaultFormattingWidth:"wide"})};function V(o){return(i,e={})=>{const t=e.width,n=t&&o.matchPatterns[t]||o.matchPatterns[o.defaultMatchWidth],s=i.match(n);if(!s)return null;const a=s[0],r=t&&o.parsePatterns[t]||o.parsePatterns[o.defaultParseWidth],l=Array.isArray(r)?ha(r,h=>h.test(a)):da(r,h=>h.test(a));let u;u=o.valueCallback?o.valueCallback(l):l,u=e.valueCallback?e.valueCallback(u):u;const c=i.slice(a.length);return{value:u,rest:c}}}function da(o,i){for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)&&i(o[e]))return e}function ha(o,i){for(let e=0;e<o.length;e++)if(i(o[e]))return e}function Rt(o){return(i,e={})=>{const t=i.match(o.matchPattern);if(!t)return null;const n=t[0],s=i.match(o.parsePattern);if(!s)return null;let a=o.valueCallback?o.valueCallback(s[0]):s[0];a=e.valueCallback?e.valueCallback(a):a;const r=i.slice(n.length);return{value:a,rest:r}}}const ma=/^(\d+)(th|st|nd|rd)?/i,fa=/\d+/i,pa={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ba={any:[/^b/i,/^(a|c)/i]},va={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ya={any:[/1/i,/2/i,/3/i,/4/i]},ka={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},wa={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_a={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Sa={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},xa={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ca={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ta={ordinalNumber:Rt({matchPattern:ma,parsePattern:fa,valueCallback:o=>parseInt(o,10)}),era:V({matchPatterns:pa,defaultMatchWidth:"wide",parsePatterns:ba,defaultParseWidth:"any"}),quarter:V({matchPatterns:va,defaultMatchWidth:"wide",parsePatterns:ya,defaultParseWidth:"any",valueCallback:o=>o+1}),month:V({matchPatterns:ka,defaultMatchWidth:"wide",parsePatterns:wa,defaultParseWidth:"any"}),day:V({matchPatterns:_a,defaultMatchWidth:"wide",parsePatterns:Sa,defaultParseWidth:"any"}),dayPeriod:V({matchPatterns:xa,defaultMatchWidth:"any",parsePatterns:Ca,defaultParseWidth:"any"})},Qi={code:"en-US",formatDistance:Ys,formatLong:ia,formatRelative:sa,localize:ga,match:Ta,options:{weekStartsOn:0,firstWeekContainsDate:1}};let Ea={};function en(){return Ea}function he(o,i){return Qt(i||o,o)}function tn(o){const i=he(o),e=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return e.setUTCFullYear(i.getFullYear()),+o-+e}function At(o,...i){const e=Qt.bind(null,o||i.find(t=>typeof t=="object"));return i.map(e)}function Bt(o,i){const e=+he(o)-+he(i);return e<0?-1:e>0?1:e}function Ma(o,i,e){const[t,n]=At(e==null?void 0:e.in,o,i),s=t.getFullYear()-n.getFullYear(),a=t.getMonth()-n.getMonth();return s*12+a}function Ra(o,i){const e=he(o,i==null?void 0:i.in);return e.setHours(23,59,59,999),e}function Aa(o,i){const e=he(o,i==null?void 0:i.in),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Ba(o,i){const e=he(o,i==null?void 0:i.in);return+Ra(e,i)==+Aa(e,i)}function Pa(o,i,e){const[t,n,s]=At(e==null?void 0:e.in,o,o,i),a=Bt(n,s),r=Math.abs(Ma(n,s));if(r<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*r);let l=Bt(n,s)===-a;Ba(t)&&r===1&&Bt(t,s)===1&&(l=!1);const u=a*(r-+l);return u===0?0:u}function Ua(o){return i=>{const t=(o?Math[o]:Math.trunc)(i);return t===0?0:t}}function Ia(o,i){return+he(o)-+he(i)}function La(o,i,e){const t=Ia(o,i)/1e3;return Ua(e==null?void 0:e.roundingMethod)(t)}function $a(o,i,e){const t=en(),n=(e==null?void 0:e.locale)??t.locale??Qi,s=2520,a=Bt(o,i);if(isNaN(a))throw new RangeError("Invalid time value");const r=Object.assign({},e,{addSuffix:e==null?void 0:e.addSuffix,comparison:a}),[l,u]=At(e==null?void 0:e.in,...a>0?[i,o]:[o,i]),c=La(u,l),h=(tn(u)-tn(l))/1e3,d=Math.round((c-h)/60);let f;if(d<2)return e!=null&&e.includeSeconds?c<5?n.formatDistance("lessThanXSeconds",5,r):c<10?n.formatDistance("lessThanXSeconds",10,r):c<20?n.formatDistance("lessThanXSeconds",20,r):c<40?n.formatDistance("halfAMinute",0,r):c<60?n.formatDistance("lessThanXMinutes",1,r):n.formatDistance("xMinutes",1,r):d===0?n.formatDistance("lessThanXMinutes",1,r):n.formatDistance("xMinutes",d,r);if(d<45)return n.formatDistance("xMinutes",d,r);if(d<90)return n.formatDistance("aboutXHours",1,r);if(d<Ji){const b=Math.round(d/60);return n.formatDistance("aboutXHours",b,r)}else{if(d<s)return n.formatDistance("xDays",1,r);if(d<Mt){const b=Math.round(d/Ji);return n.formatDistance("xDays",b,r)}else if(d<Mt*2)return f=Math.round(d/Mt),n.formatDistance("aboutXMonths",f,r)}if(f=Pa(u,l),f<12){const b=Math.round(d/Mt);return n.formatDistance("xMonths",b,r)}else{const b=f%12,p=Math.trunc(f/12);return b<3?n.formatDistance("aboutXYears",p,r):b<9?n.formatDistance("overXYears",p,r):n.formatDistance("almostXYears",p+1,r)}}function nn(o,i){return $a(o,Xs(o),i)}function sn(o,i){var r,l,u,c;const e=en(),t=(i==null?void 0:i.weekStartsOn)??((l=(r=i==null?void 0:i.locale)==null?void 0:r.options)==null?void 0:l.weekStartsOn)??e.weekStartsOn??((c=(u=e.locale)==null?void 0:u.options)==null?void 0:c.weekStartsOn)??0,n=he(o,i==null?void 0:i.in),s=n.getDay(),a=(s<t?7:0)+s-t;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function Oa(o,i,e){const[t,n]=At(e==null?void 0:e.in,o,i);return+sn(t,e)==+sn(n,e)}const an={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},Da=(o,i,e)=>{let t;const n=e!=null&&e.addSuffix?an[o].withPreposition:an[o].standalone;return typeof n=="string"?t=n:i===1?t=n.one:t=n.other.replace("{{count}}",String(i)),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+t:"vor "+t:t},Na={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},qa={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},za={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},Wa={date:ne({formats:Na,defaultWidth:"full"}),time:ne({formats:qa,defaultWidth:"full"}),dateTime:ne({formats:za,defaultWidth:"full"})},Ha={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},Fa=(o,i,e,t)=>Ha[o],Ga={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},Za={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},ei={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},Ka={narrow:ei.narrow,abbreviated:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:ei.wide},Va={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},ja={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},Xa={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},Ja={ordinalNumber:o=>Number(o)+".",era:K({values:Ga,defaultWidth:"wide"}),quarter:K({values:Za,defaultWidth:"wide",argumentCallback:o=>o-1}),month:K({values:ei,formattingValues:Ka,defaultWidth:"wide"}),day:K({values:Va,defaultWidth:"wide"}),dayPeriod:K({values:ja,defaultWidth:"wide",formattingValues:Xa,defaultFormattingWidth:"wide"})},Ya=/^(\d+)(\.)?/i,Qa=/\d+/i,er={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},tr={any:[/^v/i,/^n/i]},ir={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},nr={any:[/1/i,/2/i,/3/i,/4/i]},sr={narrow:/^[jfmasond]/i,abbreviated:/^(j[aä]n|feb|mär[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},ar={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[aä]/i,/^f/i,/^mär/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},rr={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},lr={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},or={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},cr={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},ur={ordinalNumber:Rt({matchPattern:Ya,parsePattern:Qa,valueCallback:o=>parseInt(o)}),era:V({matchPatterns:er,defaultMatchWidth:"wide",parsePatterns:tr,defaultParseWidth:"any"}),quarter:V({matchPatterns:ir,defaultMatchWidth:"wide",parsePatterns:nr,defaultParseWidth:"any",valueCallback:o=>o+1}),month:V({matchPatterns:sr,defaultMatchWidth:"wide",parsePatterns:ar,defaultParseWidth:"any"}),day:V({matchPatterns:rr,defaultMatchWidth:"wide",parsePatterns:lr,defaultParseWidth:"any"}),dayPeriod:V({matchPatterns:or,defaultMatchWidth:"wide",parsePatterns:cr,defaultParseWidth:"any"})},gr={code:"de",formatDistance:Da,formatLong:Wa,formatRelative:Fa,localize:Ja,match:ur,options:{weekStartsOn:1,firstWeekContainsDate:4}},dr={lessThanXSeconds:{one:"פחות משנייה",two:"פחות משתי שניות",other:"פחות מ־{{count}} שניות"},xSeconds:{one:"שנייה",two:"שתי שניות",other:"{{count}} שניות"},halfAMinute:"חצי דקה",lessThanXMinutes:{one:"פחות מדקה",two:"פחות משתי דקות",other:"פחות מ־{{count}} דקות"},xMinutes:{one:"דקה",two:"שתי דקות",other:"{{count}} דקות"},aboutXHours:{one:"כשעה",two:"כשעתיים",other:"כ־{{count}} שעות"},xHours:{one:"שעה",two:"שעתיים",other:"{{count}} שעות"},xDays:{one:"יום",two:"יומיים",other:"{{count}} ימים"},aboutXWeeks:{one:"כשבוע",two:"כשבועיים",other:"כ־{{count}} שבועות"},xWeeks:{one:"שבוע",two:"שבועיים",other:"{{count}} שבועות"},aboutXMonths:{one:"כחודש",two:"כחודשיים",other:"כ־{{count}} חודשים"},xMonths:{one:"חודש",two:"חודשיים",other:"{{count}} חודשים"},aboutXYears:{one:"כשנה",two:"כשנתיים",other:"כ־{{count}} שנים"},xYears:{one:"שנה",two:"שנתיים",other:"{{count}} שנים"},overXYears:{one:"יותר משנה",two:"יותר משנתיים",other:"יותר מ־{{count}} שנים"},almostXYears:{one:"כמעט שנה",two:"כמעט שנתיים",other:"כמעט {{count}} שנים"}},hr=(o,i,e)=>{if(o==="xDays"&&(e!=null&&e.addSuffix)&&i<=2)return e.comparison&&e.comparison>0?i===1?"מחר":"מחרתיים":i===1?"אתמול":"שלשום";let t;const n=dr[o];return typeof n=="string"?t=n:i===1?t=n.one:i===2?t=n.two:t=n.other.replace("{{count}}",String(i)),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"בעוד "+t:"לפני "+t:t},mr={full:"EEEE, d בMMMM y",long:"d בMMMM y",medium:"d בMMM y",short:"d.M.y"},fr={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},pr={full:"{{date}} 'בשעה' {{time}}",long:"{{date}} 'בשעה' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},br={date:ne({formats:mr,defaultWidth:"full"}),time:ne({formats:fr,defaultWidth:"full"}),dateTime:ne({formats:pr,defaultWidth:"full"})},vr={lastWeek:"eeee 'שעבר בשעה' p",yesterday:"'אתמול בשעה' p",today:"'היום בשעה' p",tomorrow:"'מחר בשעה' p",nextWeek:"eeee 'בשעה' p",other:"P"},yr=(o,i,e,t)=>vr[o],kr={narrow:["לפנה״ס","לספירה"],abbreviated:["לפנה״ס","לספירה"],wide:["לפני הספירה","לספירה"]},wr={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["רבעון 1","רבעון 2","רבעון 3","רבעון 4"]},_r={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["ינו׳","פבר׳","מרץ","אפר׳","מאי","יוני","יולי","אוג׳","ספט׳","אוק׳","נוב׳","דצמ׳"],wide:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"]},Sr={narrow:["א׳","ב׳","ג׳","ד׳","ה׳","ו׳","ש׳"],short:["א׳","ב׳","ג׳","ד׳","ה׳","ו׳","ש׳"],abbreviated:["יום א׳","יום ב׳","יום ג׳","יום ד׳","יום ה׳","יום ו׳","שבת"],wide:["יום ראשון","יום שני","יום שלישי","יום רביעי","יום חמישי","יום שישי","יום שבת"]},xr={narrow:{am:"לפנה״צ",pm:"אחה״צ",midnight:"חצות",noon:"צהריים",morning:"בוקר",afternoon:"אחר הצהריים",evening:"ערב",night:"לילה"},abbreviated:{am:"לפנה״צ",pm:"אחה״צ",midnight:"חצות",noon:"צהריים",morning:"בוקר",afternoon:"אחר הצהריים",evening:"ערב",night:"לילה"},wide:{am:"לפנה״צ",pm:"אחה״צ",midnight:"חצות",noon:"צהריים",morning:"בוקר",afternoon:"אחר הצהריים",evening:"ערב",night:"לילה"}},Cr={narrow:{am:"לפנה״צ",pm:"אחה״צ",midnight:"חצות",noon:"צהריים",morning:"בבוקר",afternoon:"בצהריים",evening:"בערב",night:"בלילה"},abbreviated:{am:"לפנה״צ",pm:"אחה״צ",midnight:"חצות",noon:"צהריים",morning:"בבוקר",afternoon:"אחר הצהריים",evening:"בערב",night:"בלילה"},wide:{am:"לפנה״צ",pm:"אחה״צ",midnight:"חצות",noon:"צהריים",morning:"בבוקר",afternoon:"אחר הצהריים",evening:"בערב",night:"בלילה"}},Tr={ordinalNumber:(o,i)=>{const e=Number(o);if(e<=0||e>10)return String(e);const t=String(i==null?void 0:i.unit),n=["year","hour","minute","second"].indexOf(t)>=0,s=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שביעי","שמיני","תשיעי","עשירי"],a=["ראשונה","שנייה","שלישית","רביעית","חמישית","שישית","שביעית","שמינית","תשיעית","עשירית"],r=e-1;return n?a[r]:s[r]},era:K({values:kr,defaultWidth:"wide"}),quarter:K({values:wr,defaultWidth:"wide",argumentCallback:o=>o-1}),month:K({values:_r,defaultWidth:"wide"}),day:K({values:Sr,defaultWidth:"wide"}),dayPeriod:K({values:xr,defaultWidth:"wide",formattingValues:Cr,defaultFormattingWidth:"wide"})},Er=/^(\d+|(ראשון|שני|שלישי|רביעי|חמישי|שישי|שביעי|שמיני|תשיעי|עשירי|ראשונה|שנייה|שלישית|רביעית|חמישית|שישית|שביעית|שמינית|תשיעית|עשירית))/i,Mr=/^(\d+|רא|שנ|של|רב|ח|שי|שב|שמ|ת|ע)/i,Rr={narrow:/^ל(ספירה|פנה״ס)/i,abbreviated:/^ל(ספירה|פנה״ס)/i,wide:/^ל(פני ה)?ספירה/i},Ar={any:[/^לפ/i,/^לס/i]},Br={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^רבעון [1234]/i},Pr={any:[/1/i,/2/i,/3/i,/4/i]},Ur={narrow:/^\d+/i,abbreviated:/^(ינו|פבר|מרץ|אפר|מאי|יוני|יולי|אוג|ספט|אוק|נוב|דצמ)׳?/i,wide:/^(ינואר|פברואר|מרץ|אפריל|מאי|יוני|יולי|אוגוסט|ספטמבר|אוקטובר|נובמבר|דצמבר)/i},Ir={narrow:[/^1$/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^7/i,/^8/i,/^9/i,/^10/i,/^11/i,/^12/i],any:[/^ינ/i,/^פ/i,/^מר/i,/^אפ/i,/^מא/i,/^יונ/i,/^יול/i,/^אוג/i,/^ס/i,/^אוק/i,/^נ/i,/^ד/i]},Lr={narrow:/^[אבגדהוש]׳/i,short:/^[אבגדהוש]׳/i,abbreviated:/^(שבת|יום (א|ב|ג|ד|ה|ו)׳)/i,wide:/^יום (ראשון|שני|שלישי|רביעי|חמישי|שישי|שבת)/i},$r={abbreviated:[/א׳$/i,/ב׳$/i,/ג׳$/i,/ד׳$/i,/ה׳$/i,/ו׳$/i,/^ש/i],wide:[/ן$/i,/ני$/i,/לישי$/i,/עי$/i,/מישי$/i,/שישי$/i,/ת$/i],any:[/^א/i,/^ב/i,/^ג/i,/^ד/i,/^ה/i,/^ו/i,/^ש/i]},Or={any:/^(אחר ה|ב)?(חצות|צהריים|בוקר|ערב|לילה|אחה״צ|לפנה״צ)/i},Dr={any:{am:/^לפ/i,pm:/^אחה/i,midnight:/^ח/i,noon:/^צ/i,morning:/בוקר/i,afternoon:/בצ|אחר/i,evening:/ערב/i,night:/לילה/i}},Nr=["רא","שנ","של","רב","ח","שי","שב","שמ","ת","ע"],qr={ordinalNumber:Rt({matchPattern:Er,parsePattern:Mr,valueCallback:o=>{const i=parseInt(o,10);return isNaN(i)?Nr.indexOf(o)+1:i}}),era:V({matchPatterns:Rr,defaultMatchWidth:"wide",parsePatterns:Ar,defaultParseWidth:"any"}),quarter:V({matchPatterns:Br,defaultMatchWidth:"wide",parsePatterns:Pr,defaultParseWidth:"any",valueCallback:o=>o+1}),month:V({matchPatterns:Ur,defaultMatchWidth:"wide",parsePatterns:Ir,defaultParseWidth:"any"}),day:V({matchPatterns:Lr,defaultMatchWidth:"wide",parsePatterns:$r,defaultParseWidth:"any"}),dayPeriod:V({matchPatterns:Or,defaultMatchWidth:"any",parsePatterns:Dr,defaultParseWidth:"any"})},zr={code:"he",formatDistance:hr,formatLong:br,formatRelative:yr,localize:Tr,match:qr,options:{weekStartsOn:0,firstWeekContainsDate:1}},Wr={lessThanXSeconds:{one:"不到 1 秒",other:"不到 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分钟",lessThanXMinutes:{one:"不到 1 分钟",other:"不到 {{count}} 分钟"},xMinutes:{one:"1 分钟",other:"{{count}} 分钟"},xHours:{one:"1 小时",other:"{{count}} 小时"},aboutXHours:{one:"大约 1 小时",other:"大约 {{count}} 小时"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大约 1 个星期",other:"大约 {{count}} 个星期"},xWeeks:{one:"1 个星期",other:"{{count}} 个星期"},aboutXMonths:{one:"大约 1 个月",other:"大约 {{count}} 个月"},xMonths:{one:"1 个月",other:"{{count}} 个月"},aboutXYears:{one:"大约 1 年",other:"大约 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超过 1 年",other:"超过 {{count}} 年"},almostXYears:{one:"将近 1 年",other:"将近 {{count}} 年"}},Hr=(o,i,e)=>{let t;const n=Wr[o];return typeof n=="string"?t=n:i===1?t=n.one:t=n.other.replace("{{count}}",String(i)),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?t+"内":t+"前":t},Fr={full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},Gr={full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},Zr={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},Kr={date:ne({formats:Fr,defaultWidth:"full"}),time:ne({formats:Gr,defaultWidth:"full"}),dateTime:ne({formats:Zr,defaultWidth:"full"})};function rn(o,i,e){const t="eeee p";return Oa(o,i,e)?t:o.getTime()>i.getTime()?"'下个'"+t:"'上个'"+t}const Vr={lastWeek:rn,yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:rn,other:"PP p"},jr=(o,i,e,t)=>{const n=Vr[o];return typeof n=="function"?n(i,e,t):n},Xr={narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},Jr={narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},Yr={narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},Qr={narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["周日","周一","周二","周三","周四","周五","周六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},el={narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},tl={narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},il={ordinalNumber:(o,i)=>{const e=Number(o);switch(i==null?void 0:i.unit){case"date":return e.toString()+"日";case"hour":return e.toString()+"时";case"minute":return e.toString()+"分";case"second":return e.toString()+"秒";default:return"第 "+e.toString()}},era:K({values:Xr,defaultWidth:"wide"}),quarter:K({values:Jr,defaultWidth:"wide",argumentCallback:o=>o-1}),month:K({values:Yr,defaultWidth:"wide"}),day:K({values:Qr,defaultWidth:"wide"}),dayPeriod:K({values:el,defaultWidth:"wide",formattingValues:tl,defaultFormattingWidth:"wide"})},nl=/^(第\s*)?\d+(日|时|分|秒)?/i,sl=/\d+/i,al={narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},rl={any:[/^(前)/i,/^(公元)/i]},ll={narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},ol={any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},cl={narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},ul={narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},gl={narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},dl={any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},hl={any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},ml={any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},fl={ordinalNumber:Rt({matchPattern:nl,parsePattern:sl,valueCallback:o=>parseInt(o,10)}),era:V({matchPatterns:al,defaultMatchWidth:"wide",parsePatterns:rl,defaultParseWidth:"any"}),quarter:V({matchPatterns:ll,defaultMatchWidth:"wide",parsePatterns:ol,defaultParseWidth:"any",valueCallback:o=>o+1}),month:V({matchPatterns:cl,defaultMatchWidth:"wide",parsePatterns:ul,defaultParseWidth:"any"}),day:V({matchPatterns:gl,defaultMatchWidth:"wide",parsePatterns:dl,defaultParseWidth:"any"}),dayPeriod:V({matchPatterns:hl,defaultMatchWidth:"any",parsePatterns:ml,defaultParseWidth:"any"})},pl={code:"zh-CN",formatDistance:Hr,formatLong:Kr,formatRelative:jr,localize:il,match:fl,options:{weekStartsOn:1,firstWeekContainsDate:4}};class bl{constructor(i){g(this,"_game");this._game=i}load(i){return new Promise((e,t)=>{if(i===null){e();return}this._game.saveImportDropboxText(i,n=>{if(n){t(n);return}e()})})}loadRaw(i){const e=this._game.compressLZData(JSON.stringify(i));return this.load(e)}}class ti extends ve{constructor(e,t,n){super(e,n);g(this,"buttons");this.element.addClass(Vi.toolbar),this.buttons=t;for(const s of t)this.element.append(s.element)}refreshUi(){super.refreshUi();for(const e of this.buttons)e.refreshUi()}}class vl extends z{constructor(e,t,n){const s=e.engine.i18n("state.title");super(e,t,new ye(e,s,{childrenHead:[new R(e,{classes:[E.fillSpace]})],classes:[L.checked,L.setting],icon:M.State}));g(this,"games",new Array);g(this,"states",new Array);g(this,"gameList");g(this,"stateList");g(this,"locale");this.gameList=new C(e,{hasEnableAll:!1,hasDisableAll:!1}),this.stateList=new C(e,{hasEnableAll:!1,hasDisableAll:!1}),this.locale=n.selected==="zh-CN"?pl:n.selected==="he-IL"?zr:n.selected==="de-DE"?gr:Qi,this.addChild(new C(e,{children:[new S(e,this.setting.noConfirm,e.engine.i18n("state.noConfirm")),new ve(e,{children:[new ie(e)]}),new q(e,e.engine.i18n("state.local")),new ti(e,[new Q(e,e.engine.i18n("state.import"),M.Import,{onClick:()=>{this.import()},title:e.engine.i18n("state.importTitle")})]),new ve(e,{children:[new ie(e)]}),new q(e,e.engine.i18n("state.localStates")),new ti(e,[new Q(e,e.engine.i18n("state.store"),M.SaveAs,{onClick:()=>{this.storeState()},title:e.engine.i18n("state.storeState")}),new Q(e,e.engine.i18n("copy"),M.Copy,{onClick:()=>{this.copyState().catch(x(console)),e.engine.imessage("state.copied.stateCurrent")},title:e.engine.i18n("state.copy.stateCurrent")}),new Q(e,e.engine.i18n("state.new"),M.Draft,{onClick:()=>{this.storeStateFactoryDefaults(),e.engine.imessage("state.stored.state")},title:e.engine.i18n("state.storeFactory")}),new Q(e,e.engine.i18n("state.exportAll"),M.Sync,{onClick:()=>{this.exportStateAll()},title:e.engine.i18n("state.exportAllTitle")})]),new ve(e,{children:[this.stateList]}),new ve(e,{children:[new ie(e)]}),new q(e,e.engine.i18n("state.localGames")),new ti(e,[new Q(e,e.engine.i18n("state.store"),M.SaveAs,{onClick:()=>{this.storeGame(),e.engine.imessage("state.stored.game")},title:e.engine.i18n("state.storeGame")}),new Q(e,e.engine.i18n("copy"),M.Copy,{onClick:()=>{this.copyGame().catch(x(console)),e.engine.imessage("state.copied.gameCurrent")},title:e.engine.i18n("state.copy.gameCurrent")})]),new ve(e,{children:[this.gameList]}),new S(e,this.setting.compress,e.engine.i18n("state.compress"))],hasDisableAll:!1,hasEnableAll:!1})),this._loadGames(),this._loadStates()}_loadGames(){let e=0,t=localStorage.getItem(`ks.game.${e}`);this.games.splice(0);try{for(;!m(t);){const n=JSON.parse(t);this.games.push(new mt(n)),t=localStorage.getItem(`ks.game.${++e}`)}}catch(n){ge(n)}}_storeGames(){let e=0,t=localStorage.getItem(`ks.game.${e}`);for(;!m(t);)localStorage.removeItem(`ks.game.${e}`),t=localStorage.getItem(`ks.game.${++e}`);e=0;for(const n of this.games)localStorage.setItem(`ks.game.${e++}`,JSON.stringify(n))}_loadStates(){let e=0,t=localStorage.getItem(`ks.state.${e}`);this.states.splice(0);try{for(;!m(t);){const n=JSON.parse(t);me.unknownAsEngineStateOrThrow(n.state),this.states.push(new mt(n)),t=localStorage.getItem(`ks.state.${++e}`)}}catch(n){ge(n)}}_storeStates(){let e=0,t=localStorage.getItem(`ks.state.${e}`);for(;!m(t);)localStorage.removeItem(`ks.state.${e}`),t=localStorage.getItem(`ks.state.${++e}`);e=0;for(const n of this.states)localStorage.setItem(`ks.state.${e++}`,JSON.stringify(n))}refreshUi(){super.refreshUi(),this._refreshGameList(),this._refreshStateList()}_refreshGameList(){this.gameList.removeChildren(this.gameList.children),this.gameList.addChildren(this.games.sort((e,t)=>new Date(e.unwrap().timestamp).getTime()-new Date(t.unwrap().timestamp).getTime()).map(e=>[e.unwrap(),e]).map(([e,t])=>new Jt(this._host,new Ue(this._host,`${e.label} (${nn(new Date(e.timestamp),{addSuffix:!0,locale:this.locale})})`,{onClick:()=>{this.loadGame(e.game).catch(x(console)),this._host.engine.imessage("state.loaded.game",[e.label])},title:new Date(e.timestamp).toLocaleString()}),{children:[new R(this._host,{classes:[E.fillSpace]}),new oe(this._host,M.Save,this._host.engine.i18n("state.update.game"),{onClick:()=>{this.updateGame(t,this._host.game.save()),this._host.engine.imessage("state.updated.game",[e.label])}}),new oe(this._host,M.Edit,this._host.engine.i18n("state.edit.game"),{onClick:()=>{this.storeGame(e.game),this.deleteGame(t,!0),this._host.engine.imessage("state.updated.game",[e.label])}}),new oe(this._host,M.Copy,this._host.engine.i18n("state.copy.game"),{onClick:()=>{this.copyGame(e.game).catch(x(console)),this._host.engine.imessage("state.copied.game",[e.label])}}),new oe(this._host,M.Delete,this._host.engine.i18n("state.delete.game"),{onClick:()=>{this.deleteGame(t),this._host.engine.imessage("state.deleted.game",[e.label])}})]})))}_refreshStateList(){this.stateList.removeChildren(this.stateList.children),this.stateList.addChildren(this.states.sort((e,t)=>new Date(e.unwrap().timestamp).getTime()-new Date(t.unwrap().timestamp).getTime()).map(e=>[e.unwrap(),e]).map(([e,t])=>new Jt(this._host,new Ue(this._host,`${e.label} (${nn(new Date(e.timestamp),{addSuffix:!0,locale:this.locale})})`,{onClick:()=>{this.loadState(e.state),this._host.engine.imessage("state.loaded.state",[e.label])},title:new Date(e.timestamp).toLocaleString()}),{children:[new R(this._host,{classes:[E.fillSpace]}),new oe(this._host,M.Save,this._host.engine.i18n("state.update.state"),{onClick:()=>{this.updateState(t,this._host.engine.stateSerialize()),this._host.engine.imessage("state.updated.state",[e.label])}}),new oe(this._host,M.Edit,this._host.engine.i18n("state.edit.state"),{onClick:()=>{this.storeState(e.state),this.deleteState(t,!0),this._host.engine.imessage("state.updated.state",[e.label])}}),new oe(this._host,M.Copy,this._host.engine.i18n("state.copy.state"),{onClick:()=>{this.copyState(e.state).catch(x(console)),this._host.engine.imessage("state.copied.state",[e.label])}}),new oe(this._host,M.Delete,this._host.engine.i18n("state.delete.state"),{onClick:()=>{this.deleteState(t),this._host.engine.imessage("state.deleted.state",[e.label])}})]})))}async copyState(e){await this._host.copySettings(e,!1)}async copyGame(e){const t=e??this._host.game.save(),n=JSON.stringify(t),s=this.setting.compress.enabled?this._host.game.compressLZData(n):n;await window.navigator.clipboard.writeText(s)}import(){const e=window.prompt(this._host.engine.i18n("state.loadPrompt"));if(m(e))return;try{const s=me.decodeSettings(e);this.storeState(s),this._host.engine.imessage("state.imported.state");return}catch{}let t;try{t=JSON.parse(e)}catch{const a=this._host.game.decompressLZData(e);t=JSON.parse(a)}let n;if("ks"in t&&!m(t.ks)){const s=t.ks.state[0];n=this.storeState(s)??void 0,this._host.engine.imessage("state.imported.state"),t.ks=void 0}this.storeGame(t,n),this._host.engine.imessage("state.imported.game")}storeGame(e,t){let n=t;return m(n)&&(n=window.prompt(this._host.engine.i18n("state.storeGame.prompt"))??void 0),m(n)?null:(n=(n===""?void 0:n)??this._host.engine.i18n("state.unlabeledGame"),n=n.substring(0,127),this.games.push(new mt({label:n,game:e??this._host.game.save(),timestamp:new Date().toISOString()})),this._storeGames(),this.refreshUi(),n)}storeState(e,t){let n=t;return m(n)&&(n=window.prompt(this._host.engine.i18n("state.storeState.prompt"))??void 0),m(n)?null:(n=(n===""?void 0:n)??this._host.engine.i18n("state.unlabeledState"),n=n.substring(0,127),this.states.push(new mt({label:n,state:e??this._host.engine.stateSerialize(),timestamp:new Date().toISOString()})),this._storeStates(),this.refreshUi(),n)}storeStateFactoryDefaults(){this.storeState(re.DEFAULT_STATE)}storeAutoSave(e){const t=this.states.find(n=>n.unwrap().label==="Auto-Save");if(!m(t)){H("Updating existing Auto-Save..."),t.replace({...t.unwrap(),state:e,timestamp:new Date().toISOString()}),this._storeStates(),this.refreshUi();return}H("Storing new Auto-Save..."),this.storeState(e,"Auto-Save")}exportStateAll(){const e=this.states.map(a=>me.encodeSettings(a.unwrap().state,!1)).join(`
`),t=document.createElement("a"),n=new Blob([e],{type:"application/x-ndjson"}),s=URL.createObjectURL(n);t.setAttribute("href",s),t.setAttribute("download",`ks-local-states-${new Date().getTime()}.ndjson`),t.click()}async loadGame(e){this._destructiveActionPrevented()||await new bl(this._host.game).loadRaw(e)}loadState(e){this._destructiveActionPrevented()||(this._host.engine.stateLoad(e,!0),this._host.refreshUi())}loadAutoSave(){if(this._host.engine.isLoaded){H("Not attempting to load Auto-Save, because a state is already loaded.");return}const e=this.states.find(t=>t.unwrap().label==="Auto-Save");if(m(e)){H("No Auto-Save settings found.");return}H("Loading Auto-Save..."),this._host.engine.stateLoad(e.unwrap().state,!1)}updateGame(e,t){if(this._destructiveActionPrevented())return;const n=e.unwrap().label;e.replace({label:n,game:t,timestamp:new Date().toISOString()}),this._storeGames(),this.refreshUi()}updateState(e,t){if(this._destructiveActionPrevented())return;const n=e.unwrap().label;e.replace({label:n,state:t,timestamp:new Date().toISOString()}),this._storeStates(),this.refreshUi()}deleteGame(e,t=!1){if(!t&&this._destructiveActionPrevented())return;const n=this.games.indexOf(e);n<0||(this.games.splice(n,1),this._storeGames(),this.refreshUi())}deleteState(e,t=!1){if(!t&&this._destructiveActionPrevented())return;const n=this.states.indexOf(e);n<0||(this.states.splice(n,1),this._storeStates(),this.refreshUi())}_destructiveActionPrevented(){return!this.setting.noConfirm.enabled&&!window.confirm(this._host.engine.i18n("state.confirmDestruction"))}}class Re extends Me{constructor(e,t,n,s){super(e,new ye(e,t,{childrenHead:s==null?void 0:s.childrenHead,icon:s==null?void 0:s.icon}),{initiallyExpanded:s==null?void 0:s.initiallyExpanded});g(this,"setting");this.setting=n}}class yl extends Re{constructor(e,t,n){var r,l;const s=e.engine.i18n("ui.build");super(e,s,t,{childrenHead:[new R(e,{classes:[E.fillSpace]})],icon:M.Bonfire});g(this,"_buildings");this._buildings=[];for(const u of e.game.bld.buildingGroups){this._buildings.push(new q(e,u.title));for(const c of u.buildings){if(c==="unicornPasture"||m(this.setting.buildings[c]))continue;const h=e.game.bld.getBuildingExt(c).meta;if(m(h.stages))m(h.label)||this._buildings.push(this._getResetOption(e,this.setting.buildings[c],n,t,h.label));else{const d=(r=Object.values(this.setting.buildings).find(f=>f.baseBuilding===c))==null?void 0:r.building;this._buildings.push(this._getResetOption(e,this.setting.buildings[c],n,t,h.stages[0].label),this._getResetOption(e,this.setting.buildings[d],n,t,h.stages[1].label,!1,!0))}}u!==e.game.bld.buildingGroups[e.game.bld.buildingGroups.length-1]&&((l=this._buildings.at(-1))==null||l.element.addClass(_e.delimiter))}const a=new C(e);a.addChildren(this._buildings),this.addChild(a)}_getResetOption(e,t,n,s,a,r=!1,l=!1){const u=new F(e,t,n,a,{delimiter:r,onCheck:()=>{e.engine.imessage("status.reset.check.enable",[a])},onUnCheck:()=>{e.engine.imessage("status.reset.check.disable",[a])},onRefresh:()=>{u.triggerButton.inactive=!t.enabled||t.trigger===-1,u.triggerButton.ineffective=s.enabled&&t.enabled&&t.trigger===-1},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.prompt.absolute"),e.engine.i18n("ui.trigger.build.prompt",[a,t.trigger!==-1?e.renderAbsolute(t.trigger,n.selected):e.engine.i18n("ui.trigger.inactive")]),t.trigger!==-1?e.renderAbsolute(t.trigger):"",e.engine.i18n("ui.trigger.reset.promptExplainer")).then(c=>{if(c!==void 0){if(c===""||c.startsWith("-")){t.trigger=-1,t.enabled=!1;return}t.trigger=Number(c)}}).then(()=>{u.refreshUi()}).catch(x(console))},upgradeIndicator:l});return u.triggerButton.element.addClass(_.lastHeadAction),u}}class kl extends Re{constructor(i,e,t){const n=i.engine.i18n("ui.faith");super(i,n,e,{childrenHead:[new R(i,{classes:[E.fillSpace]})],icon:M.Religion});const s=[...bt];this.addChild(new C(i,{children:[new q(i,i.engine.i18n("$religion.panel.ziggurat.label")),this._getResetOption(i,this.setting.buildings.unicornPasture,t,e,i.engine.i18n("$buildings.unicornPasture.label")),...i.game.religion.zigguratUpgrades.filter(a=>s.includes(a.name)&&!m(this.setting.buildings[a.name])).map(a=>this._getResetOption(i,this.setting.buildings[a.name],t,e,a.label)),new ie(i),...i.game.religion.zigguratUpgrades.filter(a=>!s.includes(a.name)&&!m(this.setting.buildings[a.name])).map(a=>this._getResetOption(i,this.setting.buildings[a.name],t,e,a.label)),new ie(i),new q(i,i.engine.i18n("$religion.panel.orderOfTheSun.label")),...i.game.religion.religionUpgrades.filter(a=>!m(this.setting.buildings[a.name])).map(a=>{var r;return this._getResetOption(i,this.setting.buildings[a.name],t,e,a.label,a.name===((r=i.game.religion.religionUpgrades.at(-1))==null?void 0:r.name))}),new q(i,i.engine.i18n("$religion.panel.cryptotheology.label")),...i.game.religion.transcendenceUpgrades.filter(a=>!m(this.setting.buildings[a.name])).map(a=>this._getResetOption(i,this.setting.buildings[a.name],t,e,a.label))]}))}_getResetOption(i,e,t,n,s,a=!1,r=!1){const l=new F(i,e,t,s,{delimiter:a,onCheck:()=>{i.engine.imessage("status.reset.check.enable",[s])},onUnCheck:()=>{i.engine.imessage("status.reset.check.disable",[s])},onRefresh:()=>{l.triggerButton.inactive=!e.enabled||e.trigger===-1,l.triggerButton.ineffective=n.enabled&&e.enabled&&e.trigger===-1},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.absolute"),i.engine.i18n("ui.trigger.build.prompt",[s,e.trigger!==-1?i.renderAbsolute(e.trigger,t.selected):i.engine.i18n("ui.trigger.inactive")]),e.trigger!==-1?i.renderAbsolute(e.trigger):"",i.engine.i18n("ui.trigger.reset.promptExplainer")).then(u=>{if(u!==void 0){if(u===""||u.startsWith("-")){e.trigger=-1,e.enabled=!1;return}e.trigger=Number(u)}}).then(()=>{l.refreshUi()}).catch(x(console))},upgradeIndicator:r});return l.triggerButton.element.addClass(_.lastHeadAction),l}}class wl extends Re{constructor(i,e,t){const n=i.engine.i18n("ui.resources");super(i,n,e,{childrenHead:[new R(i,{classes:[E.fillSpace]})],icon:M.Resources});const s=i.game.resPool.resources,a=[];let r=s[0].title;for(const l of[...s].sort((u,c)=>u.title.localeCompare(c.title,t.selected))){const u=this.setting.resources[l.name],c=new F(i,u,t,Y(l.title),{onCheck:()=>{i.engine.imessage("status.sub.enable",[l.title])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[l.title])},onRefresh:()=>{c.triggerButton.inactive=!u.enabled||u.trigger===-1,c.triggerButton.ineffective=e.enabled&&u.enabled&&u.trigger===-1},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.float"),i.engine.i18n("ui.trigger.build.prompt",[l.title,u.trigger!==-1?i.renderAbsolute(u.trigger,t.selected):i.engine.i18n("ui.trigger.inactive")]),u.trigger!==-1?i.renderAbsolute(u.trigger):"",i.engine.i18n("ui.trigger.reset.promptExplainer")).then(h=>{if(h!==void 0){if(h===""||h.startsWith("-")){u.trigger=-1,u.enabled=!1;return}u.trigger=Number(h)}}).then(()=>{c.refreshUi()}).catch(x(console))}});c.triggerButton.element.addClass(_.lastHeadAction),i.engine.localeSupportsFirstLetterSplits(t.selected)&&r[0]!==l.title[0]&&c.element.addClass(E.splitter),a.push(c),r=l.title}this.addChild(new C(i,{children:a}))}}class _l extends Re{constructor(i,e,t){const n=i.engine.i18n("ui.space");super(i,n,e,{childrenHead:[new R(i,{classes:[E.fillSpace]})],icon:M.Space}),this.addChild(new C(i,{children:i.game.space.planets.filter(s=>0<s.buildings.length).flatMap((s,a,r)=>[new q(i,i.engine.labelForPlanet(s.name)),...s.buildings.filter(l=>!m(this.setting.buildings[l.name])).map((l,u,c)=>this._getResetOption(i,this.setting.buildings[l.name],t,e,l.label,a<r.length-1&&u===c.length-1))])}))}_getResetOption(i,e,t,n,s,a=!1,r=!1){const l=new F(i,e,t,s,{delimiter:a,onCheck:()=>{i.engine.imessage("status.reset.check.enable",[s])},onUnCheck:()=>{i.engine.imessage("status.reset.check.disable",[s])},onRefresh:()=>{l.triggerButton.inactive=!e.enabled||e.trigger===-1,l.triggerButton.ineffective=n.enabled&&e.enabled&&e.trigger===-1},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.absolute"),i.engine.i18n("ui.trigger.build.prompt",[s,e.trigger!==-1?i.renderAbsolute(e.trigger,t.selected):i.engine.i18n("ui.trigger.inactive")]),e.trigger!==-1?i.renderAbsolute(e.trigger):"",i.engine.i18n("ui.trigger.reset.promptExplainer")).then(u=>{if(u!==void 0){if(u===""||u.startsWith("-")){e.trigger=-1,e.enabled=!1;return}e.trigger=Number(u)}}).then(()=>{l.refreshUi()}).catch(x(console))},upgradeIndicator:r});return l.triggerButton.element.addClass(_.lastHeadAction),l}}class Sl extends Re{constructor(i,e,t){const n=i.engine.i18n("ui.time");super(i,n,e,{childrenHead:[new R(i,{classes:[E.fillSpace]})],icon:M.Time}),this.addChild(new C(i,{children:[new q(i,i.engine.i18n("$workshop.chronoforge.label")),...i.game.time.chronoforgeUpgrades.filter(s=>!m(this.setting.buildings[s.name])).map(s=>{var a;return this._getResetOption(i,this.setting.buildings[s.name],t,e,s.label,s.name===((a=i.game.time.chronoforgeUpgrades.at(-1))==null?void 0:a.name))}),new q(i,i.engine.i18n("$science.voidSpace.label")),...i.game.time.voidspaceUpgrades.filter(s=>!m(this.setting.buildings[s.name])).map(s=>this._getResetOption(i,this.setting.buildings[s.name],t,e,s.label))]}))}_getResetOption(i,e,t,n,s,a=!1,r=!1){const l=new F(i,e,t,s,{delimiter:a,onCheck:()=>{i.engine.imessage("status.reset.check.enable",[s])},onUnCheck:()=>{i.engine.imessage("status.reset.check.disable",[s])},onRefresh:()=>{l.triggerButton.inactive=!e.enabled||e.trigger===-1,l.triggerButton.ineffective=n.enabled&&e.enabled&&e.trigger===-1},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.absolute"),i.engine.i18n("ui.trigger.build.prompt",[s,e.trigger!==-1?i.renderAbsolute(e.trigger,t.selected):i.engine.i18n("ui.trigger.inactive")]),e.trigger!==-1?i.renderAbsolute(e.trigger):"",i.engine.i18n("ui.trigger.reset.promptExplainer")).then(u=>{if(u!==void 0){if(u===""||u.startsWith("-")){e.trigger=-1,e.enabled=!1;return}e.trigger=Number(u)}}).then(()=>{l.refreshUi()}).catch(x(console))},upgradeIndicator:r});return l.triggerButton.element.addClass(_.lastHeadAction),l}}class xl extends Re{constructor(i,e,t){const n=i.engine.i18n("ui.upgrades");super(i,n,e,{childrenHead:[new R(i,{classes:[E.fillSpace]})],icon:M.Workshop});const s=i.game.workshop.upgrades.filter(u=>!m(this.setting.upgrades[u.name])),a=[];let r=s[0].label,l;for(const u of s.sort((c,h)=>c.label.localeCompare(h.label,t.selected))){const c=this.setting.upgrades[u.name],h=this._getResetOption(i,c,u.label);i.engine.localeSupportsFirstLetterSplits(t.selected)&&r[0]!==u.label[0]&&(m(l)||l.element.addClass(_e.delimiter),h.element.addClass(E.splitter)),l=h,a.push(h),r=u.label}this.addChild(new C(i,{children:a}))}_getResetOption(i,e,t,n=!1,s=!1){return new S(i,e,t,{delimiter:n,onCheck:()=>{i.engine.imessage("status.reset.check.enable",[t])},onUnCheck:()=>{i.engine.imessage("status.reset.check.disable",[t])},upgradeIndicator:s})}}class Cl extends z{constructor(e,t,n,s){const a=e.engine.i18n("option.time.reset");super(e,t,new S(e,t,a,{childrenHead:[new R(e,{classes:[E.fillSpace]})],onCheck:()=>{e.engine.imessage("status.auto.enable",[a])},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[a])}}),s);g(this,"_bonfireUi");g(this,"_religionUi");g(this,"_resourcesUi");g(this,"_spaceUi");g(this,"_timeUi");g(this,"_upgradesUi");const r=new C(e,{hasDisableAll:!1,hasEnableAll:!1});this._bonfireUi=new yl(e,this.setting.bonfire,n),this._religionUi=new kl(e,this.setting.religion,n),this._resourcesUi=new wl(e,this.setting.resources,n),this._spaceUi=new _l(e,this.setting.space,n),this._timeUi=new Sl(e,this.setting.time,n),this._upgradesUi=new xl(e,this.setting.upgrades,n),r.addChildren([this._bonfireUi,this._religionUi,this._resourcesUi,this._spaceUi,this._timeUi,this._upgradesUi]),this.addChild(r)}}class ln extends C{constructor(e,t,n){super(e,n);g(this,"setting");this.setting=t,this.addEventListener("enableAll",()=>{for(const s of this.children)s.check();this.refreshUi()}),this.addEventListener("disableAll",()=>{for(const s of this.children)s.uncheck();this.refreshUi()}),this.addChildren([this._makeCycle("charon",this.setting.charon,n),this._makeCycle("umbra",this.setting.umbra,n),this._makeCycle("yarn",this.setting.yarn,n),this._makeCycle("helios",this.setting.helios,n),this._makeCycle("cath",this.setting.cath,n),this._makeCycle("redmoon",this.setting.redmoon,n),this._makeCycle("dune",this.setting.dune,n),this._makeCycle("piscine",this.setting.piscine,n),this._makeCycle("terminus",this.setting.terminus,n),this._makeCycle("kairo",this.setting.kairo,n)])}_makeCycle(e,t,n){const s=this._host.engine.labelForCycle(e);return new S(this._host,t,s,{onCheck:()=>{var a;return(a=n==null?void 0:n.onCheck)==null?void 0:a.call(n,s,t)},onUnCheck:()=>{var a;return(a=n==null?void 0:n.onUnCheck)==null?void 0:a.call(n,s,t)}})}}class Tl extends z{constructor(i,e,t,n,s,a){const r=i.engine.i18n("option.time.activeHeatTransfer");super(i,e,new F(i,e,t,r,{onCheck:()=>{i.engine.imessage("status.auto.enable",[r])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[r]),e.activeHeatTransferStatus.enabled=!1},onRefresh:l=>{l.triggerButton.inactive=!e.enabled,l.triggerButton.ineffective=s.enabled&&n.enabled&&e.enabled&&e.trigger===-1,this.expando.ineffective=s.enabled&&n.enabled&&e.enabled&&!Object.values(e.cycles).some(u=>u.enabled),e.activeHeatTransferStatus.enabled?(this.head.elementLabel.attr("data-ks-active-from","◎"),this.head.elementLabel.attr("data-ks-active-to","◎"),this.head.elementLabel.addClass(Et.active)):this.head.elementLabel.removeClass(Et.active)},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.activeHeatTransfer.prompt"),i.engine.i18n("ui.trigger.activeHeatTransfer.promptTitle",[i.renderPercentage(e.trigger,t.selected,!0)]),i.renderPercentage(e.trigger),i.engine.i18n("ui.trigger.activeHeatTransfer.promptExplainer")).then(l=>{l===void 0||l===""||l.startsWith("-")||(e.trigger=i.parsePercentage(l))}).then(()=>{this.refreshUi()}).catch(x(console))}}),a),this.addChild(new C(i,{classes:[L.checked,L.setting],children:[new ln(i,this.setting.cycles,{onCheck:l=>{i.engine.imessage("time.heatTransfer.cycle.enable",[l]),this.refreshUi()},onUnCheck:l=>{i.engine.imessage("time.heatTransfer.cycle.disable",[l]),this.refreshUi()}})],hasDisableAll:!1,hasEnableAll:!1}))}}class on extends C{constructor(e,t,n){super(e,n);g(this,"setting");g(this,"spring");g(this,"summer");g(this,"autumn");g(this,"winter");this.setting=t,this.addEventListener("enableAll",()=>{this.autumn.check(),this.spring.check(),this.summer.check(),this.winter.check(),this.refreshUi()}),this.addEventListener("disableAll",()=>{this.autumn.uncheck(),this.spring.uncheck(),this.summer.uncheck(),this.winter.uncheck(),this.refreshUi()}),this.spring=this._makeSeason(this._host.engine.i18n("$calendar.season.spring"),this.setting.spring,n),this.summer=this._makeSeason(this._host.engine.i18n("$calendar.season.summer"),this.setting.summer,n),this.autumn=this._makeSeason(this._host.engine.i18n("$calendar.season.autumn"),this.setting.autumn,n),this.winter=this._makeSeason(this._host.engine.i18n("$calendar.season.winter"),this.setting.winter,n),this.addChildren([this.spring,this.summer,this.autumn,this.winter])}_makeSeason(e,t,n){return new S(this._host,t,e,{onCheck:()=>{var s;return(s=n==null?void 0:n.onCheck)==null?void 0:s.call(n,e,t)},onUnCheck:()=>{var s;return(s=n==null?void 0:n.onUnCheck)==null?void 0:s.call(n,e,t)}})}}class El extends z{constructor(e,t,n,s,a){const r=e.engine.i18n("option.time.skip");super(e,t,new ji(e,t,n,r,{onCheck:()=>{e.engine.imessage("status.auto.enable",[r]),this.refreshUi()},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[r]),this.refreshUi()},onRefresh:l=>{const u=l;u.maxButton.inactive=!t.enabled||t.max===-1,u.triggerButton.inactive=!t.enabled||t.trigger===-1,u.maxButton.ineffective=s.enabled&&t.enabled&&t.max===0,this._cycles.expando.ineffective=s.enabled&&t.enabled&&!Object.values(t.cycles).some(c=>c.enabled),this._seasons.expando.ineffective=s.enabled&&t.enabled&&!Object.values(t.seasons).some(c=>c.enabled)},onRefreshMax:l=>{l.maxButton.updateLabel(e.renderAbsolute(t.max)),l.maxButton.element[0].title=t.max<0?e.engine.i18n("ui.max.timeSkip.titleInfinite",[r]):t.max===0?e.engine.i18n("ui.max.timeSkip.titleZero",[r]):e.engine.i18n("ui.max.timeSkip.title",[e.renderAbsolute(t.max),r])},onRefreshTrigger:l=>{l.triggerButton.element[0].title=e.engine.i18n("ui.trigger",[t.trigger<0?e.engine.i18n("ui.trigger.section.inactive"):`${e.renderFloat(t.trigger,n.selected)} TC`])},onSetMax:()=>{T.prompt(e,e.engine.i18n("ui.max.timeSkip.prompt"),e.engine.i18n("ui.max.timeSkip.promptTitle",[e.renderAbsolute(t.max,n.selected)]),e.renderAbsolute(t.max),e.engine.i18n("ui.max.timeSkip.promptExplainer")).then(l=>{if(l!==void 0){if(l===""||l.startsWith("-")){t.max=-1;return}l==="0"&&(t.enabled=!1),t.max=e.parseAbsolute(l)??t.max}}).then(()=>{this.refreshUi()}).catch(x(console))},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.timeSkip.prompt"),e.engine.i18n("ui.trigger.timeSkip.promptTitle",[e.renderAbsolute(t.trigger,n.selected)]),e.renderAbsolute(t.trigger),e.engine.i18n("ui.trigger.timeSkip.promptExplainer")).then(l=>{l===void 0||l===""||l.startsWith("-")||(t.trigger=e.parseAbsolute(l)??t.trigger)}).then(()=>{this.refreshUi()}).catch(x(console))}}),a);g(this,"_cycles");g(this,"_seasons");g(this,"_activeHeatTransferUI");this.settingItem.triggerButton.element.removeClass(_.lastHeadAction),this._cycles=new Me(e,new ye(e,Y(e.engine.i18n("ui.cycles")),{classes:[L.checked,L.setting],childrenHead:[new R(e,{classes:[E.fillSpace]})],icon:M.Cycles}),{children:[new ln(e,this.setting.cycles,{onCheck:l=>{e.engine.imessage("time.skip.cycle.enable",[l]),this.refreshUi()},onUnCheck:l=>{e.engine.imessage("time.skip.cycle.disable",[l]),this.refreshUi()}})]}),this._seasons=new Me(e,new ye(e,Y(e.engine.i18n("trade.seasons")),{classes:[L.checked,L.setting],childrenHead:[new R(e,{classes:[E.fillSpace]})],icon:M.Seasons}),{children:[new on(e,this.setting.seasons,{onCheck:l=>{e.engine.imessage("time.skip.season.enable",[l]),this.refreshUi()},onUnCheck:l=>{e.engine.imessage("time.skip.season.disable",[l]),this.refreshUi()}})]}),this._activeHeatTransferUI=new Tl(e,this.setting.activeHeatTransfer,n,t,s),this.addChild(new C(e,{children:[this._cycles,this._seasons,new S(e,this.setting.ignoreOverheat,e.engine.i18n("option.time.skip.ignoreOverheat")),this._activeHeatTransferUI],hasDisableAll:!1,hasEnableAll:!1}))}}class Ml extends z{constructor(e,t,n){const s=e.engine.i18n("ui.timeCtrl");super(e,t,new S(e,t,s,{childrenHead:[new R(e,{classes:[E.fillSpace]})],onCheck:()=>{e.engine.imessage("status.auto.enable",[s]),this.refreshUi()},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s]),this.refreshUi()}}));g(this,"_items");g(this,"_accelerateTime");g(this,"_timeSkipUi");g(this,"_resetUi");const a=new C(e,{hasDisableAll:!1,hasEnableAll:!1}),r=e.engine.i18n("option.accelerate");this._accelerateTime=new F(e,this.setting.accelerateTime,n,r,{onCheck:()=>{e.engine.imessage("status.sub.enable",[r])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[r])},onRefresh:()=>{this._accelerateTime.triggerButton.inactive=!this.setting.accelerateTime.enabled,this._accelerateTime.triggerButton.ineffective=this.setting.enabled&&this.setting.accelerateTime.enabled&&this.setting.accelerateTime.trigger===-1},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.accelerateTime.prompt"),e.engine.i18n("ui.trigger.accelerateTime.promptTitle",[e.renderPercentage(this.setting.accelerateTime.trigger,n.selected,!0)]),e.renderPercentage(this.setting.accelerateTime.trigger),e.engine.i18n("ui.trigger.accelerateTime.promptExplainer")).then(l=>{l===void 0||l===""||l.startsWith("-")||(this.setting.accelerateTime.trigger=e.parsePercentage(l))}).then(()=>{this.refreshUi()}).catch(x(console))}}),this._accelerateTime.triggerButton.element.addClass(_.lastHeadAction),this._timeSkipUi=new El(e,this.setting.timeSkip,n,t),this._resetUi=new Cl(e,this.setting.reset,n),this._items=[this._accelerateTime,this._timeSkipUi,this._resetUi],a.addChildren(this._items),this.addChild(a)}}class Rl extends z{constructor(i,e,t){const n=i.engine.i18n("ui.time");super(i,e,new F(i,e,t,n,{onCheck:()=>{i.engine.imessage("status.auto.enable",[n])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[n])},onRefresh:s=>{s.triggerButton.inactive=!e.enabled||e.trigger===-1},onRefreshTrigger:s=>{s.triggerButton.element[0].title=i.engine.i18n("ui.trigger.section",[e.trigger<0?i.engine.i18n("ui.trigger.section.inactive"):i.renderPercentage(e.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[n,e.trigger!==-1?i.renderPercentage(e.trigger,t.selected,!0):i.engine.i18n("ui.infinity")]),e.trigger!==-1?i.renderPercentage(e.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(s=>{if(s!==void 0){if(s===""||s.startsWith("-")){e.trigger=-1;return}e.trigger=i.parsePercentage(s)}}).then(()=>{this.refreshUi()}).catch(x(console))}})),this.addChildren([new C(i,{children:[new q(i,i.engine.i18n("$workshop.chronoforge.label")),...i.game.time.chronoforgeUpgrades.filter(s=>!m(this.setting.buildings[s.name])).map(s=>{var a;return le.getBuildOption(i,this.setting.buildings[s.name],t,this.setting,s.label,n,s.name===((a=i.game.time.chronoforgeUpgrades.at(-1))==null?void 0:a.name))}),new q(i,i.engine.i18n("$science.voidSpace.label")),...i.game.time.voidspaceUpgrades.filter(s=>!m(this.setting.buildings[s.name])).map(s=>le.getBuildOption(i,this.setting.buildings[s.name],t,this.setting,s.label,n))]}),new C(i,{children:[new q(i,i.engine.i18n("ui.additional")),new S(i,this.setting.fixCryochambers,i.engine.i18n("option.fix.cry"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.fix.cry")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.fix.cry")])}})],hasDisableAll:!1,hasEnableAll:!1})])}}class cn extends S{constructor(e,t,n,s){super(e,t,n,s);g(this,"maxButton");this.maxButton=new Xt(e,t,{border:!1,onClick:s!=null&&s.onSetMax?()=>{var a;return(a=s.onSetMax)==null?void 0:a.call(s,this)}:void 0,onRefresh:s!=null&&s.onRefreshMax?()=>{var a;return(a=s.onRefreshMax)==null?void 0:a.call(s,this)}:void 0}),this.head.addChildren([new R(e,{classes:[E.fillSpace]}),this.maxButton])}refreshUi(){super.refreshUi(),this.maxButton.refreshUi()}}class Al extends z{constructor(i,e,t,n){const s=i.engine.i18n("option.embassies");super(i,e,new F(i,e,t,s,{onCheck:()=>{i.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[s])},onRefresh:r=>{r.triggerButton.inactive=!e.enabled||e.trigger===-1},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.embassies.prompt"),i.engine.i18n("ui.trigger.embassies.promptTitle",[i.renderPercentage(e.trigger,t.selected,!0)]),i.renderPercentage(e.trigger),i.engine.i18n("ui.trigger.embassies.promptExplainer")).then(r=>{r===void 0||r===""||r.startsWith("-")||(e.trigger=i.parsePercentage(r))}).then(()=>{this.refreshUi()}).catch(x(console))}}),n);const a=new C(i,{children:i.game.diplomacy.races.filter(r=>!m(this.setting.races[r.name])).map(r=>this._makeEmbassySetting(i,this.setting.races[r.name],t.selected,e,r.title))});this.addChild(a)}_makeEmbassySetting(i,e,t,n,s){const a=()=>{T.prompt(i,i.engine.i18n("ui.max.prompt.absolute"),i.engine.i18n("ui.max.build.prompt",[s,i.renderAbsolute(e.max,t)]),i.renderAbsolute(e.max),i.engine.i18n("ui.max.build.promptExplainer")).then(l=>{if(l!==void 0){if(l===""||l.startsWith("-")){e.max=-1;return}l==="0"&&(e.enabled=!1),e.max=i.parseAbsolute(l)??e.max}}).then(()=>{this.refreshUi()}).catch(x(console))},r=new cn(i,e,s,{onCheck:()=>{i.engine.imessage("status.sub.enable",[s]),e.max===0&&a()},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[s])},onRefresh:()=>{r.maxButton.inactive=!e.enabled||e.max===-1,r.maxButton.ineffective=n.enabled&&e.enabled&&e.max===0},onRefreshMax:()=>{r.maxButton.updateLabel(i.renderAbsolute(e.max)),r.maxButton.element[0].title=e.max<0?i.engine.i18n("ui.max.embassy.titleInfinite",[s]):e.max===0?i.engine.i18n("ui.max.embassy.titleZero",[s]):i.engine.i18n("ui.max.embassy.title",[i.renderAbsolute(e.max),s])},onSetMax:a});return r.maxButton.element.addClass(_.lastHeadAction),r}}class un extends Q{constructor(e,t,n){super(e,"",M.Eco,{...n,border:!1,classes:[]});g(this,"setting");this.setting=t,this.element.on("click",()=>{var s,a;this.setting.limited=!this.setting.limited,this.setting.limited?(s=n==null?void 0:n.onLimitedCheck)==null||s.call(n):(a=n==null?void 0:n.onLimitedUnCheck)==null||a.call(n),this.refreshUi()});for(const s of(n==null?void 0:n.classes)??[])this.element.addClass(s)}refreshUi(){super.refreshUi(),this.updateTitle(this._host.engine.i18n(this.setting.limited?"ui.limited.on":"ui.limited.off")),this.setting.limited&&!this.inactive?this.element.removeClass(_.inactive):this.element.addClass(_.inactive)}}class Bl extends S{constructor(e,t,n,s){super(e,t,n,s);g(this,"limitedButton");this.limitedButton=new un(e,t,{...s}),this.head.addChildren([new R(e,{classes:[E.fillSpace]}),this.limitedButton])}refreshUi(){super.refreshUi(),this.limitedButton.refreshUi()}}class Pl extends Bl{constructor(e,t,n,s,a){super(e,t,s,a);g(this,"triggerButton");this.triggerButton=new Ct(e,t,n,{border:!1,onClick:a!=null&&a.onSetTrigger?()=>{var r;return(r=a.onSetTrigger)==null?void 0:r.call(a,this)}:void 0,onRefreshTitle:a!=null&&a.onRefreshTrigger?()=>{var r;return(r=a.onRefreshTrigger)==null?void 0:r.call(a,this)}:void 0}),this.head.addChild(this.triggerButton)}refreshUi(){super.refreshUi(),this.triggerButton.refreshUi()}}const Ul={buyButton:"_buyButton_10eul_1"};class Il extends Ue{constructor(e,t,n,s={}){super(e,void 0,{onClick:()=>{T.prompt(e,e.engine.i18n("blackcoin.buy.prompt"),e.engine.i18n("blackcoin.buy.promptTitle",[e.renderAbsolute(t.buy,n.selected)]),e.renderAbsolute(t.buy),e.engine.i18n("blackcoin.buy.promptExplainer")).then(a=>{if(a!==void 0){if(a===""||a.startsWith("-")){t.buy=-1;return}t.buy=e.parseAbsolute(a)??t.buy}}).then(()=>{this.refreshUi(),s.onClick&&s.onClick()}).catch(x(console))}});g(this,"setting");this.element.addClass(Ul.buyButton),this.setting=t}refreshUi(){super.refreshUi(),this.element.prop("title",this._host.engine.i18n("blackcoin.buy.title",[this._host.renderAbsolute(this.setting.buy)])),this.element.text(this._host.engine.i18n("blackcoin.buy",[this._host.renderAbsolute(this.setting.buy)]))}}const Ll={sellButton:"_sellButton_1tmvd_1"};class $l extends Ue{constructor(e,t,n,s={}){super(e,void 0,{onClick:()=>{T.prompt(e,e.engine.i18n("blackcoin.sell.prompt"),e.engine.i18n("blackcoin.sell.promptTitle",[e.renderAbsolute(t.sell,n.selected)]),e.renderAbsolute(t.sell),e.engine.i18n("blackcoin.sell.promptExplainer")).then(a=>{if(a!==void 0){if(a===""||a.startsWith("-")){t.sell=-1;return}t.sell=e.parseAbsolute(a)??t.sell}}).then(()=>{this.refreshUi(),s.onClick&&s.onClick()}).catch(x(console))}});g(this,"setting");this.element.addClass(Ll.sellButton),this.setting=t}refreshUi(){super.refreshUi(),this.element.prop("title",this._host.engine.i18n("blackcoin.sell.title",[this._host.renderAbsolute(this.setting.sell)])),this.element.text(this._host.engine.i18n("blackcoin.sell",[this._host.renderAbsolute(this.setting.sell)]))}}class Ol extends z{constructor(i,e,t){const n=i.engine.i18n("ui.trade");super(i,e,new F(i,e,t,n,{onCheck:()=>{i.engine.imessage("status.auto.enable",[n])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[n])},onRefresh:r=>{r.triggerButton.inactive=!e.enabled||e.trigger===-1},onRefreshTrigger:r=>{r.triggerButton.element[0].title=i.engine.i18n("ui.trigger.section",[e.trigger<0?i.engine.i18n("ui.trigger.section.inactive"):i.renderPercentage(e.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[n,e.trigger!==-1?i.renderPercentage(e.trigger,t.selected,!0):i.engine.i18n("ui.infinity")]),e.trigger!==-1?i.renderPercentage(e.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(r=>{if(r!==void 0){if(r===""||r.startsWith("-")){e.trigger=-1;return}e.trigger=i.parsePercentage(r)}}).then(()=>{this.refreshUi()}).catch(x(console))}}));const s=new C(i,{children:i.game.diplomacy.races.filter(r=>!m(this.setting.races[r.name])).map(r=>{var l;return this._getTradeOption(i,this.setting.races[r.name],t,e,r.title,n,r.name===((l=i.game.diplomacy.races.at(-2))==null?void 0:l.name))}),hasDisableAll:!1,hasEnableAll:!1});s.addChild(new S(i,this.setting.feedLeviathans,i.engine.i18n("option.autofeed"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.autofeed")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.autofeed")])}})),s.addChild(new z(i,this.setting.tradeBlackcoin,new F(i,this.setting.tradeBlackcoin,t,i.engine.i18n("option.crypto"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("option.crypto")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("option.crypto")])},onRefresh:r=>{r.triggerButton.inactive=!this.setting.tradeBlackcoin.enabled||this.setting.tradeBlackcoin.trigger===-1},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.crypto.promptTitle"),i.engine.i18n("ui.trigger.crypto.prompt",[i.renderAbsolute(this.setting.tradeBlackcoin.trigger,t.selected)]),i.renderAbsolute(this.setting.tradeBlackcoin.trigger),i.engine.i18n("ui.trigger.crypto.promptExplainer")).then(r=>{r===void 0||r===""||r.startsWith("-")||(this.setting.tradeBlackcoin.trigger=i.parseAbsolute(r)??this.setting.tradeBlackcoin.trigger)}).then(()=>{this.refreshUi()}).catch(x(console))}}),{children:[new Il(i,this.setting.tradeBlackcoin,t),new $l(i,this.setting.tradeBlackcoin,t)]})),this.addChild(s);const a=new C(i,{hasDisableAll:!1,hasEnableAll:!1});a.addChild(new q(i,i.engine.i18n("ui.additional"))),a.addChild(new Al(i,this.setting.buildEmbassies,t)),a.addChild(new S(i,this.setting.unlockRaces,i.engine.i18n("ui.upgrade.races"),{onCheck:()=>{i.engine.imessage("status.sub.enable",[i.engine.i18n("ui.upgrade.races")])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[i.engine.i18n("ui.upgrade.races")])}})),this.addChild(a)}_getTradeOption(i,e,t,n,s,a,r=!1,l=!1){const u=new Pl(i,e,t,s,{onCheck:()=>{i.engine.imessage("status.sub.enable",[s])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[s])},onLimitedCheck:()=>{i.engine.imessage("trade.limited",[s])},onLimitedUnCheck:()=>{i.engine.imessage("trade.unlimited",[s])},onRefresh:()=>{u.limitedButton.inactive=!e.enabled||!e.limited,u.triggerButton.inactive=!e.enabled||e.trigger===-1,u.triggerButton.ineffective=n.enabled&&e.enabled&&n.trigger===-1&&e.trigger===-1,c.expando.ineffective=n.enabled&&e.enabled&&!e.seasons.autumn.enabled&&!e.seasons.spring.enabled&&!e.seasons.summer.enabled&&!e.seasons.winter.enabled},onRefreshTrigger:()=>{u.triggerButton.element[0].title=i.engine.i18n("ui.trigger",[e.trigger<0?n.trigger<0?i.engine.i18n("ui.trigger.section.blocked",[a]):`${i.renderPercentage(n.trigger,t.selected,!0)} (${i.engine.i18n("ui.trigger.section.inherited")})`:i.renderPercentage(e.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[s,e.trigger!==-1?i.renderPercentage(e.trigger,t.selected,!0):i.engine.i18n("ui.trigger.section.inherited")]),e.trigger!==-1?i.renderPercentage(e.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(d=>{if(d!==void 0){if(d===""||d.startsWith("-")){e.trigger=-1;return}e.trigger=i.parsePercentage(d)}}).then(()=>{u.refreshUi()}).catch(x(console))},delimiter:r,upgradeIndicator:l}),c=new z(i,e,u),h=new on(i,e.seasons,{onCheck:d=>{i.engine.imessage("trade.season.enable",[Y(d),d]),u.refreshUi()},onUnCheck:d=>{i.engine.imessage("trade.season.disable",[Y(d),d]),u.refreshUi()}});return c.addChild(h),c}}const ii={spacer:"_spacer_o1key_43",ui:"_ui_o1key_48",showActivity:"_showActivity_o1key_65"};class Dl extends z{constructor(e,t,n){const s=e.engine.i18n("ui.distribute");super(e,t,new S(e,t,s,{childrenHead:[new R(e,{classes:[E.fillSpace]})],onCheck:()=>{e.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s])}}));g(this,"_hunt");g(this,"_festivals");g(this,"_promoteKittens");g(this,"_promoteLeader");g(this,"_electLeader");const a=new C(e,{children:e.game.village.jobs.filter(l=>!m(this.setting.jobs[l.name])).map(l=>this._getDistributeOption(e,this.setting.jobs[l.name],n.selected,t,l.title))});this.addChild(a);const r=new C(e,{hasDisableAll:!1,hasEnableAll:!1});r.addChild(new q(e,e.engine.i18n("ui.additional"))),this._hunt=new F(e,this.setting.hunt,n,e.engine.i18n("option.hunt"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.hunt")])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.hunt")])},onRefresh:()=>{this._hunt.triggerButton.inactive=!this.setting.hunt.enabled,this._hunt.triggerButton.ineffective=this.setting.enabled&&this.setting.hunt.enabled&&this.setting.hunt.trigger===-1},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.prompt.percentage"),e.engine.i18n("ui.trigger.hunt.prompt",[e.renderPercentage(this.setting.hunt.trigger,n.selected,!0)]),e.renderPercentage(this.setting.hunt.trigger),e.engine.i18n("ui.trigger.hunt.promptExplainer")).then(l=>{l===void 0||l===""||l.startsWith("-")||(this.setting.hunt.trigger=e.parsePercentage(l))}).then(()=>{this._hunt.refreshUi()}).catch(x(console))}}),this._hunt.triggerButton.element.addClass(_.lastHeadAction),r.addChild(this._hunt),this._festivals=new S(e,this.setting.holdFestivals,e.engine.i18n("option.festival"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.festival")])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.festival")])}}),r.addChild(this._festivals),this._promoteKittens=new F(e,this.setting.promoteKittens,n,e.engine.i18n("option.promotekittens"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.promotekittens")])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.promotekittens")])},onRefresh:()=>{this._promoteKittens.triggerButton.inactive=!this.setting.promoteKittens.enabled,this._promoteKittens.triggerButton.ineffective=this.setting.enabled&&this.setting.promoteKittens.enabled&&this.setting.promoteKittens.trigger===-1},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.promoteKittens.promptTitle"),e.engine.i18n("ui.trigger.promoteKittens.prompt",[e.renderPercentage(this.setting.promoteKittens.trigger,n.selected,!0)]),e.renderPercentage(this.setting.promoteKittens.trigger),e.engine.i18n("ui.trigger.promoteKittens.promptExplainer")).then(l=>{l===void 0||l===""||l.startsWith("-")||(this.setting.promoteKittens.trigger=e.parsePercentage(l))}).then(()=>{this.refreshUi()}).catch(x(console))}}),this._promoteKittens.triggerButton.element.addClass(_.lastHeadAction),r.addChild(this._promoteKittens),this._promoteLeader=new S(e,this.setting.promoteLeader,e.engine.i18n("option.promote"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.promote")])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.promote")])}}),r.addChild(this._promoteLeader);for(const l of this.setting.electLeader.job.options)l.value==="any"?l.label=e.engine.i18n("option.elect.job.any"):l.label=e.engine.i18n(`$village.job.${l.value}`);for(const l of this.setting.electLeader.trait.options)l.label=e.engine.i18n(`$village.trait.${l.value}`);this._electLeader=new S(e,this.setting.electLeader,e.engine.i18n("option.elect"),{children:[new Yt(e,e.engine.i18n("option.elect.job"),this.setting.electLeader.job),new Yt(e,e.engine.i18n("option.elect.trait"),this.setting.electLeader.trait)],onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.elect")])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.elect")])}}),r.addChild(this._electLeader),this.addChild(r)}_getDistributeOption(e,t,n,s,a,r=!1){const l=()=>{T.prompt(e,e.engine.i18n("ui.max.distribute.prompt",[a]),e.engine.i18n("ui.max.distribute.promptTitle",[a,e.renderAbsolute(t.max,n)]),e.renderAbsolute(t.max),e.engine.i18n("ui.max.distribute.promptExplainer")).then(c=>{if(c!==void 0){if(c===""||c.startsWith("-")){t.max=-1;return}c==="0"&&(t.enabled=!1),t.max=e.parseAbsolute(c)??t.max}}).then(()=>{this.refreshUi()}).catch(x(console))},u=new cn(e,t,a,{childrenHead:[new R(e,{classes:[E.fillSpace]})],delimiter:r,onCheck:()=>{e.engine.imessage("status.sub.enable",[a]),t.max===0&&l()},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[a])},onRefresh:()=>{u.maxButton.inactive=!t.enabled||t.max===-1,u.maxButton.ineffective=s.enabled&&t.enabled&&t.max===0},onRefreshMax:()=>{u.maxButton.updateLabel(e.renderAbsolute(t.max)),u.maxButton.element[0].title=t.max<0?e.engine.i18n("ui.max.distribute.titleInfinite",[a]):t.max===0?e.engine.i18n("ui.max.distribute.titleZero",[a]):e.engine.i18n("ui.max.distribute.title",[e.renderAbsolute(t.max),a])},onSetMax:l});return u.maxButton.element.addClass(_.lastHeadAction),u}}class Nl extends z{constructor(i,e,t,n){const s=i.engine.i18n("ui.upgrade.upgrades");super(i,e,new F(i,e,t,s,{onCheck:()=>{i.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{i.engine.imessage("status.auto.disable",[s])},onRefresh:c=>{c.triggerButton.inactive=!e.enabled||e.trigger===-1},onRefreshTrigger:c=>{c.triggerButton.element[0].title=i.engine.i18n("ui.trigger",[e.trigger===-1?i.engine.i18n("ui.trigger.section.inactive"):i.renderPercentage(e.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[s,e.trigger!==-1?i.renderPercentage(e.trigger,t.selected,!0):i.engine.i18n("ui.infinity")]),e.trigger!==-1?i.renderPercentage(e.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(c=>{if(c!==void 0){if(c===""||c.startsWith("-")){e.trigger=-1;return}e.trigger=i.parsePercentage(c)}}).then(()=>{this.refreshUi()}).catch(x(console))}}),n);const a=i.game.workshop.upgrades.filter(c=>!m(this.setting.upgrades[c.name])),r=[];let l=a[0].label,u;for(const c of a.sort((h,d)=>h.label.localeCompare(d.label,t.selected))){const h=this.setting.upgrades[c.name],d=new F(i,h,t,c.label,{onCheck:()=>{i.engine.imessage("status.sub.enable",[c.label])},onUnCheck:()=>{i.engine.imessage("status.sub.disable",[c.label])},onRefresh:()=>{d.triggerButton.inactive=!h.enabled||h.trigger===-1,d.triggerButton.ineffective=e.enabled&&h.enabled&&e.trigger===-1&&h.trigger===-1},onRefreshTrigger:()=>{d.triggerButton.element[0].title=i.engine.i18n("ui.trigger",[h.trigger<0?e.trigger<0?i.engine.i18n("ui.trigger.build.blocked",[s]):`${i.renderPercentage(e.trigger,t.selected,!0)} (${i.engine.i18n("ui.trigger.section.inherited")})`:i.renderPercentage(h.trigger,t.selected,!0)])},onSetTrigger:()=>{T.prompt(i,i.engine.i18n("ui.trigger.prompt.percentage"),i.engine.i18n("ui.trigger.section.prompt",[s,h.trigger!==-1?i.renderPercentage(h.trigger,t.selected,!0):i.engine.i18n("ui.trigger.section.inherited")]),h.trigger!==-1?i.renderPercentage(h.trigger):"",i.engine.i18n("ui.trigger.section.promptExplainer")).then(f=>{if(f!==void 0){if(f===""||f.startsWith("-")){h.trigger=-1;return}h.trigger=i.parsePercentage(f)}}).then(()=>{d.refreshUi()}).catch(x(console))}});d.triggerButton.element.addClass(_.lastHeadAction),i.engine.localeSupportsFirstLetterSplits(t.selected)&&l[0]!==c.label[0]&&(m(u)||u.element.addClass(_e.delimiter),d.element.addClass(E.splitter)),u=d,r.push(d),l=c.label}this.addChild(new C(i,{children:r}))}}class ql extends S{constructor(e,t,n,s,a){super(e,t,s,a);g(this,"limitedButton");g(this,"maxButton");g(this,"triggerButton");this.limitedButton=new un(e,t,{...a,classes:[St.headAction]}),this.maxButton=new Xt(e,t,{alignment:"right",border:!1,classes:[_.headAction],onClick:a!=null&&a.onSetMax?()=>{var r;return(r=a.onSetMax)==null?void 0:r.call(a,this)}:void 0,onRefresh:a!=null&&a.onRefreshMax?()=>{var r;return(r=a.onRefreshMax)==null?void 0:r.call(a,this)}:void 0}),this.triggerButton=new Ct(e,t,n,{border:!1,classes:[_.lastHeadAction],onClick:a!=null&&a.onSetTrigger?()=>{var r;return(r=a.onSetTrigger)==null?void 0:r.call(a,this)}:void 0,onRefreshTitle:a!=null&&a.onRefreshTrigger?()=>{var r;return(r=a.onRefreshTrigger)==null?void 0:r.call(a,this)}:void 0}),this.head.addChildren([new R(e,{classes:[E.fillSpace]}),this.limitedButton,this.maxButton,this.triggerButton])}refreshUi(){super.refreshUi(),this.limitedButton.refreshUi(),this.maxButton.refreshUi(),this.triggerButton.refreshUi()}}class zl extends z{constructor(e,t,n){const s=e.engine.i18n("ui.craft");super(e,t,new F(e,t,n,s,{onCheck:()=>{e.engine.imessage("status.auto.enable",[s])},onUnCheck:()=>{e.engine.imessage("status.auto.disable",[s])},onRefresh:u=>{u.triggerButton.inactive=!t.enabled||t.trigger===-1},onRefreshTrigger:u=>{u.triggerButton.element[0].title=e.engine.i18n("ui.trigger.section",[t.trigger<0?e.engine.i18n("ui.trigger.section.inactive"):e.renderPercentage(t.trigger,n.selected,!0)])},onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.prompt.percentage"),e.engine.i18n("ui.trigger.section.prompt",[s,t.trigger!==-1?e.renderPercentage(t.trigger,n.selected,!0):e.engine.i18n("ui.infinity")]),t.trigger!==-1?e.renderPercentage(t.trigger):"",e.engine.i18n("ui.trigger.section.promptExplainer")).then(u=>{if(u!==void 0){if(u===""||u.startsWith("-")){t.trigger=-1;return}t.trigger=e.parsePercentage(u)}}).then(()=>{this.refreshUi()}).catch(x(console))}}));g(this,"_crafts");let a=[];game.challenges.getChallenge("ironWill").active||(this.setting.resources.bloodstone.enabled=!1,this.setting.resources.tMythril.enabled=!1,a=["bloodstone","tMythril"]);const r=e.game.workshop.crafts.filter(u=>!a.includes(u.name)&&!m(this.setting.resources[u.name])).map(u=>[this.setting.resources[u.name],Y(u.label)]);this._crafts=[];for(const[u,c]of r){const h=()=>{T.prompt(e,e.engine.i18n("ui.max.craft.prompt",[c]),e.engine.i18n("ui.max.craft.promptTitle",[c,e.renderAbsolute(u.max,n.selected)]),e.renderAbsolute(u.max),e.engine.i18n("ui.max.craft.promptExplainer")).then(f=>{if(f!==void 0){if(f===""||f.startsWith("-")){u.max=-1;return}f==="0"&&(u.enabled=!1),u.max=e.parseAbsolute(f)??u.max}}).then(()=>{this.refreshUi()}).catch(x(console))},d=new ql(e,u,n,c,{delimiter:u.resource==="kerosene"||u.resource==="blueprint",onCheck:()=>{e.engine.imessage("status.sub.enable",[c]),u.max===0&&h()},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[c])},onLimitedCheck:()=>{e.engine.imessage("craft.limited",[c])},onLimitedUnCheck:()=>{e.engine.imessage("craft.unlimited",[c])},onRefresh:()=>{d.limitedButton.inactive=!u.enabled||!u.limited,d.maxButton.inactive=!u.enabled||u.max===-1,d.maxButton.ineffective=t.enabled&&u.enabled&&u.max===0,d.triggerButton.inactive=!u.enabled||u.trigger===-1,d.triggerButton.ineffective=t.enabled&&u.enabled&&t.trigger===-1&&u.trigger===-1},onRefreshMax:()=>{d.maxButton.updateLabel(e.renderAbsolute(u.max)),d.maxButton.element[0].title=u.max<0?e.engine.i18n("ui.max.craft.titleInfinite",[c]):u.max===0?e.engine.i18n("ui.max.craft.titleZero",[c]):e.engine.i18n("ui.max.craft.title",[e.renderAbsolute(u.max),c])},onRefreshTrigger:()=>{d.triggerButton.element[0].title=e.engine.i18n("ui.trigger",[u.trigger<0?t.trigger<0?e.engine.i18n("ui.trigger.build.blocked",[c]):`${e.renderPercentage(t.trigger,n.selected,!0)} (${e.engine.i18n("ui.trigger.build.inherited")})`:e.renderPercentage(u.trigger,n.selected,!0)])},onSetMax:h,onSetTrigger:()=>{T.prompt(e,e.engine.i18n("ui.trigger.prompt.percentage"),e.engine.i18n("ui.trigger.section.prompt",[c,u.trigger!==-1?e.renderPercentage(u.trigger,n.selected,!0):e.engine.i18n("ui.trigger.build.inherited")]),u.trigger!==-1?e.renderPercentage(u.trigger):"",e.engine.i18n("ui.trigger.build.promptExplainer")).then(f=>{if(f!==void 0){if(f===""||f.startsWith("-")){u.trigger=-1;return}u.trigger=e.parsePercentage(f)}}).then(()=>{d.refreshUi()}).catch(x(console))}});this._crafts.push(d),u.resource==="ship"&&this._crafts.push(new S(e,this.setting.shipOverride,e.engine.i18n("option.shipOverride"),{onCheck:()=>{e.engine.imessage("status.sub.enable",[e.engine.i18n("option.shipOverride")])},onUnCheck:()=>{e.engine.imessage("status.sub.disable",[e.engine.i18n("option.shipOverride")])},upgradeIndicator:!0}))}const l=new C(e,{children:this._crafts,onReset:()=>{this.setting.load({resources:new _t().resources}),this.refreshUi()}});this.addChild(l),this.addChild(new C(e,{children:[new Nl(e,this.setting.unlockUpgrades,n)],hasDisableAll:!1,hasEnableAll:!1}))}}class Wl extends J{constructor(e){super(e);g(this,"element");g(this,"showActivity");g(this,"_engineUi");g(this,"_sections");g(this,"stateManagementUi");const t=e.engine;this._engineUi=new Us(e,t.settings),this.stateManagementUi=new vl(e,t.settings.states,t.settings.locale),this._sections=[new Ps(e,t.bonfireManager.settings,t.settings.locale),new Dl(e,t.villageManager.settings,t.settings.locale),new Ks(e,t.scienceManager.settings,t.settings.locale),new zl(e,t.workshopManager.settings,t.settings.locale),new Fs(e,t.settings.resources,t.settings.locale),new Ol(e,t.tradeManager.settings,t.settings.locale),new zs(e,t.religionManager.settings,t.settings.locale),new js(e,t.spaceManager.settings,t.settings.locale),new Rl(e,t.timeManager.settings,t.settings.locale),new Ml(e,t.timeControlManager.settings,t.settings.locale),new qs(e,t.settings.filters),this.stateManagementUi,new Ds(e,t.settings,t.settings.locale)];const n=$("<div/>").addClass(ii.ui),s=$("<ul/>");s.append(this._engineUi.element);for(const c of this._sections)s.append(c.element);n.append(s);const a=this._engineUi.expando;let r=!1;a.element.on("click",()=>{r=!r;for(const c of this._sections)c.toggle(r,!0)});let l=0;for(const c of this._sections)c.addEventListener("panelHidden",()=>{--l,l===0&&(r=!1),r||a.setCollapsed()}),c.addEventListener("panelShown",()=>{++l,r=!0,a.setExpanded()});this.showActivity=$("<span/>",{html:`<svg style="width: 18px; height: 18px;" viewBox="0 -960 960 960" fill="currentColor"><path d="${M.Summary}"/></svg>`,title:e.engine.i18n("summary.show")}).addClass(ii.showActivity),this.showActivity.on("click",()=>{e.engine.displayActivitySummary()}),$("#clearLog").prepend(this.showActivity),t.settings.ksColumn.enabled?$("#rightColumn").after(`<div id="ksColumn" class="column"><span class="${ii.spacer}"></span></div>`):$("#ksColumn").remove();const u=$(t.settings.ksColumn.enabled?"#ksColumn":"#rightColumn");if(u.length===0){const c=$("#optionsPage .full-screen-position .page .page-content");c.length===0?U("Unable to find right column to inject UI into. Running headless."):(c.append(n),n.attr("style","border-top:1px solid grey; padding:15px"))}else u.prepend(n);this.element=n}destroy(){this.showActivity.remove(),this.element.remove()}refreshUi(){this._engineUi.refreshUi();for(const e of this._sections)e.refreshUi()}}const Ie=(o="")=>{if(m("2.0.0-henry"))throw Error("Build error: RELEASE_VERSION is not defined.");return`${o}2.0.0-henry`};class me{constructor(i,e,t="en",n){g(this,"game");g(this,"i18nEngine");g(this,"_userInterface");g(this,"engine");g(this,"_gameBeforeSaveHandle");g(this,"_serverLoadHandle");g(this,"_saveManager",{load:i=>{H("Looking for Kitten Scientists engine state in save data...");const e=O.tryEngineStateFromSaveData("ks",i);if(!e){H("The Kittens Game save data did not contain a script state.");return}H("Found Kitten Scientists engine state in save data."),this.engine.stateLoad(e),this.refreshUi()},resetState:()=>null,save:i=>{}});var s;H(`Kitten Scientists ${Ie("v")} constructed. Checking for previous instances...`),"kittenScientists"in O.window&&(U("Detected existing KS instance. Trying to unload it..."),(s=O.window.kittenScientists)==null||s.unload()),H("You are on the 'fixed' release channel."),this.game=i,this.i18nEngine=e;try{this.engine=new re(this,t),this._userInterface=this._constructUi()}catch(a){throw ge("Failed to construct core components.",a),a}m(n)||this.setSettings(n)}_constructUi(){const i=new Wl(this);return i.stateManagementUi.loadAutoSave(),i.refreshUi(),i}rebuildUi(){this._userInterface.destroy(),this._userInterface=this._constructUi()}validateGame(){Vt.validateGame(this.game,this.engine.scienceManager.settings),kt.validateGame(this.game,this.engine.spaceManager.settings),_t.validateGame(this.game,this.engine.workshopManager.settings)}unload(){U("Unloading Kitten Scientists..."),this.engine.stop(),this._userInterface.destroy(),$("#ks-styles").remove(),this._gameBeforeSaveHandle!==void 0&&(O.window.dojo.unsubscribe(this._gameBeforeSaveHandle),this._gameBeforeSaveHandle=void 0),this._serverLoadHandle!==void 0&&(O.window.dojo.unsubscribe(this._serverLoadHandle),this._gameBeforeSaveHandle=void 0);const i=this.game.managers.indexOf(this._saveManager);-1<i&&this.game.managers.splice(i,1),window.kittenScientists=void 0,U("Kitten Scientists have been unloaded!")}run(){this.game.console.maxMessages=1e3,this.refreshUi(),this.engine.settings.enabled&&this.engine.start(!0),this.engine.imessage("status.ks.init"),this.runUpdateCheck().catch(x(console)),this._gameBeforeSaveHandle!==void 0&&(O.window.dojo.unsubscribe(this._gameBeforeSaveHandle),this._gameBeforeSaveHandle=void 0),this._gameBeforeSaveHandle=O.window.dojo.subscribe("game/beforesave",i=>{H("Injecting Kitten Scientists engine state into save data...");const e=this.getSettings();i.ks={state:[e]},this._userInterface.stateManagementUi.storeAutoSave(e),document.dispatchEvent(new CustomEvent("ks.reportSavegame",{detail:i}))}),this._serverLoadHandle!==void 0&&(O.window.dojo.unsubscribe(this._serverLoadHandle),this._gameBeforeSaveHandle=void 0),this._serverLoadHandle=O.window.dojo.subscribe("server/load",i=>{const e=O.tryEngineStateFromSaveData("ks",i);if(!e){H("The Kittens Game save data did not contain a script state. Trying to load Auto-Save settings...");return}H("Found! Loading settings..."),this.engine.stateLoad(e)})}async runUpdateCheck(){{be("No update check on 'fixed' release channel.");return}}refreshUi(){this._userInterface.refreshUi()}parseFloat(i){if(i===null||i==="")return null;const e=/[KMGTP]$/i.test(i),t=i.substring(0,i.length-(e?1:0));let n=i.includes("e")||e?Number.parseFloat(t):Number.parseInt(t);if(e){const s=i.substring(i.length-1).toUpperCase();n=n*1e3**["","K","M","G","T","P"].indexOf(s)}return(n===Number.POSITIVE_INFINITY||n<0)&&(n=-1),n}parseAbsolute(i){const e=this.parseFloat(i);return e!==null?Math.round(e):null}parsePercentage(i){const e=i.trim().replace(/%$/,"");return Math.max(0,Math.min(1,Number.parseFloat(e)/100))}renderAbsolute(i,e="invariant"){return i<0||i===Number.POSITIVE_INFINITY?"∞":e!=="invariant"&&Math.floor(Math.log10(i))<9?new Intl.NumberFormat(e,{style:"decimal",maximumFractionDigits:0}).format(i):this.game.getDisplayValueExt(i,!1,!1)}renderPercentage(i,e="invariant",t){return i<0||i===Number.POSITIVE_INFINITY?"∞":e!=="invariant"?new Intl.NumberFormat(e,{style:"percent"}).format(i):`${this.game.getDisplayValueExt(i*100,!1,!1)}${t?"%":""}`}renderFloat(i,e="invariant"){return i<0||i===Number.POSITIVE_INFINITY?"∞":e!=="invariant"?new Intl.NumberFormat(e,{style:"decimal"}).format(i):this.game.getDisplayValueExt(i,!1,!1)}static encodeSettings(i,e=!0){const t=JSON.stringify(i);return e?window.LZString.compressToBase64(t):t}static decodeSettings(i){try{const n=JSON.parse(i);return me.unknownAsEngineStateOrThrow(n)}catch{}const e=window.LZString.decompressFromBase64(i),t=JSON.parse(e);return me.unknownAsEngineStateOrThrow(t)}getSettings(){return this.engine.stateSerialize()}getSettingsAsJson(){return JSON.stringify(this.getSettings())}setSettings(i){H("Loading engine state..."),this.engine.stateLoad(i),i.engine.ksColumn.enabled?this.rebuildUi():this._userInterface.refreshUi()}importSettingsFromString(i){const e=me.decodeSettings(i);this.setSettings(e)}async copySettings(i=this.getSettings(),e=!0){const t=me.encodeSettings(i,e);await window.navigator.clipboard.writeText(t)}static unknownAsEngineStateOrThrow(i){const e=i.v;if(!m(e)&&typeof e=="string"&&e.startsWith("2"))return i;throw new Error("Not a valid engine state.")}installSaveManager(){H("Installing save game manager..."),this.game.managers.push(this._saveManager)}}(async()=>{const o=await new O().waitForGame(me,"ks");window.kittenScientists=o,o.validateGame(),o.run()})().catch(ge)});
(function(){"use strict";try{if(typeof document<"u"){var t=document.createElement("style");t.id="ks-styles",t.appendChild(document.createTextNode('@keyframes _hail-rainbow_q7zpt_1{0%,to{color:red;text-shadow:0 0 10px red}33%{color:#888;text-shadow:0 0 10px yellow}66%{color:#fff;text-shadow:0 0 10px black}}._iconButton_q7zpt_17{cursor:pointer;display:block;padding-right:3px;line-height:0;opacity:.8;transition:.3s}._iconButton_q7zpt_17:hover{opacity:1}._iconButton_q7zpt_17._inactive_q7zpt_29{opacity:.4}._iconButton_q7zpt_17._inactive_q7zpt_29:hover{opacity:.6}._iconButton_q7zpt_17._ineffective_q7zpt_37{color:red;animation:_hail-rainbow_q7zpt_1 5s linear infinite}._button_q7zpt_43{align-items:end;cursor:pointer;display:flex;opacity:.8;transition:.3s}._button_q7zpt_43:hover{opacity:1}._button_q7zpt_43._inactive_q7zpt_29{opacity:.4}._button_q7zpt_43._inactive_q7zpt_29:hover{opacity:.6}._button_q7zpt_43._ineffective_q7zpt_37{color:red;animation:_hail-rainbow_q7zpt_1 5s linear infinite}._button_q7zpt_43._readonly_q7zpt_67{cursor:default;pointer-events:none}._button_q7zpt_43 ._buttonIcon_q7zpt_72{margin:0 2px 0 0;vertical-align:sub}._button_q7zpt_43._alignRight_q7zpt_77{justify-content:end}._button_q7zpt_43._large_q7zpt_81{padding:5px 10px}._button_q7zpt_43._bordered_q7zpt_85{border:1px solid rgba(180,180,180,.2)}._button_q7zpt_43._bordered_q7zpt_85:not(._large_q7zpt_81){padding:0 2px}._button_q7zpt_43._bordered_q7zpt_85:hover{border:1px solid rgba(180,180,180,1)}._button_q7zpt_43._headAction_q7zpt_97{min-width:50px}._button_q7zpt_43._lastHeadAction_q7zpt_100{padding-right:20px}._button_q7zpt_43._consumeButton_q7zpt_104,._button_q7zpt_43._stockButton_q7zpt_107{border:1px solid transparent}._button_q7zpt_43:not(._bordered_q7zpt_85)+._button_q7zpt_43:not(._bordered_q7zpt_85):before{content:"";display:inline-block;height:1em;border-left:1px solid transparent}._button_q7zpt_43:not(._bordered_q7zpt_85):not(._inactive_q7zpt_29)._alignRight_q7zpt_77+._button_q7zpt_43:not(._bordered_q7zpt_85):not(._inactive_q7zpt_29):before{content:"";display:inline-block;height:1em;border-left:1px solid rgba(180,180,180,.4)}._delimiter_16hnh_1{margin-bottom:10px}#gamePageContainer .dialog.help._dialog_b4vj0_1{display:flex;flex-direction:column;height:fit-content!important;box-shadow:none!important}#gamePageContainer .dialog.help._dialog_b4vj0_1 ._close_b4vj0_7{position:absolute;top:10px;right:15px}._explainer_121s0_1{color:#888;display:inline-block;min-width:100px;padding:4px;-webkit-user-select:none;user-select:none;white-space:break-spaces}._explainer_121s0_1 p{margin:0}._header_19ql8_1{display:block;margin-bottom:3px;min-width:100px;border-bottom:1px dashed rgba(255,255,255,.1);font-weight:700;-webkit-user-select:none;user-select:none}._toolbar_1654f_1{display:flex;flex-direction:row;padding:0 0 2px;margin:0 0 3px}._toolbar_1654f_1>*{margin:0 3px 0 0}._label_1nlev_1{align-content:center;display:inline-block;flex:0 1 fit-content;opacity:.8;white-space:nowrap;transition:.3s}._label_1nlev_1:hover{opacity:1}._splitter_1nlev_16 ._label_1nlev_1:first-letter{font-weight:700}._iconLabel_1nlev_20{display:inline-block;margin-right:4px;margin-left:2px;vertical-align:middle}._fillSpace_1nlev_26{flex:1}._head_wr1pj_1{display:flex;align-items:stretch;flex-direction:row;justify-content:flex-start;width:100%;transition:.3s}._head_wr1pj_1>._headFlexItem_wr1pj_10{flex:1;margin-right:8px}._setting_1ndg5_1{border-bottom:1px solid transparent;transition:border-bottom .3s}._setting_1ndg5_1 ._checkbox_1ndg5_6{margin:1px 5px 2px 2px}._setting_1ndg5_1 ._panelContent_1ndg5_10{border-left:1px dashed grey;padding-left:16px;margin-left:8px;margin-top:1px;opacity:.5}._setting_1ndg5_1 ._panelContent_1ndg5_10._hidden_1ndg5_17{display:none}._setting_1ndg5_1._checked_1ndg5_22>._panelContent_1ndg5_10{opacity:1}._setting_1ndg5_1._expanded_1ndg5_26{margin-bottom:10px}._setting_1ndg5_1:not(._expanded_1ndg5_26):hover{border-bottom:1px dashed rgba(160,160,160,.2)}._setting_1ndg5_1._readonly_1ndg5_34{cursor:default;pointer-events:none}._maxButton_133h2_1{padding-right:5px;padding-top:2px}._listContainer_1kxbq_1{margin-bottom:4px}._itemsList_1kxbq_5{-webkit-user-select:none;user-select:none}._list_1kxbq_1~._listTools_1kxbq_9{border-top:1px dotted rgba(128,128,128,.3);margin-left:0;padding-top:2px}._list_1kxbq_1~._listTools_1kxbq_9 *{display:inline-block}._expandoButton_l1ukp_1:not(._expanded_l1ukp_1) ._up_l1ukp_1{display:none}._expandoButton_l1ukp_1:not(._expanded_l1ukp_1) ._down_l1ukp_4{opacity:.6}._expandoButton_l1ukp_1:not(._expanded_l1ukp_1) ._down_l1ukp_4:hover{opacity:1}._expandoButton_l1ukp_1._expanded_l1ukp_1 ._down_l1ukp_4{display:none}._fieldset_tfwil_1{border-bottom:none;border-right:none;border-top:none}._textButton_1mv97_1{display:inline-block;white-space:nowrap;opacity:.8;cursor:pointer;-webkit-user-select:none;user-select:none}._textButton_1mv97_1:hover{opacity:1}@keyframes _scale_6c09s_1{0%{scale:.5;opacity:0}50%{scale:1;opacity:1}to{scale:2;opacity:0}}._active_6c09s_16{text-shadow:rgba(128,128,128,.8) 0 0 15px;position:relative}._active_6c09s_16:after,._active_6c09s_16:before{display:inline-block;width:1em;height:100%;position:absolute;right:-1.5em;scale:0;text-align:center;transform-origin:center}._active_6c09s_16:after{content:attr(data-ks-active-from);animation:_scale_6c09s_1 8s linear infinite}._active_6c09s_16:before{content:attr(data-ks-active-to);animation:_scale_6c09s_1 8s linear infinite;animation-delay:4s}._buyButton_10eul_1,._sellButton_1tmvd_1{display:inline-block;padding-right:10px;min-width:86px}#ksColumn{min-width:250px;max-width:440px;vertical-align:top;padding-left:8px;top:20px;position:relative;overflow-y:auto}#footerLinks{display:flex;flex-direction:column;position:fixed;text-align:right;line-height:0;right:-5px!important;margin-bottom:1em}#footerLinks a{line-height:1;padding-right:10px;opacity:.5;transition:.3s;text-decoration:none;text-transform:lowercase}#footerLinks a:hover{opacity:1}#crowdjet-expand-container{position:fixed!important;bottom:10px!important;right:-10px!important;opacity:.5}#crowdjet-expand-container:hover{opacity:1}._spacer_o1key_43{display:block;margin-bottom:100px}._ui_o1key_48{margin:5px 0 10px;padding-right:10px}._ui_o1key_48 ul{list-style:none;margin:0;padding:0}._ui_o1key_48 #_toggle-list-resources_o1key_1 ._stockWarn_o1key_59 *,._ui_o1key_48 #_toggle-reset-list-resources_o1key_1 ._stockWarn_o1key_59 *{color:#dd1e00}._showActivity_o1key_65{cursor:pointer;display:inline-block;vertical-align:middle}#game #rightColumn{overflow-y:auto}#game #rightColumn #rightTabLog{overflow-y:visible}#game #rightColumn #rightTabLog #gameLog{height:auto;min-height:auto;overflow-y:visible}#game .res-row .res-cell.ks-stock-above{color:green}#game .res-row .res-cell.ks-stock-below{color:red}.bldTopContainer>a{display:none!important}.bldTopContainer>span{display:none!important}')),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
